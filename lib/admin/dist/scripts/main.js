function Sanitize(){var t,e;for(e=arguments[0]||{},this.config={},this.config.elements=e.elements?e.elements:[],this.config.attributes=e.attributes?e.attributes:{},this.config.attributes[Sanitize.ALL]=this.config.attributes[Sanitize.ALL]?this.config.attributes[Sanitize.ALL]:[],this.config.allow_comments=e.allow_comments?e.allow_comments:!1,this.allowed_elements={},this.config.protocols=e.protocols?e.protocols:{},this.config.add_attributes=e.add_attributes?e.add_attributes:{},this.dom=e.dom?e.dom:document,t=0;t<this.config.elements.length;t++)this.allowed_elements[this.config.elements[t]]=!0;if(this.config.remove_element_contents={},this.config.remove_all_contents=!1,e.remove_contents)if(e.remove_contents instanceof Array)for(t=0;t<e.remove_contents.length;t++)this.config.remove_element_contents[e.remove_contents[t]]=!0;else this.config.remove_all_contents=!0;this.transformers=e.transformers?e.transformers:[]}if("undefined"==typeof jQuery)throw new Error("Froala requires jQuery");!function(t){"use strict";var e=function(i,n){return this.options=t.extend({},e.DEFAULTS,t(i).data(),"object"==typeof n&&n),this.options.unsupportedAgents.test(navigator.userAgent)?!1:(this.valid_nodes=t.merge([],e.VALID_NODES),this.valid_nodes=t.merge(this.valid_nodes,t.map(Object.keys(this.options.blockTags),function(t){return t.toUpperCase()})),this.browser=e.browser(),this.disabledList=[],this._id=++e.count,this._events={},this.blurred=!0,this.$original_element=t(i),this.document=i.ownerDocument,this.window="defaultView"in this.document?this.document.defaultView:this.document.parentWindow,this.$document=t(this.document),this.$window=t(this.window),this.br=this.browser.msie&&t.Editable.getIEversion()<=10?"":"<br/>",this.init(i),void t(i).on("editable.focus",t.proxy(function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&this.$window.trigger("blur."+e)},this)))};e.initializers=[],e.count=0,e.VALID_NODES=["P","DIV","LI","TD","TH"],e.LANGS=[],e.INVISIBLE_SPACE="&#x200b;",e.DEFAULTS={allowComments:!0,allowScript:!1,allowStyle:!1,allowedAttrs:["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","width","wrap"],allowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],alwaysBlank:!1,alwaysVisible:!1,autosave:!1,autosaveInterval:1e4,beautifyCode:!0,blockTags:{n:"Normal",blockquote:"Quote",pre:"Code",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},buttons:["bold","italic","underline","strikeThrough","fontSize","fontFamily","color","sep","formatBlock","blockStyle","align","insertOrderedList","insertUnorderedList","outdent","indent","sep","createLink","insertImage","insertVideo","insertHorizontalRule","undo","redo","html"],crossDomain:!0,convertMailAddresses:!0,customButtons:{},customDropdowns:{},customText:!1,defaultTag:"P",direction:"ltr",disableRightClick:!1,editInPopup:!1,editorClass:"",formatTags:["p","pre","blockquote","h1","h2","h3","h4","h5","h6","div","ul","ol","li","table","tbody","thead","tfoot","tr","th","td","body","head","html","title","meta","link","base","script","style"],headers:{},height:"auto",icons:{},inlineMode:!0,initOnClick:!1,fullPage:!1,language:"en_us",linkList:[],linkText:!1,linkClasses:{},linkAttributes:{},linkAutoPrefix:"",maxHeight:"auto",minHeight:"auto",multiLine:!0,noFollow:!0,paragraphy:!0,placeholder:"Type something",plainPaste:!1,preloaderSrc:"",saveURL:null,saveParam:"body",saveParams:{},saveRequestType:"POST",scrollableContainer:"body",simpleAmpersand:!1,shortcuts:!0,shortcutsAvailable:["show","bold","italic","underline","createLink","insertImage","indent","outdent","html","formatBlock n","formatBlock h1","formatBlock h2","formatBlock h3","formatBlock h4","formatBlock h5","formatBlock h6","formatBlock blockquote","formatBlock pre","strikeThrough"],showNextToCursor:!1,spellcheck:!1,theme:null,toolbarFixed:!0,trackScroll:!1,unlinkButton:!0,useClasses:!0,tabSpaces:!0,typingTimer:500,pastedImagesUploadRequestType:"POST",pastedImagesUploadURL:"http://i.froala.com/upload_base64",unsupportedAgents:/Opera Mini/i,useFrTag:!1,width:"auto",withCredentials:!1,zIndex:2e3},e.prototype.destroy=function(){this.sync(),this.options.useFrTag&&this.addFrTag(),this.hide(),this.isHTML&&this.html(),this.$bttn_wrapper&&this.$bttn_wrapper.html("").removeData().remove(),this.$editor&&this.$editor.html("").removeData().remove(),this.raiseEvent("destroy"),this.$popup_editor&&this.$popup_editor.html("").removeData().remove(),this.$placeholder&&this.$placeholder.html("").removeData().remove(),clearTimeout(this.ajaxInterval),clearTimeout(this.typingTimer),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop"),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop","**"),this.$window.off("mouseup."+this._id),this.$window.off("keydown."+this._id),this.$window.off("keyup."+this._id),this.$window.off("blur."+this._id),this.$window.off("hide."+this._id),this.$window.off("scroll."+this._id),this.$window.off("resize."+this._id),this.$window.off("orientationchange."+this._id),this.$document.off("selectionchange."+this._id),this.$original_element.off("editable"),void 0!==this.$upload_frame&&this.$upload_frame.remove(),this.$textarea&&(this.$box.remove(),this.$textarea.removeData("fa.editable"),this.$textarea.show());for(var t in this._events)delete this._events[t];this.$placeholder&&this.$placeholder.remove(),this.isLink?this.$element.removeData("fa.editable"):(this.$wrapper?this.$wrapper.replaceWith(this.getHTML(!1,!1)):this.$element.replaceWith(this.getHTML(!1,!1)),this.$box&&!this.editableDisabled&&(this.$box.removeClass("froala-box f-rtl"),this.$box.find(".html-switch").remove(),this.$box.removeData("fa.editable"),clearTimeout(this.typingTimer))),this.$lb&&this.$lb.remove()},e.prototype.triggerEvent=function(e,i,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1),n===!0&&(this.isResizing()||this.editableDisabled||this.imageMode||!r||this.cleanify(),this.sync());var a=!0;return i||(i=[]),a=this.$original_element.triggerHandler("editable."+e,t.merge([this],i)),void 0===a?!0:a},e.prototype.syncStyle=function(){if(this.options.fullPage){var t=this.$element.html().match(/\[style[^\]]*\].*\[\/style\]/gi);if(this.$document.find("head style[data-id]").remove(),t)for(var e=0;e<t.length;e++)this.$document.find("head").append(t[e].replace(/\[/gi,"<").replace(/\]/gi,">"))}},e.prototype.sync=function(){if(!this.isHTML){this.raiseEvent("sync"),this.disableImageResize(),this.isLink||this.isImage||this.checkPlaceholder();var t=this.getHTML();this.trackHTML!==t&&null!=this.trackHTML?(this.refreshImageList(),this.refreshButtons(),this.trackHTML=t,this.$textarea&&this.$textarea.val(t),this.doingRedo||this.saveUndoStep(),this.triggerEvent("contentChanged",[],!1)):null==this.trackHTML&&(this.trackHTML=t),this.syncStyle()}},e.prototype.emptyElement=function(e){if("IMG"==e.tagName||t(e).find("img").length>0)return!1;if(t(e).find("input, iframe, object").length>0)return!1;for(var i=t(e).text(),n=0;n<i.length;n++)if("\n"!==i[n]&&"\r"!==i[n]&&"	"!==i[n]&&8203!=i[n].charCodeAt(0))return!1;return!0},e.prototype.initEvents=function(){this.mobile()?(this.mousedown="touchstart",this.mouseup="touchend",this.move="touchmove"):(this.mousedown="mousedown",this.mouseup="mouseup",this.move="")},e.prototype.initDisable=function(){this.$element.on("keypress keydown keyup",t.proxy(function(t){return this.isDisabled?(t.stopPropagation(),t.preventDefault(),!1):void 0},this))},e.prototype.continueInit=function(){this.initDisable(),this.initEvents(),this.browserFixes(),this.handleEnter(),this.editableDisabled||(this.initUndoRedo(),this.enableTyping(),this.initShortcuts()),this.initTabs(),this.initEditor();for(var e=0;e<t.Editable.initializers.length;e++)t.Editable.initializers[e].call(this);this.initOptions(),this.initEditorSelection(),this.initAjaxSaver(),this.setLanguage(),this.setCustomText(),this.editableDisabled||this.registerPaste(),this.refreshDisabledState(),this.refreshUndo(),this.refreshRedo(),this.initPopupSubmit(),this.initialized=!0,this.triggerEvent("initialized",[],!1,!1)},e.prototype.initPopupSubmit=function(){this.$popup_editor.find(".froala-popup input").keydown(function(e){var i=e.which;13==i&&(e.preventDefault(),e.stopPropagation(),t(this).blur(),t(this).parents(".froala-popup").find("button.f-submit").click())})},e.prototype.lateInit=function(){this.saveSelectionByMarkers(),this.continueInit(),this.restoreSelectionByMarkers(),this.$element.focus(),this.hideOtherEditors()},e.prototype.init=function(e){this.options.paragraphy||(this.options.defaultTag="DIV"),this.options.allowStyle&&this.setAllowStyle(),this.options.allowScript&&this.setAllowScript(),this.initElement(e),this.initElementStyle(),(!this.isLink||this.isImage)&&(this.initImageEvents(),this.buildImageMove()),this.options.initOnClick?(this.editableDisabled||(this.$element.attr("contenteditable",!0),this.$element.attr("spellcheck",!1)),this.$element.bind("mousedown.element focus.element",t.proxy(function(t){return this.isLink||t.stopPropagation(),this.isDisabled?!1:(this.$element.unbind("mousedown.element focus.element"),this.browser.webkit&&(this.initMouseUp=!1),void this.lateInit())},this))):this.continueInit()},e.prototype.phone=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},e.prototype.mobile=function(){return this.phone()||this.android()||this.iOS()||this.blackberry()},e.prototype.iOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},e.prototype.iOSVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)];if(e&&e[0])return e[0]}return 0},e.prototype.iPad=function(){return/(iPad)/g.test(navigator.userAgent)},e.prototype.iPhone=function(){return/(iPhone)/g.test(navigator.userAgent)},e.prototype.iPod=function(){return/(iPod)/g.test(navigator.userAgent)},e.prototype.android=function(){return/(Android)/g.test(navigator.userAgent)},e.prototype.blackberry=function(){return/(Blackberry)/g.test(navigator.userAgent)},e.prototype.initOnTextarea=function(e){this.$textarea=t(e),void 0!==this.$textarea.attr("placeholder")&&"Type something"==this.options.placeholder&&(this.options.placeholder=this.$textarea.attr("placeholder")),this.$element=t("<div>").html(this.clean(this.$textarea.val(),!0,!1)),this.$element.find("pre br").replaceWith("\n"),this.$textarea.before(this.$element).hide(),this.$textarea.parents("form").bind("submit",t.proxy(function(){this.isHTML?this.html():this.sync()},this)),this.addListener("destroy",t.proxy(function(){this.$textarea.parents("form").unbind("submit")},this))},e.prototype.initOnLink=function(e){this.isLink=!0,this.options.linkText=!0,this.selectionDisabled=!0,this.editableDisabled=!0,this.options.buttons=[],this.$element=t(e),this.options.paragraphy=!1,this.options.countCharacters=!1,this.$box=this.$element},e.prototype.initOnImage=function(e){var i=t(e).css("float");"A"==t(e).parent().get(0).tagName&&(e=t(e).parent()),this.isImage=!0,this.editableDisabled=!0,this.imageList=[],this.options.buttons=[],this.options.paragraphy=!1,this.options.imageMargin="auto",t(e).wrap("<div>"),this.$element=t(e).parent(),this.$element.css("display","inline-block"),this.$element.css("max-width","100%"),this.$element.css("margin-left","auto"),this.$element.css("margin-right","auto"),this.$element.css("float",i),this.$element.addClass("f-image"),this.$box=t(e)},e.prototype.initForPopup=function(e){this.$element=t(e),this.$box=this.$element,this.editableDisabled=!0,this.options.countCharacters=!1,this.options.buttons=[],this.$element.on("click",t.proxy(function(t){t.preventDefault()},this))},e.prototype.initOnDefault=function(e){"DIV"!=e.tagName&&this.options.buttons.indexOf("formatBlock")>=0&&this.disabledList.push("formatBlock"),this.$element=t(e)},e.prototype.initElement=function(e){if("TEXTAREA"==e.tagName?this.initOnTextarea(e):"A"==e.tagName?this.initOnLink(e):"IMG"==e.tagName?this.initOnImage(e):this.options.editInPopup?this.initForPopup(e):this.initOnDefault(e),!this.editableDisabled){this.$box=this.$element.addClass("froala-box"),this.$wrapper=t('<div class="froala-wrapper">'),this.$element=t("<div>");var i=this.$box.html();this.$box.html(this.$wrapper.html(this.$element)),this.$element.on("keyup",t.proxy(function(){this.$element.find("ul, ol").length>1&&this.cleanupLists()},this)),this.setHTML(i,!0)}this.$element.on("drop",t.proxy(function(){setTimeout(t.proxy(function(){t("html").click(),this.$element.find(".f-img-wrap").each(function(e,i){0===t(i).find("img").length&&t(i).remove()}),this.$element.find(this.options.defaultTag+":empty").remove()},this),1)},this))},e.prototype.trim=function(t){return t=String(t).replace(/^\s+|\s+$/g,""),t=t.replace(/\u200B/gi,"")},e.prototype.unwrapText=function(){this.options.paragraphy||this.$element.find(this.options.defaultTag).each(t.proxy(function(e,i){if(0===i.attributes.length){var n=t(i).find("br:last");t(i).replaceWith(n.length&&this.isLastSibling(n.get(0))?t(i).html():t(i).html()+"<br/>")}},this))},e.prototype.wrapTextInElement=function(e,i){void 0===i&&(i=!1);var n=[],r=["SPAN","A","B","I","EM","U","S","STRONG","STRIKE","FONT","IMG","SUB","SUP","BUTTON","INPUT"],a=this;this.no_verify=!0;var o=function(){if(0===n.length)return!1;var e=t("<"+a.options.defaultTag+">"),i=t(n[0]);if(1==n.length&&"f-marker"==i.attr("class"))return void(n=[]);for(var r=0;r<n.length;r++){var o=t(n[r]);e.append(o.clone()),r==n.length-1?o.replaceWith(e):o.remove()}n=[]},s=!1,l=!1,d=!1;e.contents().filter(function(){var e=t(this);if(e.hasClass("f-marker")||e.find(".f-marker").length){var h=e;if(1==e.find(".f-marker").length||e.hasClass("f-marker")){h=e.find(".f-marker").length?t(e.find(".f-marker")[0]):e;var p=h.prev();"true"===h.attr("data-type")?p.length&&t(p[0]).hasClass("f-marker")?d=!0:(s=!0,l=!1):l=!0}else d=!0}this.nodeType==Node.TEXT_NODE&&e.text().length>0||r.indexOf(this.tagName)>=0?n.push(this):this.nodeType==Node.TEXT_NODE&&0===e.text().length&&a.options.beautifyCode?e.remove():s||i||d?("BR"===this.tagName&&(n.length>0?e.remove():n.push(this)),o(),l&&(s=!1),d=!1):n=[]}),(s||i||d)&&o(),e.find("> "+this.options.defaultTag).each(function(e,i){0===t(i).text().trim().length&&0===t(i).find("img").length&&0===t(i).find("br").length&&t(i).append(this.br)}),e.find("div:empty:not([class])").remove(),e.is(":empty")&&e.append(a.options.paragraphy===!0?"<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">":this.br),this.no_verify=!1},e.prototype.wrapText=function(e){if(this.isImage||this.isLink)return!1;this.allow_div=!0,this.removeBlankSpans();for(var i=this.getSelectionElements(),n=0;n<i.length;n++){var r=t(i[n]);["LI","TH","TD"].indexOf(r.get(0).tagName)>=0?this.wrapTextInElement(r,!0):this.parents(r,"li").length?this.wrapTextInElement(t(this.parents(r,"li")[0]),e):this.wrapTextInElement(this.$element,e)}this.allow_div=!1},e.prototype.convertNewLines=function(){this.$element.find("pre").each(function(e,i){var n=t(i),r=t(i).html();r.indexOf("\n")>=0&&n.html(r.replace(/\n/g,"<br>"))})},e.prototype.setHTML=function(e,i){this.no_verify=!0,this.allow_div=!0,void 0===i&&(i=!0),e=this.clean(e,!0,!1),e=e.replace(/>\s+</g,"><"),this.$element.html(e),this.cleanAttrs(this.$element.get(0)),this.convertNewLines(),this.imageList=[],this.refreshImageList(),this.options.paragraphy&&this.wrapText(!0),this.$element.find("li:empty").append(t.Editable.INVISIBLE_SPACE),this.cleanupLists(),this.cleanify(!1,!0,!1),i&&(this.restoreSelectionByMarkers(),this.sync()),this.$element.find("span").attr("data-fr-verified",!0),this.initialized&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.no_verify=!1,this.allow_div=!1},e.prototype.beforePaste=function(){this.saveSelectionByMarkers(),this.clipboardHTML=null,this.scrollPosition=this.$window.scrollTop(),this.$pasteDiv?this.$pasteDiv.html(""):(this.$pasteDiv=t('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; z-index: 4000; line-height: 140%;" tabindex="-1"></div>'),this.$box.after(this.$pasteDiv)),this.$pasteDiv.focus(),this.window.setTimeout(t.proxy(this.processPaste,this),1)},e.prototype.processPaste=function(){var i=this.clipboardHTML;null===this.clipboardHTML&&(i=this.$pasteDiv.html(),this.restoreSelectionByMarkers(),this.$window.scrollTop(this.scrollPosition));var n,r=this.triggerEvent("onPaste",[i],!1);"string"==typeof r&&(i=r),i=i.replace(/<img /gi,'<img data-fr-image-pasted="true" '),i.match(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gi)?(n=this.wordClean(i),n=this.clean(t("<div>").append(n).html(),!1,!0),n=this.removeEmptyTags(n)):(n=this.clean(i,!1,!0),n=this.removeEmptyTags(n),e.copiedText&&t("<div>").html(n).text().replace(/\u00A0/gi," ")==e.copiedText.replace(/(\u00A0|\r|\n)/gi," ")&&(n=e.copiedHTML)),this.options.plainPaste&&(n=this.plainPasteClean(n)),r=this.triggerEvent("afterPasteCleanup",[n],!1),"string"==typeof r&&(n=r),""!==n&&(this.insertHTML(n,!0,!0),this.saveSelectionByMarkers(),this.removeBlankSpans(),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").remove(),this.restoreSelectionByMarkers(),this.$element.find("li[data-indent]").each(t.proxy(function(e,i){this.indentLi?(t(i).removeAttr("data-indent"),this.indentLi(t(i))):t(i).removeAttr("data-indent")},this)),this.$element.find("li").each(t.proxy(function(e,i){this.wrapTextInElement(t(i),!0)},this)),this.options.paragraphy&&this.wrapText(!0),this.cleanupLists()),this.afterPaste()},e.prototype.afterPaste=function(){this.uploadPastedImages(),this.checkPlaceholder(),this.pasting=!1,this.triggerEvent("afterPaste",[],!0,!1)},e.prototype.getSelectedHTML=function(){function e(e,n){for(;3==n.nodeType||i.valid_nodes.indexOf(n.tagName)<0;)3!=n.nodeType&&t(e).wrapInner("<"+n.tagName+i.attrs(n)+"></"+n.tagName+">"),n=n.parentNode}var i=this,n="";if("undefined"!=typeof window.getSelection)for(var r=this.getRanges(),a=0;a<r.length;a++){var o=document.createElement("div");o.appendChild(r[a].cloneContents()),e(o,this.getSelectionParent()),n+=o.innerHTML}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(n=document.selection.createRange().htmlText);return n},e.prototype.registerPaste=function(){this.$element.on("copy cut",t.proxy(function(){this.isHTML||(e.copiedHTML=this.getSelectedHTML(),e.copiedText=t("<div>").html(e.copiedHTML).text())},this)),this.$element.on("paste",t.proxy(function(e){if(!this.isHTML){if(e.originalEvent&&(e=e.originalEvent),!this.triggerEvent("beforePaste",[],!1))return!1;if(this.clipboardPaste(e))return!1;this.clipboardHTML="",this.pasting=!0,this.scrollPosition=this.$window.scrollTop();var i=!1;if(e&&e.clipboardData&&e.clipboardData.getData){var n="",r=e.clipboardData.types;if(t.Editable.isArray(r))for(var a=0;a<r.length;a++)n+=r[a]+";";else n=r;if(/text\/html/.test(n)?this.clipboardHTML=e.clipboardData.getData("text/html"):/text\/rtf/.test(n)&&this.browser.safari?this.clipboardHTML=e.clipboardData.getData("text/rtf"):/text\/plain/.test(n)&&!this.browser.mozilla&&(this.clipboardHTML=this.escapeEntities(e.clipboardData.getData("text/plain")).replace(/\n/g,"<br/>")),""!==this.clipboardHTML?i=!0:this.clipboardHTML=null,i)return this.processPaste(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1}this.beforePaste()}},this))},e.prototype.clipboardPaste=function(e){if(e&&e.clipboardData&&e.clipboardData.items&&e.clipboardData.items[0]){var i=e.clipboardData.items[0].getAsFile();if(i){var n=new FileReader;return n.onload=t.proxy(function(t){var e=t.target.result;this.insertHTML('<img data-fr-image-pasted="true" src="'+e+'" />'),this.afterPaste()},this),n.readAsDataURL(i),!0}}return!1},e.prototype.uploadPastedImages=function(){this.options.pasteImage?this.options.imageUpload&&this.$element.find("img[data-fr-image-pasted]").each(t.proxy(function(e,i){if(0===i.src.indexOf("data:")){if(this.options.defaultImageWidth&&t(i).attr("width",this.options.defaultImageWidth),this.options.pastedImagesUploadURL){if(!this.triggerEvent("beforeUploadPastedImage",[i],!1))return!1;setTimeout(t.proxy(function(){this.showImageLoader(),this.$progress_bar.find("span").css("width","100%").text("Please wait!"),this.showByCoordinates(t(i).offset().left+t(i).width()/2,t(i).offset().top+t(i).height()+10),this.isDisabled=!0},this),10),t.ajax({type:this.options.pastedImagesUploadRequestType,url:this.options.pastedImagesUploadURL,data:t.extend({image:decodeURIComponent(i.src)},this.options.imageUploadParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers,dataType:"json"}).done(t.proxy(function(e){try{if(e.link){var n=new Image;n.onerror=t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(1)},this),n.onload=t.proxy(function(){i.src=e.link,this.hideImageLoader(),this.hide(),this.enable(),setTimeout(function(){t(i).trigger("touchend")},50),this.triggerEvent("afterUploadPastedImage",[t(i)])},this),n.src=e.link}else e.error?(t(i).remove(),this.hide(),this.throwImageErrorWithMessage(e.error)):(t(i).remove(),this.hide(),this.throwImageError(2))}catch(r){t(i).remove(),this.hide(),this.throwImageError(4)}},this)).fail(t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(3)},this))}}else 0!==i.src.indexOf("http")&&t(i).remove();t(i).removeAttr("data-fr-image-pasted")},this)):this.$element.find("img[data-fr-image-pasted]").remove()},e.prototype.disable=function(){this.isDisabled=!0,this.$element.blur(),this.$box.addClass("fr-disabled"),this.$element.attr("contenteditable",!1)},e.prototype.enable=function(){this.isDisabled=!1,this.$box.removeClass("fr-disabled"),this.$element.attr("contenteditable",!0)},e.prototype.wordClean=function(t){t.indexOf("<body")>=0&&(t=t.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1")),t=t.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3</li></ol>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ol>"),t=t.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),t=t.replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,""),t=t.replace(/<!\[if \!supportLists\]>([\s\S]*?)<!\[endif\]>/gi,""),t=t.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),t=t.replace(/<!--[\s\S]*?-->/gi,""),t=t.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var e=["style","script","applet","embed","noframes","noscript"],i=0;i<e.length;i++){var n=new RegExp("<"+e[i]+".*?"+e[i]+"(.*?)>","gi");t=t.replace(n,"")}t=t.replace(/&nbsp;/gi," ");var r;do r=t,t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"");while(t!=r);return t=t.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>'),t=t.replace(/<lilevel1([^>]*)>/gi,"<li$1>"),t=this.clean(t),t=t.replace(/<a>(.[^<]+)<\/a>/gi,"$1")},e.prototype.tabs=function(t){for(var e="",i=0;t>i;i++)e+="  ";return e},e.prototype.cleanTags=function(t,e){void 0===e&&(e=!1);var i,n,r,a,o=[],s=[],l=!1,d=!1,h=this.options.formatTags;for(n=0;n<t.length;n++)if(i=t.charAt(n),"<"==i){var p=t.indexOf(">",n+1);if(-1!==p){var c=t.substring(n,p+1),u=this.tagName(c);if(0===u.indexOf("!--")&&(p=t.indexOf("-->",n+1),-1!==p)){c=t.substring(n,p+3),s.push(c),n=p+2;continue}if(0===u.indexOf("!")&&s.length&&s[s.length-1]!=c){s.push(c),n=p;continue}if("head"==u&&this.options.fullPage&&(d=!0),d){s.push(c),n=p,"head"==u&&this.isClosingTag(c)&&(d=!1);continue}if(this.options.allowedTags.indexOf(u)<0&&(!this.options.fullPage||["html","head","body","!doctype"].indexOf(u)<0)){n=p;continue}var f=this.isClosingTag(c);if("pre"===u&&(l=f?!1:!0),this.isSelfClosingTag(c))s.push("br"===u&&l?"\n":c);else if(f)for(r=!1,a=!0;r===!1&&void 0!==a;)a=o.pop(),void 0!==a&&a.tag_name!==u?s.splice(a.i,1):(r=!0,void 0!==a&&s.push(c));else s.push(c),o.push({tag_name:u,i:s.length-1});n=p}}else"\n"===i&&this.options.beautifyCode?e&&l?s.push("<br/>"):l?s.push(i):o.length>0&&s.push(" "):9!=i.charCodeAt(0)&&s.push(i);for(;o.length>0;)a=o.pop(),s.splice(a.i,1);var m="\n";this.options.beautifyCode||(m=""),t="",o=0;var g=!0;for(n=0;n<s.length;n++)1==s[n].length?g&&" "===s[n]||(t+=s[n],g=!1):h.indexOf(this.tagName(s[n]).toLowerCase())<0?(t+=s[n],"br"==this.tagName(s[n])&&(t+=m)):this.isSelfClosingTag(s[n])?h.indexOf(this.tagName(s[n]).toLowerCase())>=0?(t+=this.tabs(o)+s[n]+m,g=!1):t+=s[n]:this.isClosingTag(s[n])?(o-=1,0===o&&(g=!0),t.length>0&&t[t.length-1]==m&&(t+=this.tabs(o)),t+=s[n]+m):(t+=m+this.tabs(o)+s[n],o+=1,g=!1);return t[0]==m&&(t=t.substring(1,t.length)),t[t.length-1]==m&&(t=t.substring(0,t.length-1)),t},e.prototype.cleanupLists=function(){this.$element.find("ul, ol").each(t.proxy(function(e,i){var n=t(i);if(this.parents(t(i),"ul, ol").length>0)return!0;if(n.find(".close-ul, .open-ul, .close-ol, .open-ol, .open-li, .close-li").length>0){var r="<"+i.tagName.toLowerCase()+">"+n.html()+"</"+i.tagName.toLowerCase()+">";r=r.replace(new RegExp('<span class="close-ul" data-fr-verified="true"></span>',"g"),"</ul>"),r=r.replace(new RegExp('<span class="open-ul" data-fr-verified="true"></span>',"g"),"<ul>"),r=r.replace(new RegExp('<span class="close-ol" data-fr-verified="true"></span>',"g"),"</ol>"),r=r.replace(new RegExp('<span class="open-ol" data-fr-verified="true"></span>',"g"),"<ol>"),r=r.replace(new RegExp('<span class="close-li" data-fr-verified="true"></span>',"g"),"</li>"),r=r.replace(new RegExp('<span class="open-li" data-fr-verified="true"></span>',"g"),"<li>"),r=r.replace(new RegExp("<li></li>","g"),""),n.replaceWith(r)}},this)),this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find(" > li").wrap("<ul>"),this.$element.find("ul, ol").each(t.proxy(function(e,i){var n=t(i);0===n.find(this.valid_nodes.join(",")).length&&n.remove()},this)),this.$element.find("li > ul, li > ol").each(t.proxy(function(e,i){var n=t(i).parent().get(0).previousSibling;this.isFirstSibling(i)&&(n&&"LI"==n.tagName?t(n).append(t(i)):t(i).before("<br/>"))},this)),this.$element.find("li:empty").remove();for(var e=this.$element.find("ol + ol, ul + ul"),i=0;i<e.length;i++){var n=t(e[i]);this.attrs(e[i])==this.attrs(n.prev().get(0))&&(n.prev().append(n.html()),n.remove())}this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find("li > "+this.options.defaultTag).each(function(e,i){0===i.attributes.length&&t(i).replaceWith(t(i).html())})},e.prototype.escapeEntities=function(t){return t.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&apos;")},e.prototype.cleanNodeAttrs=function(t,e){var i=t.attributes;if(i)for(var n=new RegExp("^"+e.join("$|^")+"$","i"),r=0;r<i.length;r++){var a=i[r];n.test(a.nodeName)?t.setAttribute(a.nodeName,a.nodeValue.replace(/</gi,"&lt;").replace(/>/gi,"&gt;")):t.removeAttribute(a.nodeName)}},e.prototype.cleanAttrs=function(t){1==t.nodeType&&t.className.indexOf("f-marker")<0&&t!==this.$element.get(0)&&"IFRAME"!=t.tagName&&this.cleanNodeAttrs(t,this.options.allowedAttrs,!0);for(var e=t.childNodes,i=0;i<e.length;i++)this.cleanAttrs(e[i])},e.prototype.clean=function(i,n,r,a,o){this.pasting&&e.copiedText===t("<div>").html(i).text()&&(r=!1,n=!0),o||(o=t.merge([],this.options.allowedAttrs)),a||(a=t.merge([],this.options.allowedTags)),n||o.indexOf("id")>-1&&o.splice(o.indexOf("id"),1),
this.options.fullPage&&(i=i.replace(/<!DOCTYPE([^>]*?)>/i,"<!-- DOCTYPE$1 -->"),i=i.replace(/<html([^>]*?)>/i,"<!-- html$1 -->"),i=i.replace(/<\/html([^>]*?)>/i,"<!-- /html$1 -->"),i=i.replace(/<body([^>]*?)>/i,"<!-- body$1 -->"),i=i.replace(/<\/body([^>]*?)>/i,"<!-- /body$1 -->"),i=i.replace(/<head>([\w\W]*)<\/head>/i,function(t,e){var i=1;return e=e.replace(/(<style)/gi,function(t,e){return e+" data-id="+i++}),"<!-- head "+e.replace(/(>)([\s|\t]*)(<)/gi,"$1$3").replace(/</gi,"[").replace(/>/gi,"]")+" -->"})),this.options.allowComments?(this.options.allowedTags.push("!--"),this.options.allowedTags.push("!")):i=i.replace(/(<!--[.\s\w\W]*?-->)/gi,""),this.options.allowScript||(i=i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),this.options.allowStyle||(i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"")),i=i.replace(/<!--([.\s\w\W]*?)-->/gi,function(t,e){return"<!--"+e.replace(/</g,"[[").replace(/>/g,"]]")+"-->"});var s=new RegExp("<\\/?((?!(?:"+a.join(" |")+" |"+a.join(">|")+">|"+a.join("/>|")+"/>))\\w+)[^>]*?>","gi");if(i=i.replace(s,""),i=i.replace(/<!--([.\s\w\W]*?)-->/gi,function(t,e){return"<!--"+e.replace(/\[\[/g,"<").replace(/\]\]/g,">")+"-->"}),r){var l=new RegExp("style=(\"[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/'%]*\"|'[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/\"%]*')","gi");i=i.replace(l,""),i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"")}i=this.cleanTags(i,!0),i=i.replace(/(\r|\n)/gi,"");var d=new RegExp("<([^>]*)( src| href)=('[^']*'|\"[^\"]*\"|[^\\s>]+)([^>]*)>","gi");if(i=i.replace(d,t.proxy(function(t,e,i,n,r){return"<"+e+i+'="'+this.sanitizeURL(n.replace(/^["'](.*)["']\/?$/gi,"$1"))+'"'+r+">"},this)),!n){var h=t("<div>").append(i);h.find('[class]:not([class^="fr-"])').each(function(e,i){t(i).removeAttr("class")}),i=h.html()}return i},e.prototype.removeBlankSpans=function(){this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),this.$element.find("span").each(t.proxy(function(e,i){0===this.attrs(i).length&&t(i).replaceWith(t(i).html())},this)),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1},e.prototype.plainPasteClean=function(e){var i=t("<div>").html(e);i.find("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote").each(t.proxy(function(e,i){t(i).replaceWith("<"+this.options.defaultTag+">"+t(i).html()+"</"+this.options.defaultTag+">")},this)),t(i.find("*").not("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote, ul, ol, li, table, tbody, thead, tr, td, br").get().reverse()).each(function(){t(this).replaceWith(t(this).html())});var n=function(e){for(var i=e.contents(),r=0;r<i.length;r++)3!=i[r].nodeType&&1!=i[r].nodeType?t(i[r]).remove():n(t(i[r]))};return n(i),i.html()},e.prototype.removeEmptyTags=function(e){for(var i,n=t("<div>").html(e),r=n.find("*:empty:not(br, img, td, th)");r.length;){for(i=0;i<r.length;i++)t(r[i]).remove();r=n.find("*:empty:not(br, img, td, th)")}for(var a=n.find("> div, td > div, th > div, li > div");a.length;){var o=t(a[a.length-1]);o.replaceWith(o.html()+"<br/>"),a=n.find("> div, td > div, th > div, li > div")}for(a=n.find("div");a.length;){for(i=0;i<a.length;i++){var s=t(a[i]),l=s.html().replace(/\u0009/gi,"").trim();s.replaceWith(l)}a=n.find("div")}return n.html()},e.prototype.initElementStyle=function(){this.editableDisabled||this.$element.attr("contenteditable",!0);var t="froala-view froala-element "+this.options.editorClass;this.browser.msie&&e.getIEversion()<9&&(t+=" ie8"),this.$element.css("outline",0),this.browser.msie||(t+=" not-msie"),this.$element.addClass(t)},e.prototype.CJKclean=function(t){var e=/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi;return t.replace(e,"")},e.prototype.enableTyping=function(){this.typingTimer=null,this.$element.on("keydown","textarea, input",function(t){t.stopPropagation()}),this.$element.on("keydown cut",t.proxy(function(e){if(!this.isHTML){if(!this.options.multiLine&&13==e.which)return e.preventDefault(),e.stopPropagation(),!1;if("keydown"===e.type&&!this.triggerEvent("keydown",[e],!1))return!1;clearTimeout(this.typingTimer),this.ajaxSave=!1,this.oldHTML=this.getHTML(!0,!1),this.typingTimer=setTimeout(t.proxy(function(){var t=this.getHTML(!0,!1);this.ime||this.CJKclean(t)===this.CJKclean(this.oldHTML)||this.CJKclean(t)!==t||this.sync()},this),Math.max(this.options.typingTimer,500))}},this))},e.prototype.removeMarkersByRegex=function(t){return t.replace(/<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>([\S\s][^\/])*<\/span>/gi,"")},e.prototype.getImageHTML=function(){return JSON.stringify({src:this.$element.find("img").attr("src"),style:this.$element.find("img").attr("style"),alt:this.$element.find("img").attr("alt"),width:this.$element.find("img").attr("width"),link:this.$element.find("a").attr("href"),link_title:this.$element.find("a").attr("title"),link_target:this.$element.find("a").attr("target")})},e.prototype.getLinkHTML=function(){return JSON.stringify({body:this.$element.html(),href:this.$element.attr("href"),title:this.$element.attr("title"),popout:this.$element.hasClass("popout"),nofollow:"nofollow"==this.$element.attr("ref"),blank:"_blank"==this.$element.attr("target"),cls:this.$element.attr("class")?this.$element.attr("class").replace(/froala-element ?|not-msie ?|froala-view ?/gi,"").trim():""})},e.prototype.addFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").addClass("fr-tag")},e.prototype.removeFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").removeClass("fr-tag")},e.prototype.getHTML=function(e,i,n){if(void 0===e&&(e=!1),void 0===i&&(i=this.options.useFrTag),void 0===n&&(n=!0),this.$element.hasClass("f-placeholder")&&!e)return"";if(this.isHTML)return this.$html_area.val();if(this.isImage)return this.getImageHTML();if(this.isLink)return this.getLinkHTML();this.$element.find("a").data("fr-link",!0),i&&this.addFrTag(),this.$element.find(".f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class")))},this)),this.options.useClasses||this.$element.find("img").each(t.proxy(function(e,i){var n=t(i);n.attr("data-style",this.getImageStyle(n))},this)),this.$element.find("pre").each(t.proxy(function(e,i){var n=t(i),r=n.html(),a=r.replace(/\&nbsp;/gi," ").replace(/\n/gi,"<br>");r!=a&&(this.saveSelectionByMarkers(),n.html(a),this.restoreSelectionByMarkers())},this)),this.$element.find("pre br").addClass("fr-br"),this.$element.find('[class=""]').removeAttr("class"),this.cleanAttrs(this.$element.get(0));var r=this.$element.html();this.removeFrTag(),this.$element.find("pre br").removeAttr("class"),r=r.replace(/<a[^>]*?><\/a>/g,""),e||(r=this.removeMarkersByRegex(r)),r=r.replace(/<span[^>]*? class\s*=\s*["']?f-img-handle[^>]+><\/span>/gi,""),r=r.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-editor[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),r=r.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-wrap[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),this.options.useClasses||(r=r.replace(/data-style/gi,"style"),r=r.replace(/(<img[^>]*)( class\s*=['"]?[a-zA-Z0-9- ]+['"]?)([^>]*\/?>)/gi,"$1$3")),this.options.simpleAmpersand&&(r=r.replace(/\&amp;/gi,"&")),n&&(r=r.replace(/ data-fr-verified="true"/gi,"")),this.options.beautifyCode&&(r=r.replace(/\n/gi,"")),r=r.replace(/<br class="fr-br">/gi,"\n"),r=r.replace(/\u200B/gi,""),this.options.fullPage&&(r=r.replace(/<!-- DOCTYPE([^>]*?) -->/i,"<!DOCTYPE$1>"),r=r.replace(/<!-- html([^>]*?) -->/i,"<html$1>"),r=r.replace(/<!-- \/html([^>]*?) -->/i,"</html$1>"),r=r.replace(/<!-- body([^>]*?) -->/i,"<body$1>"),r=r.replace(/<!-- \/body([^>]*?) -->/i,"</body$1>"),r=r.replace(/<!-- head ([\w\W]*?) -->/i,function(t,e){return"<head>"+e.replace(/\[/gi,"<").replace(/\]/gi,">")+"</head>"}));var a=this.triggerEvent("getHTML",[r],!1);return"string"==typeof a?a:r},e.prototype.getText=function(){return this.$element.text()},e.prototype.setDirty=function(t){this.dirty=t,t||(clearTimeout(this.ajaxInterval),this.ajaxHTML=this.getHTML(!1,!1))},e.prototype.initAjaxSaver=function(){this.ajaxHTML=this.getHTML(!1,!1),this.ajaxSave=!0,this.ajaxInterval=setInterval(t.proxy(function(){var t=this.getHTML(!1,!1);(this.ajaxHTML!=t||this.dirty)&&this.ajaxSave&&(this.options.autosave&&this.save(),this.dirty=!1,this.ajaxHTML=t),this.ajaxSave=!0},this),Math.max(this.options.autosaveInterval,100))},e.prototype.disableBrowserUndo=function(){this.$element.keydown(t.proxy(function(t){var e=t.which,i=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.isHTML&&i){if(90==e&&t.shiftKey)return t.preventDefault(),!1;if(90==e)return t.preventDefault(),!1}},this))},e.prototype.shortcutEnabled=function(t){return this.options.shortcutsAvailable.indexOf(t)>=0},e.prototype.shortcuts_map={69:{cmd:"show",params:[null],id:"show"},66:{cmd:"exec",params:["bold"],id:"bold"},73:{cmd:"exec",params:["italic"],id:"italic"},85:{cmd:"exec",params:["underline"],id:"underline"},83:{cmd:"exec",params:["strikeThrough"],id:"strikeThrough"},75:{cmd:"exec",params:["createLink"],id:"createLink"},80:{cmd:"exec",params:["insertImage"],id:"insertImage"},221:{cmd:"exec",params:["indent"],id:"indent"},219:{cmd:"exec",params:["outdent"],id:"outdent"},72:{cmd:"exec",params:["html"],id:"html"},48:{cmd:"exec",params:["formatBlock","n"],id:"formatBlock n"},49:{cmd:"exec",params:["formatBlock","h1"],id:"formatBlock h1"},50:{cmd:"exec",params:["formatBlock","h2"],id:"formatBlock h2"},51:{cmd:"exec",params:["formatBlock","h3"],id:"formatBlock h3"},52:{cmd:"exec",params:["formatBlock","h4"],id:"formatBlock h4"},53:{cmd:"exec",params:["formatBlock","h5"],id:"formatBlock h5"},54:{cmd:"exec",params:["formatBlock","h6"],id:"formatBlock h6"},222:{cmd:"exec",params:["formatBlock","blockquote"],id:"formatBlock blockquote"},220:{cmd:"exec",params:["formatBlock","pre"],id:"formatBlock pre"}},e.prototype.ctrlKey=function(t){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(t.metaKey&&!t.altKey)return!0}else if(t.ctrlKey&&!t.altKey)return!0;return!1},e.prototype.initShortcuts=function(){this.options.shortcuts&&this.$element.on("keydown",t.proxy(function(t){var e=t.which,i=this.ctrlKey(t);if(!this.isHTML&&i){if(this.shortcuts_map[e]&&this.shortcutEnabled(this.shortcuts_map[e].id))return this.execDefaultShortcut(this.shortcuts_map[e].cmd,this.shortcuts_map[e].params);if(90==e&&t.shiftKey)return t.preventDefault(),t.stopPropagation(),this.redo(),!1;if(90==e)return t.preventDefault(),t.stopPropagation(),this.undo(),!1}},this))},e.prototype.initTabs=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;if(9!=e||t.shiftKey)9==e&&t.shiftKey&&(this.raiseEvent("shift+tab")?this.options.tabSpaces?t.preventDefault():this.blur():t.preventDefault());else if(this.raiseEvent("tab"))if(this.options.tabSpaces){t.preventDefault();var i="&nbsp;&nbsp;&nbsp;&nbsp;",n=this.getSelectionElements()[0];"PRE"===n.tagName&&(i="    "),this.insertHTML(i,!1)}else this.blur();else t.preventDefault()},this))},e.prototype.textEmpty=function(e){var i=t(e).text().replace(/(\r\n|\n|\r|\t)/gm,"");return(""===i||e===this.$element.get(0))&&0===t(e).find("br").length},e.prototype.inEditor=function(t){for(;t&&"BODY"!==t.tagName;){if(t===this.$element.get(0))return!0;t=t.parentNode}return!1},e.prototype.focus=function(e){if(this.isDisabled)return!1;if(void 0===e&&(e=!0),""!==this.text()&&!this.$element.is(":focus"))return void(this.browser.msie||(this.clearSelection(),this.$element.focus()));if(!this.isHTML){if(e&&!this.pasting&&this.$element.focus(),this.pasting&&!this.$element.is(":focus")&&this.$element.focus(),this.$element.hasClass("f-placeholder"))return void this.setSelection(this.$element.find(this.options.defaultTag).length>0?this.$element.find(this.options.defaultTag)[0]:this.$element.get(0));var i=this.getRange();if(""===this.text()&&i&&(0===i.startOffset||i.startContainer===this.$element.get(0)||!this.inEditor(i.startContainer))){var n,r,a=this.getSelectionElements();if(t.merge(["IMG","BR"],this.valid_nodes).indexOf(this.getSelectionElement().tagName)<0)return!1;if(i.startOffset>0&&this.valid_nodes.indexOf(this.getSelectionElement().tagName)>=0&&"BODY"!=i.startContainer.tagName||i.startContainer&&3===i.startContainer.nodeType)return;if(!this.options.paragraphy&&a.length>=1&&a[0]===this.$element.get(0)){var o=function(e){if(!e)return null;if(3==e.nodeType&&e.textContent.length>0)return e;if(1==e.nodeType&&"BR"==e.tagName)return e;for(var i=t(e).contents(),n=0;n<i.length;n++){var r=o(i[n]);if(null!=r)return r}return null};if(0===i.startOffset&&this.$element.contents().length>0&&3!=this.$element.contents()[0].nodeType){var s=o(this.$element.get(0));null!=s&&("BR"==s.tagName?this.$element.is(":focus")&&(t(s).before(this.markers_html),this.restoreSelectionByMarkers()):this.setSelection(s))}return!1}if(a.length>=1&&a[0]!==this.$element.get(0))for(n=0;n<a.length;n++){if(r=a[n],!this.textEmpty(r)||this.browser.msie)return void this.setSelection(r);if(this.textEmpty(r)&&["LI","TD"].indexOf(r.tagName)>=0)return}if(i.startContainer===this.$element.get(0)&&i.startOffset>0&&!this.options.paragraphy)return void this.setSelection(this.$element.get(0),i.startOffset);for(a=this.$element.find(this.valid_nodes.join(",")),n=0;n<a.length;n++)if(r=a[n],!this.textEmpty(r)&&0===t(r).find(this.valid_nodes.join(",")).length)return void this.setSelection(r);this.setSelection(this.$element.get(0))}}},e.prototype.addMarkersAtEnd=function(e){if(e.find(".fr-marker").length>0)return!1;for(var i=e.get(0),n=t(i).contents();n.length&&this.valid_nodes.indexOf(n[n.length-1].tagName)>=0;)i=n[n.length-1],n=t(n[n.length-1]).contents();t(i).append(this.markers_html)},e.prototype.setFocusAtEnd=function(t){void 0===t&&(t=this.$element),this.addMarkersAtEnd(t),this.restoreSelectionByMarkers()},e.prototype.breakHTML=function(e,i){"undefined"==typeof i&&(i=!0),this.removeMarkers(),0===this.$element.find("break").length&&this.insertSimpleHTML("<break></break>");var n=this.parents(this.$element.find("break"),t.merge(["UL","OL"],this.valid_nodes).join(","))[0];if(this.parents(t(n),"ul, ol").length&&(n=this.parents(t(n),"ul, ol")[0]),void 0===n&&(n=this.$element.get(0)),["UL","OL"].indexOf(n.tagName)>=0){var r=t("<div>").html(e);r.find("> li").wrap("<"+n.tagName+">"),e=r.html()}if(n==this.$element.get(0)){if(this.$element.find("break").next().length){this.insertSimpleHTML('<div id="inserted-div">'+e+"</div>");var a=this.$element.find("div#inserted-div");this.setFocusAtEnd(a),this.saveSelectionByMarkers(),a.replaceWith(a.contents()),this.restoreSelectionByMarkers()}else this.insertSimpleHTML(e),this.setFocusAtEnd();return this.$element.find("break").remove(),this.checkPlaceholder(),!0}if("TD"===n.tagName)return this.$element.find("break").remove(),this.insertSimpleHTML(e),!0;var o=t("<div>").html(e);if(this.addMarkersAtEnd(o),e=o.html(),this.emptyElement(t(n)))return t(n).replaceWith(e),this.restoreSelectionByMarkers(),this.checkPlaceholder(),!0;this.$element.find("li").each(t.proxy(function(e,i){this.emptyElement(i)&&t(i).addClass("empty-li")},this));for(var s,l,d=t("<div></div>").append(t(n).clone()).html(),h=[],p={},c=[],u=0,f=0;f<d.length;f++)if(l=d.charAt(f),"<"==l){var m=d.indexOf(">",f+1);if(-1!==m){s=d.substring(f,m+1);var g=this.tagName(s);if(f=m,"break"==g){if(!this.isClosingTag(s)){for(var v=!0,b=[],y=h.length-1;y>=0;y--){var w=this.tagName(h[y]);if(!i&&"LI"==w.toUpperCase()){v=!1;break}c.push("</"+w+">"),b.push(h[y])}c.push(e),v||c.push("</li><li>");for(var E=0;E<b.length;E++)c.push(b[E])}}else if(c.push(s),!this.isSelfClosingTag(s))if(this.isClosingTag(s)){var $=p[g].pop();h.splice($,1)}else h.push(s),void 0===p[g]&&(p[g]=[]),p[g].push(h.length-1)}}else u++,c.push(l);t(n).replaceWith(c.join("")),this.$element.find("li").each(t.proxy(function(e,i){var n=t(i);n.hasClass("empty-li")?n.removeClass("empty-li"):this.emptyElement(i)&&n.remove()},this)),this.cleanupLists(),this.restoreSelectionByMarkers()},e.prototype.insertSimpleHTML=function(t){var e,i;if(this.no_verify=!0,this.window.getSelection){if(e=this.window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),this.browser.webkit?i.collapsed||this.document.execCommand("delete"):i.deleteContents(),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").remove();var n=this.document.createElement("div");n.innerHTML=t;for(var r,a,o=this.document.createDocumentFragment();r=n.firstChild;)a=o.appendChild(r);i.insertNode(o),a&&(i=i.cloneRange(),i.setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else if((e=this.document.selection)&&"Control"!=e.type){var s=e.createRange();s.collapse(!0),e.createRange().pasteHTML(t)}this.no_verify=!1},e.prototype.insertHTML=function(e,i,n){if(void 0===i&&(i=!0),void 0===n&&(n=!1),!this.isHTML&&i&&this.focus(),this.removeMarkers(),this.insertSimpleHTML("<break></break>"),this.checkPlaceholder(!0),this.$element.hasClass("f-placeholder"))return this.$element.html(e),this.options.paragraphy&&this.wrapText(!0),this.$element.find("p > br").each(function(){var e=this.parentNode;1==t(e).contents().length&&t(e).remove()}),this.$element.find("break").remove(),this.setFocusAtEnd(),this.checkPlaceholder(),this.convertNewLines(),!1;for(var r=t("<div>").append(e).find("*"),a=0;a<r.length;a++)if(this.valid_nodes.indexOf(r[a].tagName)>=0)return this.breakHTML(e),this.$element.find("break").remove(),this.convertNewLines(),!1;this.$element.find("break").remove(),this.insertSimpleHTML(e),this.convertNewLines()},e.prototype.execDefaultShortcut=function(t,e){return this[t].apply(this,e),!1},e.prototype.initEditor=function(){var i="froala-editor";this.mobile()&&(i+=" touch"),this.browser.msie&&e.getIEversion()<9&&(i+=" ie8"),this.$editor=t('<div class="'+i+'" style="display: none;">');var n=this.$document.find(this.options.scrollableContainer);n.append(this.$editor),this.options.inlineMode?this.initInlineEditor():this.initBasicEditor()},e.prototype.refreshToolbarPosition=function(){this.$window.scrollTop()>this.$box.offset().top&&this.$window.scrollTop()<this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.iOS()&&(this.$element.is(":focus")?this.$editor.css("top",this.$window.scrollTop()):this.$editor.css("top",""))):this.$window.scrollTop()<this.$box.offset().top?this.iOS()&&this.$element.is(":focus")?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.$editor.css("top",this.$box.offset().top)):(this.$editor.removeClass("f-scroll f-scroll-abs").css("bottom","").css("top","").width(""),this.$element.css("padding-top",""),this.$placeholder.css("margin-top","")):this.$window.scrollTop()>this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()&&!this.$editor.hasClass("f-scroll-abs")?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.removeClass("f-scroll").addClass("f-scroll-abs"),this.$editor.css("bottom",0).css("top","").css("left","")):this.$editor.removeClass("f-scroll").css("bottom","").css("top","").css("left","").width("")},e.prototype.toolbarTop=function(){this.options.toolbarFixed||this.options.inlineMode||(this.$element.data("padding-top",parseInt(this.$element.css("padding-top"),10)),this.$window.on("scroll resize load",t.proxy(function(){this.refreshToolbarPosition()},this)),this.iOS()&&this.$element.on("focus blur",t.proxy(function(){this.refreshToolbarPosition()},this)))},e.prototype.initBasicEditor=function(){this.$element.addClass("f-basic"),this.$wrapper.addClass("f-basic"),this.$popup_editor=this.$editor.clone();var t=this.$document.find(this.options.scrollableContainer);this.$popup_editor.appendTo(t).addClass("f-inline"),this.$editor.addClass("f-basic").show(),this.$editor.insertBefore(this.$wrapper),this.toolbarTop()},e.prototype.initInlineEditor=function(){this.$editor.addClass("f-inline"),this.$element.addClass("f-inline"),this.$popup_editor=this.$editor},e.prototype.initDrag=function(){this.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!this.window.FormData,progress:"upload"in new XMLHttpRequest}},e.prototype.initOptions=function(){this.setDimensions(),this.setSpellcheck(),this.setImageUploadURL(),this.setButtons(),this.setDirection(),this.setZIndex(),this.setTheme(),this.options.editInPopup&&this.buildEditPopup(),this.editableDisabled||(this.setPlaceholder(),this.setPlaceholderEvents())},e.prototype.setAllowStyle=function(t){"undefined"==typeof t&&(t=this.options.allowStyle),t?this.options.allowedTags.push("style"):this.options.allowedTags.splice(this.options.allowedTags.indexOf("style"),1)},e.prototype.setAllowScript=function(t){"undefined"==typeof t&&(t=this.options.allowScript),t?this.options.allowedTags.push("script"):this.options.allowedTags.splice(this.options.allowedTags.indexOf("script"),1)},e.prototype.isTouch=function(){return WYSIWYGModernizr.touch&&void 0!==this.window.Touch},e.prototype.initEditorSelection=function(){this.$element.on("keyup",t.proxy(function(t){return this.triggerEvent("keyup",[t],!1)},this)),this.$element.on("focus",t.proxy(function(){this.blurred&&(this.blurred=!1,this.pasting||""!==this.text()||this.focus(!1),this.triggerEvent("focus",[],!1))},this)),this.$element.on("mousedown touchstart",t.proxy(function(){return this.isDisabled?!1:void(this.isResizing()||(this.closeImageMode(),this.hide()))},this)),this.options.disableRightClick&&this.$element.contextmenu(t.proxy(function(t){return t.preventDefault(),this.options.inlineMode&&this.$element.focus(),!1},this)),this.$element.on(this.mouseup,t.proxy(function(e){if(this.isDisabled)return!1;if(!this.isResizing()){var i=this.text();e.stopPropagation(),this.imageMode=!1,!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode?this.options.inlineMode||this.refreshButtons():setTimeout(t.proxy(function(){i=this.text(),!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode||(this.show(e),this.options.editInPopup&&this.showEditPopup())},this),0)}this.hideDropdowns(),this.hideOtherEditors()},this)),this.$editor.on(this.mouseup,t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||(t.stopPropagation(),this.options.inlineMode===!1&&this.hide()))},this)),this.$editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.$edit_popup_wrapper&&this.$edit_popup_wrapper.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.setDocumentSelectionChangeEvent(),this.setWindowMouseUpEvent(),this.setWindowKeyDownEvent(),this.setWindowKeyUpEvent(),this.setWindowOrientationChangeEvent(),this.setWindowHideEvent(),this.setWindowBlurEvent(),this.options.trackScroll&&this.setWindowScrollEvent(),this.setWindowResize()},e.prototype.setWindowResize=function(){this.$window.on("resize."+this._id,t.proxy(function(){this.hide(),this.closeImageMode(),this.imageMode=!1},this))},e.prototype.blur=function(e){this.blurred||this.pasting||(this.selectionDisabled=!0,this.triggerEvent("blur",[]),e&&0===t("*:focus").length&&this.clearSelection(),this.isLink||this.isImage||(this.selectionDisabled=!1),this.blurred=!0)},e.prototype.setWindowBlurEvent=function(){this.$window.on("blur."+this._id,t.proxy(function(t,e){this.blur(e)},this))},e.prototype.setWindowHideEvent=function(){this.$window.on("hide."+this._id,t.proxy(function(){this.isResizing()?this.$element.find(".f-img-handle").trigger("moveend"):this.hide(!1)},this))},e.prototype.setWindowOrientationChangeEvent=function(){this.$window.on("orientationchange."+this._id,t.proxy(function(){setTimeout(t.proxy(function(){this.hide()},this),10)},this))},e.prototype.setDocumentSelectionChangeEvent=function(){this.$document.on("selectionchange."+this._id,t.proxy(function(e){return this.isDisabled?!1:void(this.isResizing()||this.isScrolling||(clearTimeout(this.selectionChangedTimeout),this.selectionChangedTimeout=setTimeout(t.proxy(function(){if(this.options.inlineMode&&this.selectionInEditor()&&this.link!==!0&&this.isTouch()){var t=this.text();""!==t?(this.iPod()?this.options.alwaysVisible&&this.hide():this.show(null),e.stopPropagation()):this.options.alwaysVisible?this.show(null):(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this),75)))},this))},e.prototype.setWindowMouseUpEvent=function(){this.$window.on(this.mouseup+"."+this._id,t.proxy(function(){return this.browser.webkit&&!this.initMouseUp?(this.initMouseUp=!0,!1):(this.isResizing()||this.isScrolling||this.isDisabled||(this.$bttn_wrapper.find("button.fr-trigger").removeClass("active"),this.selectionInEditor()&&""!==this.text()&&!this.isTouch()?this.show(null):this.$popup_editor.is(":visible")&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.blur(!0)),void t("[data-down]").removeAttr("data-down"))},this))},e.prototype.setWindowKeyDownEvent=function(){this.$window.on("keydown."+this._id,t.proxy(function(e){var i=e.which;if(27==i&&(this.focus(),this.restoreSelection(),this.hide(),this.closeImageMode(),this.imageMode=!1),this.imageMode){if(13==i)return this.$element.find(".f-img-editor").parents(".f-img-wrap").before("<br/>"),this.sync(),this.$element.find(".f-img-editor img").click(),!1;if(46==i||8==i)return e.stopPropagation(),e.preventDefault(),setTimeout(t.proxy(function(){this.removeImage(this.$element.find(".f-img-editor img"))},this),0),!1}else if(this.selectionInEditor()){if(this.isDisabled)return!0;var n=(e.ctrlKey||e.metaKey)&&!e.altKey;!n&&this.$popup_editor.is(":visible")&&this.$bttn_wrapper.is(":visible")&&this.options.inlineMode&&(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this))},e.prototype.setWindowKeyUpEvent=function(){this.$window.on("keyup."+this._id,t.proxy(function(){return this.isDisabled?!1:void(this.selectionInEditor()&&""!==this.text()&&!this.$popup_editor.is(":visible")&&this.repositionEditor())},this))},e.prototype.setWindowScrollEvent=function(){t.merge(this.$window,t(this.options.scrollableContainer)).on("scroll."+this._id,t.proxy(function(){return this.isDisabled?!1:(clearTimeout(this.scrollTimer),this.isScrolling=!0,void(this.scrollTimer=setTimeout(t.proxy(function(){this.isScrolling=!1},this),2500)))},this))},e.prototype.setPlaceholder=function(e){e&&(this.options.placeholder=e),this.$textarea&&this.$textarea.attr("placeholder",this.options.placeholder),this.$placeholder||(this.$placeholder=t('<span class="fr-placeholder" unselectable="on"></span>').bind("click",t.proxy(function(){this.focus()},this)),this.$element.after(this.$placeholder)),this.$placeholder.text(this.options.placeholder)},e.prototype.isEmpty=function(){var e=this.$element.text().replace(/(\r\n|\n|\r|\t|\u200B|\u0020)/gm,"");return""===e&&0===this.$element.find("img, table, iframe, input, textarea, hr, li, object").length&&0===this.$element.find(this.options.defaultTag+" > br, br").length&&0===this.$element.find(t.map(this.valid_nodes,t.proxy(function(t){return this.options.defaultTag==t?null:t},this)).join(", ")).length},e.prototype.checkPlaceholder=function(i){if(this.isDisabled&&!i)return!1;if(this.pasting&&!i)return!1;if(this.$element.find("td:empty, th:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").append(this.br),!this.isHTML)if(this.isEmpty()&&!this.fakeEmpty()){var n,r=this.selectionInEditor()||this.$element.is(":focus");this.options.paragraphy?(n=t("<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">"),this.$element.html(n),r&&this.setSelection(n.get(0)),this.$element.addClass("f-placeholder")):(0!==this.$element.find("br").length||this.browser.msie&&e.getIEversion()<=10||(this.$element.append(this.br),r&&this.browser.msie&&this.focus()),this.$element.addClass("f-placeholder"))}else!this.$element.find(this.options.defaultTag+", li, td, th").length&&this.options.paragraphy?(this.wrapText(!0),this.$element.find(this.options.defaultTag).length&&""===this.text()?this.setSelection(this.$element.find(this.options.defaultTag)[0],this.$element.find(this.options.defaultTag).text().length,null,this.$element.find(this.options.defaultTag).text().length):this.$element.removeClass("f-placeholder")):this.fakeEmpty()===!1&&(!this.options.paragraphy||this.$element.find(this.valid_nodes.join(",")).length>=1)?this.$element.removeClass("f-placeholder"):!this.options.paragraphy&&this.$element.find(this.valid_nodes.join(",")).length>=1?this.$element.removeClass("f-placeholder"):this.$element.addClass("f-placeholder");return!0},e.prototype.fakeEmpty=function(t){void 0===t&&(t=this.$element);var e=!0;this.options.paragraphy&&(e=1==t.find(this.options.defaultTag).length?!0:!1);var i=t.text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return""===i&&e&&1==t.find("br, li").length&&0===t.find("img, table, iframe, input, textarea, hr, li").length},e.prototype.setPlaceholderEvents=function(){this.browser.msie&&e.getIEversion()<9||(this.$element.on("focus click",t.proxy(function(t){return this.isDisabled?!1:void(""!==this.$element.text()||this.pasting||(this.$element.data("focused")||"click"!==t.type?"focus"==t.type&&this.focus(!1):this.$element.focus(),this.$element.data("focused",!0)))},this)),this.$element.on("keyup keydown input focus placeholderCheck",t.proxy(function(){return this.checkPlaceholder()},this)),this.$element.trigger("placeholderCheck"))},e.prototype.setDimensions=function(t,e,i,n){t&&(this.options.height=t),e&&(this.options.width=e),i&&(this.options.minHeight=i),n&&(this.options.maxHeight=n),"auto"!=this.options.height&&(this.$wrapper.css("height",this.options.height),this.$element.css("minHeight",this.options.height-parseInt(this.$element.css("padding-top"),10)-parseInt(this.$element.css("padding-bottom"),10))),"auto"!=this.options.minHeight&&(this.$wrapper.css("minHeight",this.options.minHeight),this.$element.css("minHeight",this.options.minHeight)),"auto"!=this.options.maxHeight&&this.$wrapper.css("maxHeight",this.options.maxHeight),"auto"!=this.options.width&&this.$box.css("width",this.options.width)},e.prototype.setDirection=function(t){t&&(this.options.direction=t),"ltr"!=this.options.direction&&"rtl"!=this.options.direction&&(this.options.direction="ltr"),"rtl"==this.options.direction?(this.$element.removeAttr("dir"),this.$box.addClass("f-rtl"),this.$element.addClass("f-rtl"),this.$editor.addClass("f-rtl"),this.$popup_editor.addClass("f-rtl"),this.$image_modal&&this.$image_modal.addClass("f-rtl")):(this.$element.attr("dir","auto"),
this.$box.removeClass("f-rtl"),this.$element.removeClass("f-rtl"),this.$editor.removeClass("f-rtl"),this.$popup_editor.removeClass("f-rtl"),this.$image_modal&&this.$image_modal.removeClass("f-rtl"))},e.prototype.setZIndex=function(t){t&&(this.options.zIndex=t),this.$editor.css("z-index",this.options.zIndex),this.$popup_editor.css("z-index",this.options.zIndex+1),this.$overlay&&this.$overlay.css("z-index",this.options.zIndex+1002),this.$image_modal&&this.$image_modal.css("z-index",this.options.zIndex+1003)},e.prototype.setTheme=function(t){t&&(this.options.theme=t),null!=this.options.theme&&(this.$editor.addClass(this.options.theme+"-theme"),this.$popup_editor.addClass(this.options.theme+"-theme"),this.$box&&this.$box.addClass(this.options.theme+"-theme"),this.$image_modal&&this.$image_modal.addClass(this.options.theme+"-theme"))},e.prototype.setSpellcheck=function(t){void 0!==t&&(this.options.spellcheck=t),this.$element.attr("spellcheck",this.options.spellcheck)},e.prototype.customizeText=function(e){if(e){var i=this.$editor.find("[title]").add(this.$popup_editor.find("[title]"));this.$image_modal&&(i=i.add(this.$image_modal.find("[title]"))),i.each(t.proxy(function(i,n){for(var r in e)t(n).attr("title").toLowerCase()==r.toLowerCase()&&t(n).attr("title",e[r])},this)),i=this.$editor.find('[data-text="true"]').add(this.$popup_editor.find('[data-text="true"]')),this.$image_modal&&(i=i.add(this.$image_modal.find('[data-text="true"]'))),i.each(t.proxy(function(i,n){for(var r in e)t(n).text().toLowerCase()==r.toLowerCase()&&t(n).text(e[r])},this))}},e.prototype.setLanguage=function(e){void 0!==e&&(this.options.language=e),t.Editable.LANGS[this.options.language]&&(this.customizeText(t.Editable.LANGS[this.options.language].translation),t.Editable.LANGS[this.options.language].direction&&t.Editable.LANGS[this.options.language].direction!=t.Editable.DEFAULTS.direction&&this.setDirection(t.Editable.LANGS[this.options.language].direction),t.Editable.LANGS[this.options.language].translation[this.options.placeholder]&&this.setPlaceholder(t.Editable.LANGS[this.options.language].translation[this.options.placeholder]))},e.prototype.setCustomText=function(t){t&&(this.options.customText=t),this.options.customText&&this.customizeText(this.options.customText)},e.prototype.execHTML=function(){this.html()},e.prototype.initHTMLArea=function(){this.$html_area=t('<textarea wrap="hard">').keydown(function(e){var i=e.keyCode||e.which;if(9==i){e.preventDefault();var n=t(this).get(0).selectionStart,r=t(this).get(0).selectionEnd;t(this).val(t(this).val().substring(0,n)+"	"+t(this).val().substring(r)),t(this).get(0).selectionStart=t(this).get(0).selectionEnd=n+1}}).focus(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this)).mouseup(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this))},e.prototype.command_dispatcher={align:function(t){var e=this.buildDropdownAlign(t),i=this.buildDropdownButton(t,e);return i},formatBlock:function(t){var e=this.buildDropdownFormatBlock(t),i=this.buildDropdownButton(t,e);return i},html:function(e){var i=this.buildDefaultButton(e);return this.options.inlineMode&&this.$box.append(t(i).clone(!0).addClass("html-switch").attr("title","Hide HTML").click(t.proxy(this.execHTML,this))),this.initHTMLArea(),i}},e.prototype.setButtons=function(t){t&&(this.options.buttons=t),this.$editor.append('<div class="bttn-wrapper" id="bttn-wrapper-'+this._id+'">'),this.$bttn_wrapper=this.$editor.find("#bttn-wrapper-"+this._id),this.mobile()&&this.$bttn_wrapper.addClass("touch");for(var i,n,r="",a=0;a<this.options.buttons.length;a++){var o=this.options.buttons[a];if("sep"!=o){var s=e.commands[o];if(void 0!==s){s.cmd=o;var l=this.command_dispatcher[s.cmd];l?r+=l.apply(this,[s]):s.seed?(i=this.buildDefaultDropdown(s),n=this.buildDropdownButton(s,i),r+=n):(n=this.buildDefaultButton(s),r+=n,this.bindRefreshListener(s))}else{if(s=this.options.customButtons[o],void 0===s){if(s=this.options.customDropdowns[o],void 0===s)continue;n=this.buildCustomDropdown(s,o),r+=n,this.bindRefreshListener(s);continue}n=this.buildCustomButton(s,o),r+=n,this.bindRefreshListener(s)}}else r+=this.options.inlineMode?'<div class="f-clear"></div><hr/>':'<span class="f-sep"></span>'}this.$bttn_wrapper.html(r),this.$bttn_wrapper.find('button[data-cmd="undo"], button[data-cmd="redo"]').prop("disabled",!0),this.bindButtonEvents()},e.prototype.bindRefreshListener=function(e){e.refresh&&this.addListener("refresh",t.proxy(function(){e.refresh.apply(this,[e.cmd])},this))},e.prototype.buildDefaultButton=function(t){var e='<button tabIndex="-1" type="button" class="fr-bttn" title="'+t.title+'" data-cmd="'+t.cmd+'">';return e+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title),e+="</button>"},e.prototype.prepareIcon=function(t,e){switch(t.type){case"font":return this.addButtonIcon({icon:t.value});case"img":return this.addButtonIcon({icon_img:t.value,title:e});case"txt":return this.addButtonIcon({icon_txt:t.value})}},e.prototype.addButtonIcon=function(t){return t.icon?'<i class="'+t.icon+'"></i>':t.icon_alt?'<i class="for-text">'+t.icon_alt+"</i>":t.icon_img?'<img src="'+t.icon_img+'" alt="'+t.title+'"/>':t.icon_txt?"<i>"+t.icon_txt+"</i>":t.title},e.prototype.buildCustomButton=function(t,e){this["call_"+e]=t.callback;var i='<button tabIndex="-1" type="button" class="fr-bttn" data-callback="call_'+e+'" data-cmd="button_name" data-name="'+e+'" title="'+t.title+'">'+this.prepareIcon(t.icon,t.title)+"</button>";return i},e.prototype.callDropdown=function(e,i){this.$bttn_wrapper.on("click touch",'[data-name="'+e+'"]',t.proxy(function(t){t.preventDefault(),t.stopPropagation(),i.apply(this)},this))},e.prototype.buildCustomDropdown=function(t,e){var i='<div class="fr-bttn fr-dropdown">';i+='<button tabIndex="-1" type="button" class="fr-trigger" title="'+t.title+'" data-name="'+e+'">'+this.prepareIcon(t.icon,t.title)+"</button>",i+='<ul class="fr-dropdown-menu">';var n=0;for(var r in t.options){this["call_"+e+n]=t.options[r];var a='<li data-callback="call_'+e+n+'" data-cmd="'+e+n+'" data-name="'+e+n+'"><a href="#">'+r+"</a></li>";i+=a,n++}return i+="</ul></div>"},e.prototype.buildDropdownButton=function(t,e,i){i=i||"";var n='<div class="fr-bttn fr-dropdown '+i+'">',r="";r+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title);var a='<button tabIndex="-1" type="button" data-name="'+t.cmd+'" class="fr-trigger" title="'+t.title+'">'+r+"</button>";return n+=a,n+=e,n+="</div>"},e.prototype.buildDropdownAlign=function(t){this.bindRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var n=t.seed[i];e+='<li data-cmd="align" data-val="'+n.cmd+'" title="'+n.title+'"><a href="#"><i class="'+n.icon+'"></i></a></li>'}return e+="</ul>"},e.prototype.buildDropdownFormatBlock=function(t){var e='<ul class="fr-dropdown-menu">';for(var i in this.options.blockTags){var n='<li data-cmd="'+t.cmd+'" data-val="'+i+'">';n+='<a href="#" data-text="true" class="format-'+i+'" title="'+this.options.blockTags[i]+'">'+this.options.blockTags[i]+"</a></li>",e+=n}return e+="</ul>"},e.prototype.buildDefaultDropdown=function(t){for(var e='<ul class="fr-dropdown-menu">',i=0;i<t.seed.length;i++){var n=t.seed[i],r='<li data-namespace="'+t.namespace+'" data-cmd="'+(n.cmd||t.cmd)+'" data-val="'+n.value+'" data-param="'+(n.param||t.param)+'">';r+='<a href="#" data-text="true" class="'+n.value+'" title="'+n.title+'">'+n.title+"</a></li>",e+=r}return e+="</ul>"},e.prototype.createEditPopupHTML=function(){var t='<div class="froala-popup froala-text-popup" style="display:none;">';return t+='<h4><span data-text="true">Edit text</span><i title="Cancel" class="fa fa-times" id="f-text-close-'+this._id+'"></i></h4></h4>',t+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu" id="f-ti-'+this._id+'">',t+='<button data-text="true" type="button" class="f-ok" id="f-edit-popup-ok-'+this._id+'">OK</button>',t+="</div>",t+="</div>"},e.prototype.buildEditPopup=function(){this.$edit_popup_wrapper=t(this.createEditPopupHTML()),this.$popup_editor.append(this.$edit_popup_wrapper),this.$edit_popup_wrapper.find("#f-ti-"+this._id).on("mouseup keydown",function(t){t.stopPropagation()}),this.addListener("hidePopups",t.proxy(function(){this.$edit_popup_wrapper.hide()},this)),this.$edit_popup_wrapper.on("click","#f-edit-popup-ok-"+this._id,t.proxy(function(){this.$element.text(this.$edit_popup_wrapper.find("#f-ti-"+this._id).val()),this.sync(),this.hide()},this)),this.$edit_popup_wrapper.on("click","i#f-text-close-"+this._id,t.proxy(function(){this.hide()},this))},e.prototype.createCORSRequest=function(t,e){var i=new XMLHttpRequest;if("withCredentials"in i){i.open(t,e,!0),this.options.withCredentials&&(i.withCredentials=!0);for(var n in this.options.headers)i.setRequestHeader(n,this.options.headers[n])}else"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):i=null;return i},e.prototype.isEnabled=function(e){return t.inArray(e,this.options.buttons)>=0},e.prototype.bindButtonEvents=function(){this.bindDropdownEvents(this.$bttn_wrapper),this.bindCommandEvents(this.$bttn_wrapper)},e.prototype.bindDropdownEvents=function(i){var n=this;i.on(this.mousedown,".fr-dropdown .fr-trigger:not([disabled])",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&n.android()||n.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),i.on(this.mouseup,".fr-dropdown .fr-trigger:not([disabled])",function(r){if(n.isDisabled)return!1;if(r.stopPropagation(),r.preventDefault(),!t(this).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;t("[data-down]").removeAttr("data-down"),n.options.inlineMode===!1&&0===t(this).parents(".froala-popup").length&&(n.hide(),n.closeImageMode(),n.imageMode=!1),t(this).toggleClass("active").trigger("blur");var a,o=t(this).attr("data-name");return e.commands[o]?a=e.commands[o].refreshOnShow:n.options.customDropdowns[o]?a=n.options.customDropdowns[o].refreshOnShow:e.image_commands[o]&&(a=e.image_commands[o].refreshOnShow),a&&a.call(n),i.find("button.fr-trigger").not(this).removeClass("active"),!1}),i.on(this.mouseup,".fr-dropdown",function(t){t.stopPropagation(),t.preventDefault()}),this.$element.on("mouseup","img, a",t.proxy(function(){return this.isDisabled?!1:void i.find(".fr-dropdown .fr-trigger").removeClass("active")},this)),i.on("click","li[data-cmd] > a",function(t){t.preventDefault()})},e.prototype.bindCommandEvents=function(e){var i=this;e.on(this.mousedown,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&i.android()||i.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),e.on(this.mouseup+" "+this.move,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",t.proxy(function(e){if(i.isDisabled)return!1;if("mouseup"===e.type&&1!==e.which)return!0;var n=e.currentTarget;if("touchmove"!=e.type){if(e.stopPropagation(),e.preventDefault(),!t(n).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;if(t("[data-down]").removeAttr("data-down"),t(n).data("dragging")||t(n).attr("disabled"))return t(n).removeData("dragging"),!1;var r=t(n).data("timeout");r&&(clearTimeout(r),t(n).removeData("timeout"));var a=t(n).attr("data-callback");if(i.options.inlineMode===!1&&0===t(n).parents(".froala-popup").length&&(i.hide(),i.closeImageMode(),i.imageMode=!1),a)t(n).parents(".fr-dropdown").find(".fr-trigger.active").removeClass("active"),i[a]();else{var o=t(n).attr("data-namespace"),s=t(n).attr("data-cmd"),l=t(n).attr("data-val"),d=t(n).attr("data-param");o?i["exec"+o](s,l,d):(i.exec(s,l,d),i.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"))}return!1}t(n).data("timeout")||t(n).data("timeout",setTimeout(function(){t(n).data("dragging",!0)},200))},this))},e.prototype.save=function(){if(!this.triggerEvent("beforeSave",[],!1))return!1;if(this.options.saveURL){var e={};for(var i in this.options.saveParams){var n=this.options.saveParams[i];e[i]="function"==typeof n?n.call(this):n}var r={};r[this.options.saveParam]=this.getHTML(),t.ajax({type:this.options.saveRequestType,url:this.options.saveURL,data:t.extend(r,e),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){this.triggerEvent("afterSave",[t])},this)).fail(t.proxy(function(){this.triggerEvent("saveError",["Save request failed on the server."])},this))}else this.triggerEvent("saveError",["Missing save URL."])},e.prototype.isURL=function(t){if(!/^(https?:|ftps?:|)\/\//.test(t))return!1;t=String(t).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");var e=/\(?(?:(https?:|ftps?:|)\/\/)?(?:((?:[^\W\s]|\.|-|[:]{1})+)@{1})?((?:www.)?(?:[^\W\s]|\.|-)+[\.][^\W\s]{2,4}|(?:www.)?(?:[^\W\s]|\.|-)|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d*))?([\/]?[^\s\?]*[\/]{1})*(?:\/?([^\s\n\?\[\]\{\}\#]*(?:(?=\.)){1}|[^\s\n\?\[\]\{\}\.\#]*)?([\.]{1}[^\s\?\#]*)?)?(?:\?{1}([^\s\n\#\[\]]*))?([\#][^\s\n]*)?\)?/gi;return e.test(t)},e.prototype.sanitizeURL=function(t){if(/^(https?:|ftps?:|)\/\//.test(t)){if(!this.isURL(t))return""}else t=encodeURIComponent(t).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/g,"mailto:").replace(/tel%3A/g,"tel:").replace(/data%3Aimage/g,"data:image").replace(/webkit-fake-url%3A/g,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@");return t},e.prototype.parents=function(t,e){return t.get(0)!=this.$element.get(0)?t.parentsUntil(this.$element,e):[]},e.prototype.option=function(e,i){if(void 0===e)return this.options;if(e instanceof Object)this.options=t.extend({},this.options,e),this.initOptions(),this.setCustomText(),this.setLanguage(),this.setAllowScript(),this.setAllowStyle();else{if(void 0===i)return this.options[e];switch(this.options[e]=i,e){case"direction":this.setDirection();break;case"height":case"width":case"minHeight":case"maxHeight":this.setDimensions();break;case"spellcheck":this.setSpellcheck();break;case"placeholder":this.setPlaceholder();break;case"customText":this.setCustomText();break;case"language":this.setLanguage();break;case"textNearImage":this.setTextNearImage();break;case"zIndex":this.setZIndex();break;case"theme":this.setTheme();break;case"allowScript":this.setAllowScript();break;case"allowStyle":this.setAllowStyle()}}};var i=t.fn.editable;t.fn.editable=function(i){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);if("string"==typeof i){var a=[];return this.each(function(){var e=t(this),r=e.data("fa.editable");if(!r[i])return t.error("Method "+i+" does not exist in Froala Editor.");var o=r[i].apply(r,n.slice(1));void 0===o?a.push(this):0===a.length&&a.push(o)}),1==a.length?a[0]:a}return"object"!=typeof i&&i?void 0:this.each(function(){var n=this,r=t(n),a=r.data("fa.editable");a||r.data("fa.editable",a=new e(n,i))})},t.fn.editable.Constructor=e,t.Editable=e,t.fn.editable.noConflict=function(){return t.fn.editable=i,this}}(window.jQuery),function(t){t.Editable.prototype.initUndoRedo=function(){this.undoStack=[],this.undoIndex=0,this.saveUndoStep(),this.disableBrowserUndo()},t.Editable.prototype.undo=function(){if(this.no_verify=!0,this.undoIndex>1){clearTimeout(this.typingTimer),this.triggerEvent("beforeUndo",[],!1);var t=this.undoStack[--this.undoIndex-1];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterUndo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.redo=function(){if(this.no_verify=!0,this.undoIndex<this.undoStack.length){clearTimeout(this.typingTimer),this.triggerEvent("beforeRedo",[],!1);var t=this.undoStack[this.undoIndex++];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterRedo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.saveUndoStep=function(){if(!this.undoStack)return!1;for(;this.undoStack.length>this.undoIndex;)this.undoStack.pop();var t=this.getSnapshot();this.undoStack[this.undoIndex-1]&&this.identicSnapshots(this.undoStack[this.undoIndex-1],t)||(this.undoStack.push(t),this.undoIndex++),this.refreshUndo(),this.refreshRedo()},t.Editable.prototype.refreshUndo=function(){if(this.isEnabled("undo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="undo"]').removeAttr("disabled"),(0===this.undoStack.length||this.undoIndex<=1||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="undo"]').attr("disabled",!0)}},t.Editable.prototype.refreshRedo=function(){if(this.isEnabled("redo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="redo"]').removeAttr("disabled"),(this.undoIndex==this.undoStack.length||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="redo"]').prop("disabled",!0)}},t.Editable.prototype.getNodeIndex=function(t){for(var e=t.parentNode.childNodes,i=0,n=null,r=0;r<e.length;r++){if(n){var a=3===e[r].nodeType&&""===e[r].textContent,o=3===n.nodeType&&3===e[r].nodeType;a||o||i++}if(e[r]==t)return i;n=e[r]}},t.Editable.prototype.getNodeLocation=function(t){var e=[];if(!t.parentNode)return[];for(;t!=this.$element.get(0);)e.push(this.getNodeIndex(t)),t=t.parentNode;return e.reverse()},t.Editable.prototype.getNodeByLocation=function(t){for(var e=this.$element.get(0),i=0;i<t.length;i++)e=e.childNodes[t[i]];return e},t.Editable.prototype.getRealNodeOffset=function(t,e){for(;t&&3===t.nodeType;){var i=t.previousSibling;i&&3==i.nodeType&&(e+=i.textContent.length),t=i}return e},t.Editable.prototype.getRangeSnapshot=function(t){return{scLoc:this.getNodeLocation(t.startContainer),scOffset:this.getRealNodeOffset(t.startContainer,t.startOffset),ecLoc:this.getNodeLocation(t.endContainer),ecOffset:this.getRealNodeOffset(t.endContainer,t.endOffset)}},t.Editable.prototype.getSnapshot=function(){var t={};if(t.html=this.$element.html(),t.ranges=[],this.selectionInEditor()&&this.$element.is(":focus"))for(var e=this.getRanges(),i=0;i<e.length;i++)t.ranges.push(this.getRangeSnapshot(e[i]));return t},t.Editable.prototype.identicSnapshots=function(t,e){return t.html!=e.html?!1:JSON.stringify(t.ranges)!=JSON.stringify(e.ranges)?!1:!0},t.Editable.prototype.restoreRangeSnapshot=function(t,e){try{var i=this.getNodeByLocation(t.scLoc),n=t.scOffset,r=this.getNodeByLocation(t.ecLoc),a=t.ecOffset,o=this.document.createRange();o.setStart(i,n),o.setEnd(r,a),e.addRange(o)}catch(s){}},t.Editable.prototype.restoreSnapshot=function(e){this.$element.html()!=e.html&&this.$element.html(e.html);var i=this.getSelection();this.clearSelection(),this.$element.focus();for(var n=0;n<e.ranges.length;n++)this.restoreRangeSnapshot(e.ranges[n],i);setTimeout(t.proxy(function(){this.$element.find(".f-img-wrap img").click()},this),0)}}(jQuery),function(t){t.Editable.prototype.refreshButtons=function(e){return this.initialized&&(this.selectionInEditor()&&!this.isHTML||this.browser.msie&&t.Editable.getIEversion()<9||e)?(this.$editor.find("button[data-cmd]").removeClass("active"),this.refreshDisabledState(),void this.raiseEvent("refresh")):!1},t.Editable.prototype.refreshDisabledState=function(){if(this.isHTML)return!1;if(this.$editor){for(var e=0;e<this.options.buttons.length;e++){var i=this.options.buttons[e];if(void 0!==t.Editable.commands[i]){var n=!1;t.isFunction(t.Editable.commands[i].disabled)?n=t.Editable.commands[i].disabled.apply(this):void 0!==t.Editable.commands[i].disabled&&(n=!0),n?(this.$editor.find('button[data-cmd="'+i+'"]').prop("disabled",!0),this.$editor.find('button[data-name="'+i+'"]').prop("disabled",!0)):(this.$editor.find('button[data-cmd="'+i+'"]').removeAttr("disabled"),this.$editor.find('button[data-name="'+i+'"]').removeAttr("disabled"))}}this.refreshUndo(),this.refreshRedo()}},t.Editable.prototype.refreshFormatBlocks=function(){var t=this.getSelectionElements()[0],e=t.tagName.toLowerCase();this.options.paragraphy&&e===this.options.defaultTag.toLowerCase()&&(e="n"),this.$editor.find('.fr-bttn > button[data-name="formatBlock"] + ul li').removeClass("active"),this.$bttn_wrapper.find('.fr-bttn > button[data-name="formatBlock"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshDefault=function(t){try{this.document.queryCommandState(t)===!0&&this.$editor.find('[data-cmd="'+t+'"]').addClass("active")}catch(e){}},t.Editable.prototype.refreshAlign=function(){var e=t(this.getSelectionElements()[0]);this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var i,n=e.css("text-align");["left","right","justify","center"].indexOf(n)<0&&(n="left"),"left"==n?i="justifyLeft":"right"==n?i="justifyRight":"justify"==n?i="justifyFull":"center"==n&&(i="justifyCenter"),this.$editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+n),this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+i+'"]').addClass("active")},t.Editable.prototype.refreshHTML=function(){this.isActive("html")?this.$editor.find('[data-cmd="html"]').addClass("active"):this.$editor.find('[data-cmd="html"]').removeClass("active")}}(jQuery),function(t){t.Editable.commands={bold:{title:"Bold",icon:"fa fa-bold",shortcut:"(Ctrl + B)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},italic:{title:"Italic",icon:"fa fa-italic",shortcut:"(Ctrl + I)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},underline:{cmd:"underline",title:"Underline",icon:"fa fa-underline",shortcut:"(Ctrl + U)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},strikeThrough:{title:"Strikethrough",icon:"fa fa-strikethrough",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},subscript:{title:"Subscript",icon:"fa fa-subscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},superscript:{title:"Superscript",icon:"fa fa-superscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},formatBlock:{title:"Format Block",icon:"fa fa-paragraph",refreshOnShow:t.Editable.prototype.refreshFormatBlocks,callback:function(t,e){this.formatBlock(e)},undo:!0},align:{title:"Alignment",icon:"fa fa-align-left",refresh:t.Editable.prototype.refreshAlign,refreshOnShow:t.Editable.prototype.refreshAlign,seed:[{cmd:"justifyLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"justifyCenter",title:"Align Center",icon:"fa fa-align-center"},{cmd:"justifyRight",title:"Align Right",icon:"fa fa-align-right"},{cmd:"justifyFull",title:"Justify",icon:"fa fa-align-justify"}],callback:function(t,e){this.align(e)},undo:!0},outdent:{title:"Indent Less",icon:"fa fa-dedent",activeless:!0,shortcut:"(Ctrl + <)",callback:function(){this.outdent(!0)},undo:!0},indent:{title:"Indent More",icon:"fa fa-indent",activeless:!0,shortcut:"(Ctrl + >)",callback:function(){this.indent()},undo:!0},selectAll:{title:"Select All",icon:"fa fa-file-text",shortcut:"(Ctrl + A)",callback:function(t,e){this.$element.focus(),this.execDefault(t,e)},undo:!1},createLink:{title:"Insert Link",icon:"fa fa-link",shortcut:"(Ctrl + K)",callback:function(){this.insertLink()},undo:!1},insertImage:{title:"Insert Image",icon:"fa fa-picture-o",activeless:!0,shortcut:"(Ctrl + P)",callback:function(){this.insertImage()},undo:!1},undo:{title:"Undo",icon:"fa fa-undo",activeless:!0,shortcut:"(Ctrl+Z)",refresh:t.Editable.prototype.refreshUndo,callback:function(){this.undo()},undo:!1},redo:{title:"Redo",icon:"fa fa-repeat",activeless:!0,shortcut:"(Shift+Ctrl+Z)",refresh:t.Editable.prototype.refreshRedo,callback:function(){this.redo()},undo:!1},html:{title:"Show HTML",icon:"fa fa-code",refresh:t.Editable.prototype.refreshHTML,callback:function(){this.html()},undo:!1},save:{title:"Save",icon:"fa fa-floppy-o",callback:function(){this.save()},undo:!1},insertHorizontalRule:{title:"Insert Horizontal Line",icon:"fa fa-minus",callback:function(t){this.insertHR(t)},undo:!0},removeFormat:{title:"Clear formatting",icon:"fa fa-eraser",activeless:!0,callback:function(){this.removeFormat()},undo:!0}},t.Editable.prototype.exec=function(e,i,n){return!this.selectionInEditor()&&t.Editable.commands[e].undo&&this.focus(),this.selectionInEditor()&&""===this.text()&&t.Editable.commands[e].callbackWithoutSelection?(t.Editable.commands[e].callbackWithoutSelection.apply(this,[e,i,n]),!1):void(t.Editable.commands[e].callback?t.Editable.commands[e].callback.apply(this,[e,i,n]):this.execDefault(e,i))},t.Editable.prototype.html=function(){var t;this.isHTML?(this.isHTML=!1,t=this.$html_area.val(),this.$box.removeClass("f-html"),this.$element.attr("contenteditable",!0),this.setHTML(t,!1),this.$editor.find('.fr-bttn:not([data-cmd="html"]), .fr-trigger').removeAttr("disabled"),this.$editor.find('.fr-bttn[data-cmd="html"]').removeClass("active"),this.$element.blur(),this.focus(),this.refreshButtons(),this.triggerEvent("htmlHide",[t],!0,!1)):(this.$box.removeClass("f-placeholder"),this.clearSelection(),this.cleanify(!1,!0,!1),t=this.cleanTags(this.getHTML(!1,!1)),this.$html_area.val(t).trigger("resize"),this.$html_area.css("height",this.$element.height()-1),this.$element.html("").append(this.$html_area).removeAttr("contenteditable"),this.$box.addClass("f-html"),this.$editor.find('button.fr-bttn:not([data-cmd="html"]), button.fr-trigger').attr("disabled",!0),this.$editor.find('.fr-bttn[data-cmd="html"]').addClass("active"),this.isHTML=!0,this.hide(),this.imageMode=!1,this.$element.blur(),this.$element.removeAttr("contenteditable"),this.triggerEvent("htmlShow",[t],!0,!1))},t.Editable.prototype.insertHR=function(e){this.$element.find("hr").addClass("fr-tag"),this.$element.hasClass("f-placeholder")?t(this.$element.find("> "+this.valid_nodes.join(", >"))[0]).before("<hr/>"):this.document.execCommand(e),this.hide();var i=this.$element.find("hr:not(.fr-tag)").next(this.valid_nodes.join(","));i.length>0?t(i[0]).prepend(this.markers_html):this.$element.find("hr:not(.fr-tag)").after(this.options.paragraphy?"<p>"+this.markers_html+"<br/></p>":this.markers_html),this.restoreSelectionByMarkers(),this.triggerEvent(e,[],!0,!1)},t.Editable.prototype.formatBlock=function(e){if(this.disabledList.indexOf("formatBlock")>=0)return!1;if(this.browser.msie&&t.Editable.getIEversion()<9)return"n"==e&&(e=this.options.defaultTag),this.document.execCommand("formatBlock",!1,"<"+e+">"),this.triggerEvent("formatBlock"),!1;if(this.$element.hasClass("f-placeholder")){if(this.options.paragraphy||"n"!=e){"n"==e&&(e=this.options.defaultTag);var i=t("<"+e+"><br/></"+e+">");this.$element.html(i),this.setSelection(i.get(0),0),this.$element.removeClass("f-placeholder")}}else{this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var n=this.getSelectionElements();n[0]==this.$element.get(0)&&(n=this.$element.find("> "+this.valid_nodes.join(", >"))),this.saveSelectionByMarkers();for(var r,a=function(e){if("PRE"==e.get(0).tagName)for(;e.find("br + br").length>0;){var i=t(e.find("br + br")[0]);i.prev().remove(),i.replaceWith("\n\n")}},o=0;o<n.length;o++){var s=t(n[o]);if(!this.fakeEmpty(s)){if(a(s),!this.options.paragraphy&&this.emptyElement(s.get(0))&&s.append("<br/>"),"n"==e)if(this.options.paragraphy){var l="<"+this.options.defaultTag+this.attrs(s.get(0))+">"+s.html()+"</"+this.options.defaultTag+">";r=t(l)}else r=s.html()+"<br/>";else r=t("<"+e+this.attrs(s.get(0))+">").html(s.html());s.get(0)!=this.$element.get(0)?s.replaceWith(r):s.html(r)}}this.unwrapText(),this.$element.find("pre + pre").each(function(){t(this).prepend(t(this).prev().html()+"<br/><br/>"),t(this).prev().remove()});var d=this;this.$element.find(this.valid_nodes.join(",")).each(function(){"PRE"!=this.tagName&&t(this).replaceWith("<"+this.tagName+d.attrs(this)+">"+t(this).html().replace(/\n\n/gi,"</"+this.tagName+"><"+this.tagName+">")+"</"+this.tagName+">")}),this.$element.find(this.valid_nodes.join(":empty ,")+":empty").append("<br/>"),this.cleanupLists(),this.restoreSelectionByMarkers()}this.triggerEvent("formatBlock"),this.repositionEditor()},t.Editable.prototype.align=function(e){if(this.browser.msie&&t.Editable.getIEversion()<9)return this.document.execCommand(e,!1,!1),this.triggerEvent("align",[e]),!1;this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers(),this.saveSelectionByMarkers();var i=this.getSelectionElements();"justifyLeft"==e?e="left":"justifyRight"==e?e="right":"justifyCenter"==e?e="center":"justifyFull"==e&&(e="justify");for(var n=0;n<i.length;n++)this.parents(t(i[n]),"LI").length>0&&(i[n]=t(i[n]).parents("LI").get(0)),t(i[n]).css("text-align",e);this.cleanupLists(),this.unwrapText(),this.restoreSelectionByMarkers(),this.repositionEditor(),this.triggerEvent("align",[e])},t.Editable.prototype.indent=function(e,i){if(void 0===i&&(i=!0),this.browser.msie&&t.Editable.getIEversion()<9)return e?this.document.execCommand("outdent",!1,!1):this.document.execCommand("indent",!1,!1),!1;var n=20;e&&(n=-20),this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var r=this.getSelectionElements();this.saveSelectionByMarkers();for(var a=0;a<r.length;a++)t(r[a]).parentsUntil(this.$element,"li").length>0&&(r[a]=t(r[a]).closest("li").get(0));for(var o=0;o<r.length;o++){var s=t(r[o]);if(this.raiseEvent("indent",[s,e]))if(s.get(0)!=this.$element.get(0)){var l=parseInt(s.css("margin-left"),10),d=Math.max(0,l+n);s.css("marginLeft",d),0===d&&(s.css("marginLeft",""),void 0===s.css("style")&&s.removeAttr("style"))}else{var h=t("<div>").html(s.html());s.html(h),h.css("marginLeft",Math.max(0,n)),0===Math.max(0,n)&&(h.css("marginLeft",""),void 0===h.css("style")&&h.removeAttr("style"))}}this.unwrapText(),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),e||this.triggerEvent("indent")},t.Editable.prototype.outdent=function(t){this.indent(!0,t),this.triggerEvent("outdent")},t.Editable.prototype.execDefault=function(t,e){this.saveUndoStep(),this.document.execCommand(t,!1,e),this.triggerEvent(t,[],!0,!0)},t.Editable.prototype._startInDefault=function(t){this.focus(),this.document.execCommand(t,!1,!1),this.refreshButtons()},t.Editable.prototype._startInFontExec=function(e,i,n){this.focus();try{var r=this.getRange(),a=r.cloneRange();a.collapse(!1);var o=t('<span data-inserted="true" data-fr-verified="true" style="'+e+": "+n+';">'+t.Editable.INVISIBLE_SPACE+"</span>",this.document);a.insertNode(o[0]),o=this.$element.find("[data-inserted]"),o.removeAttr("data-inserted"),this.setSelection(o.get(0),1),null!=i&&this.triggerEvent(i,[n],!0,!0)}catch(s){}},t.Editable.prototype.removeFormat=function(){this.document.execCommand("removeFormat",!1,!1),this.document.execCommand("unlink",!1,!1),this.refreshButtons()},t.Editable.prototype.inlineStyle=function(e,i,n){if(this.browser.webkit){var r=function(t){return t.attr("style").indexOf("font-size")>=0};this.$element.find("[style]").each(function(e,i){var n=t(i);r(n)&&(n.attr("data-font-size",n.css("font-size")),n.css("font-size",""))})}this.document.execCommand("fontSize",!1,4),this.saveSelectionByMarkers(),this.browser.webkit&&this.$element.find("[data-font-size]").each(function(e,i){var n=t(i);n.css("font-size",n.attr("data-font-size")),n.removeAttr("data-font-size")});var a=function(i){var r=t(i);r.css(e)!=n&&r.css(e,""),""===r.attr("style")&&r.replaceWith(r.html())};this.$element.find("font").each(function(i,r){
var o=t('<span data-fr-verified="true" style="'+e+": "+n+';">'+t(r).html()+"</span>");t(r).replaceWith(o);for(var s=o.find("span"),l=s.length-1;l>=0;l--)a(s[l])}),this.removeBlankSpans(),this.restoreSelectionByMarkers(),this.repositionEditor(),null!=i&&this.triggerEvent(i,[n],!0,!0)}}(jQuery),function(t){t.Editable.prototype.addListener=function(t,e){var i=this._events,n=i[t]=i[t]||[];n.push(e)},t.Editable.prototype.raiseEvent=function(t,e){void 0===e&&(e=[]);var i=!0,n=this._events[t];if(n)for(var r=0,a=n.length;a>r;r++){var o=n[r].apply(this,e);void 0!==o&&i!==!1&&(i=o)}return void 0===i&&(i=!0),i}}(jQuery),function(t){t.Editable.prototype.start_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.end_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span>',t.Editable.prototype.markers_html='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span><span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.text=function(){var t="";return this.window.getSelection?t=this.window.getSelection():this.document.getSelection?t=this.document.getSelection():this.document.selection&&(t=this.document.selection.createRange().text),t.toString()},t.Editable.prototype.selectionInEditor=function(){var e=this.getSelectionParent(),i=!1;return e==this.$element.get(0)&&(i=!0),i===!1&&t(e).parents().each(t.proxy(function(t,e){e==this.$element.get(0)&&(i=!0)},this)),i},t.Editable.prototype.getSelection=function(){var t="";return t=this.window.getSelection?this.window.getSelection():this.document.getSelection?this.document.getSelection():this.document.selection.createRange()},t.Editable.prototype.getRange=function(){var t=this.getRanges();return t.length>0?t[0]:null},t.Editable.prototype.getRanges=function(){var t=this.getSelection();if(t.getRangeAt&&t.rangeCount){for(var e=[],i=0;i<t.rangeCount;i++)e.push(t.getRangeAt(i));return e}return this.document.createRange?[this.document.createRange()]:[]},t.Editable.prototype.clearSelection=function(){var t=this.getSelection();try{t.removeAllRanges?t.removeAllRanges():t.empty?t.empty():t.clear&&t.clear()}catch(e){}},t.Editable.prototype.getSelectionElement=function(){var e=this.getSelection();if(e&&e.rangeCount){var i=this.getRange(),n=i.startContainer;if(1==n.nodeType){var r=!1;n.childNodes.length>0&&n.childNodes[i.startOffset]&&t(n.childNodes[i.startOffset]).text()===this.text()&&(n=n.childNodes[i.startOffset],r=!0),!r&&n.childNodes.length>0&&t(n.childNodes[0]).text()===this.text()&&["BR","IMG","HR"].indexOf(n.childNodes[0].tagName)<0&&(n=n.childNodes[0])}for(;1!=n.nodeType&&n.parentNode;)n=n.parentNode;for(var a=n;a&&"BODY"!=a.tagName;){if(a==this.$element.get(0))return n;a=t(a).parent()[0]}}return this.$element.get(0)},t.Editable.prototype.getSelectionParent=function(){var e,i=null;return this.window.getSelection?(e=this.window.getSelection(),e&&e.rangeCount&&(i=e.getRangeAt(0).commonAncestorContainer,1!=i.nodeType&&(i=i.parentNode))):(e=this.document.selection)&&"Control"!=e.type&&(i=e.createRange().parentElement()),null!=i&&(t.inArray(this.$element.get(0),t(i).parents())>=0||i==this.$element.get(0))?i:null},t.Editable.prototype.nodeInRange=function(t,e){var i;if(t.intersectsNode)return t.intersectsNode(e);i=e.ownerthis.document.createRange();try{i.selectNode(e)}catch(n){i.selectNodeContents(e)}return-1==t.compareBoundaryPoints(Range.END_TO_START,i)&&1==t.compareBoundaryPoints(Range.START_TO_END,i)},t.Editable.prototype.getElementFromNode=function(e){for(1!=e.nodeType&&(e=e.parentNode);null!==e&&this.valid_nodes.indexOf(e.tagName)<0;)e=e.parentNode;return null!=e&&"LI"==e.tagName&&t(e).find(this.valid_nodes.join(",")).not("li").length>0?null:t.makeArray(t(e).parents()).indexOf(this.$element.get(0))>=0?e:null},t.Editable.prototype.nextNode=function(t,e){if(t.hasChildNodes())return t.firstChild;for(;t&&!t.nextSibling&&t!=e;)t=t.parentNode;return t&&t!=e?t.nextSibling:null},t.Editable.prototype.getRangeSelectedNodes=function(t){var e=[],i=t.startContainer,n=t.endContainer;if(i==n&&"TR"!=i.tagName){if(i.hasChildNodes()&&0!==i.childNodes.length){for(var r=i.childNodes,a=t.startOffset;a<t.endOffset;a++)r[a]&&e.push(r[a]);return 0===e.length&&e.push(i),e}return[i]}if(i==n&&"TR"==i.tagName){var o=i.childNodes,s=t.startOffset;if(o.length>s&&s>=0){var l=o[s];if("TD"==l.tagName||"TH"==l.tagName)return[l]}}for(;i&&i!=n;)i=this.nextNode(i,n),(i!=n||t.endOffset>0)&&e.push(i);for(i=t.startContainer;i&&i!=t.commonAncestorContainer;)e.unshift(i),i=i.parentNode;return e},t.Editable.prototype.getSelectedNodes=function(){if(this.window.getSelection){var e=this.window.getSelection();if(!e.isCollapsed){for(var i=this.getRanges(),n=[],r=0;r<i.length;r++)n=t.merge(n,this.getRangeSelectedNodes(i[r]));return n}if(this.selectionInEditor()){var a=e.getRangeAt(0).startContainer;return 3==a.nodeType?[a.parentNode]:[a]}}return[]},t.Editable.prototype.getSelectionElements=function(){var e=this.getSelectedNodes(),i=[];return t.each(e,t.proxy(function(t,e){if(null!==e){var n=this.getElementFromNode(e);i.indexOf(n)<0&&n!=this.$element.get(0)&&null!==n&&i.push(n)}},this)),0===i.length&&i.push(this.$element.get(0)),i},t.Editable.prototype.getSelectionLink=function(){var e=this.getSelectionLinks();return e.length>0?t(e[0]).attr("href"):null},t.Editable.prototype.saveSelection=function(){if(!this.selectionDisabled){this.savedRanges=[];for(var t=this.getRanges(),e=0;e<t.length;e++)this.savedRanges.push(t[e].cloneRange())}},t.Editable.prototype.restoreSelection=function(){if(!this.selectionDisabled){var t,e,i=this.getSelection();if(this.savedRanges&&this.savedRanges.length)for(i.removeAllRanges(),t=0,e=this.savedRanges.length;e>t;t+=1)i.addRange(this.savedRanges[t]);this.savedRanges=null}},t.Editable.prototype.insertMarkersAtPoint=function(t){var e=t.clientX,i=t.clientY;this.removeMarkers();var n,r=null;if("undefined"!=typeof this.document.caretPositionFromPoint?(n=this.document.caretPositionFromPoint(e,i),r=this.document.createRange(),r.setStart(n.offsetNode,n.offset),r.setEnd(n.offsetNode,n.offset)):"undefined"!=typeof this.document.caretRangeFromPoint&&(n=this.document.caretRangeFromPoint(e,i),r=this.document.createRange(),r.setStart(n.startContainer,n.startOffset),r.setEnd(n.startContainer,n.startOffset)),null!==r&&"undefined"!=typeof this.window.getSelection){var a=this.window.getSelection();a.removeAllRanges(),a.addRange(r)}else if("undefined"!=typeof this.document.body.createTextRange)try{r=this.document.body.createTextRange(),r.moveToPoint(e,i);var o=r.duplicate();o.moveToPoint(e,i),r.setEndPoint("EndToEnd",o),r.select()}catch(s){}this.placeMarker(r,!0,0),this.placeMarker(r,!1,0)},t.Editable.prototype.saveSelectionByMarkers=function(){if(!this.selectionDisabled){this.selectionInEditor()||this.focus(),this.removeMarkers();for(var t=this.getRanges(),e=0;e<t.length;e++)if(t[e].startContainer!==this.document){var i=t[e];this.placeMarker(i,!0,e),this.placeMarker(i,!1,e)}}},t.Editable.prototype.hasSelectionByMarkers=function(){var t=this.$element.find('.f-marker[data-type="true"]');return t.length>0?!0:!1},t.Editable.prototype.restoreSelectionByMarkers=function(e){if(void 0===e&&(e=!0),!this.selectionDisabled){var i=this.$element.find('.f-marker[data-type="true"]');if(0===i.length)return!1;this.$element.is(":focus")||this.browser.msie||this.$element.focus();var n=this.getSelection();(e||this.getRange()&&!this.getRange().collapsed||!t(i[0]).attr("data-collapsed"))&&(this.browser.msie&&t.Editable.getIEversion()<9||(this.clearSelection(),e=!0));for(var r=0;r<i.length;r++){var a=t(i[r]).data("id"),o=i[r],s=this.$element.find('.f-marker[data-type="false"][data-id="'+a+'"]');if(this.browser.msie&&t.Editable.getIEversion()<9)return this.setSelection(o,0,s,0),this.removeMarkers(),!1;var l;if(l=e?this.document.createRange():this.getRange(),s.length>0){s=s[0];try{l.setStartAfter(o),l.setEndBefore(s)}catch(d){}}e&&n.addRange(l)}this.removeMarkers()}},t.Editable.prototype.setSelection=function(t,e,i,n){var r=this.getSelection();if(r){this.clearSelection();try{i||(i=t),void 0===e&&(e=0),void 0===n&&(n=e);var a=this.getRange();a.setStart(t,e),a.setEnd(i,n),r.addRange(a)}catch(o){}}},t.Editable.prototype.buildMarker=function(e,i,n){return void 0===n&&(n=""),t('<span class="f-marker"'+n+' style="display:none; line-height: 0;" data-fr-verified="true" data-id="'+i+'" data-type="'+e+'">',this.document)[0]},t.Editable.prototype.placeMarker=function(e,i,n){var r="";e.collapsed&&(r=' data-collapsed="true"');try{var a=e.cloneRange();a.collapse(i);var o,s,l;if(a.insertNode(this.buildMarker(i,n,r)),i===!0&&r)for(o=this.$element.find('span.f-marker[data-type="true"][data-id="'+n+'"]').get(0).nextSibling;3===o.nodeType&&0===o.data.length;)t(o).remove(),o=this.$element.find('span.f-marker[data-type="true"][data-id="'+n+'"]').get(0).nextSibling;if(i===!0&&""===r&&(l=this.$element.find('span.f-marker[data-type="true"][data-id="'+n+'"]').get(0),o=l.nextSibling,o&&o.nodeType===Node.ELEMENT_NODE&&this.valid_nodes.indexOf(o.tagName)>=0)){s=[o];do o=s[0],s=t(o).contents();while(s[0]&&this.valid_nodes.indexOf(s[0].tagName)>=0);t(o).prepend(t(l))}if(i===!1&&""===r&&(l=this.$element.find('span.f-marker[data-type="false"][data-id="'+n+'"]').get(0),o=l.previousSibling,o&&o.nodeType===Node.ELEMENT_NODE&&this.valid_nodes.indexOf(o.tagName)>=0)){s=[o];do o=s[s.length-1],s=t(o).contents();while(s[s.length-1]&&this.valid_nodes.indexOf(s[s.length-1].tagName)>=0);t(o).append(t(l))}}catch(d){}},t.Editable.prototype.removeMarkers=function(){this.$element.find(".f-marker").remove()},t.Editable.prototype.getSelectionTextInfo=function(t){var e,i,n=!1,r=!1;if(this.window.getSelection){var a=this.window.getSelection();a&&a.rangeCount&&(e=a.getRangeAt(0),i=e.cloneRange(),i.selectNodeContents(t),i.setEnd(e.startContainer,e.startOffset),n=""===i.toString(),i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),r=""===i.toString())}else this.document.selection&&"Control"!=this.document.selection.type&&(e=this.document.selection.createRange(),i=e.duplicate(),i.moveToElementText(t),i.setEndPoint("EndToStart",e),n=""===i.text,i.moveToElementText(t),i.setEndPoint("StartToEnd",e),r=""===i.text);return{atStart:n,atEnd:r}},t.Editable.prototype.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)}}(jQuery),function(t){t.Editable.hexToRGB=function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,n){return e+e+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},t.Editable.hexToRGBString=function(t){var e=this.hexToRGB(t);return e?"rgb("+e.r+", "+e.g+", "+e.b+")":""},t.Editable.RGBToHex=function(t){function e(t){return("0"+parseInt(t,10).toString(16)).slice(-2)}try{return t&&"transparent"!==t?/^#[0-9A-F]{6}$/i.test(t)?t:(t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+e(t[1])+e(t[2])+e(t[3])).toUpperCase()):""}catch(i){return null}},t.Editable.getIEversion=function(){var t,e,i=-1;return"Microsoft Internet Explorer"==navigator.appName?(t=navigator.userAgent,e=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(t=navigator.userAgent,e=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))),i},t.Editable.browser=function(){var t={};if(this.getIEversion()>0)t.msie=!0;else{var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n={browser:i[1]||"",version:i[2]||"0"};i[1]&&(t[n.browser]=!0),parseInt(n.version,10)<9&&t.msie&&(t.oldMsie=!0),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0)}return t},t.Editable.isArray=function(t){return t&&!t.propertyIsEnumerable("length")&&"object"==typeof t&&"number"==typeof t.length},t.Editable.uniq=function(e){return t.grep(e,function(i,n){return n==t.inArray(i,e)})},t.Editable.cleanWhitespace=function(e){e.contents().filter(function(){return 1==this.nodeType&&t.Editable.cleanWhitespace(t(this)),3==this.nodeType&&!/\S/.test(this.nodeValue)}).remove()}}(jQuery),function(t){t.Editable.prototype.show=function(e){if(this.hideDropdowns(),void 0!==e){if(this.options.inlineMode||this.options.editInPopup)if(null!==e&&"touchend"!==e.type){if(this.options.showNextToCursor){var i=e.pageX,n=e.pageY;i<this.$element.offset().left&&(i=this.$element.offset().left),i>this.$element.offset().left+this.$element.width()&&(i=this.$element.offset().left+this.$element.width()),n<this.$element.offset.top&&(n=this.$element.offset().top),n>this.$element.offset().top+this.$element.height()&&(n=this.$element.offset().top+this.$element.height()),20>i&&(i=20),0>n&&(n=0),this.showByCoordinates(i,n)}else this.repositionEditor();t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),0!==this.options.buttons.length||this.options.editInPopup||this.$editor.hide()}else t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),this.repositionEditor();this.hidePopups(),this.options.editInPopup||this.showEditPopupWrapper(),this.$bttn_wrapper.show(),this.refreshButtons(),this.imageMode=!1}},t.Editable.prototype.hideDropdowns=function(){this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"),this.$bttn_wrapper.find(".fr-dropdown .fr-trigger")},t.Editable.prototype.hide=function(t){return this.initialized?(void 0===t&&(t=!0),t?this.hideOtherEditors():(this.closeImageMode(),this.imageMode=!1),this.$popup_editor.hide(),this.hidePopups(!1),void(this.link=!1)):!1},t.Editable.prototype.hideOtherEditors=function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&this.$window.trigger("hide."+e)},t.Editable.prototype.hideBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.hide()},t.Editable.prototype.showBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.show()},t.Editable.prototype.showEditPopupWrapper=function(){this.$edit_popup_wrapper&&(this.$edit_popup_wrapper.show(),setTimeout(t.proxy(function(){this.$edit_popup_wrapper.find("input").val(this.$element.text()).focus().select()},this),1))},t.Editable.prototype.hidePopups=function(t){void 0===t&&(t=!0),t&&this.hideBttnWrapper(),this.raiseEvent("hidePopups")},t.Editable.prototype.showEditPopup=function(){this.showEditPopupWrapper()}}(jQuery),function(t){t.Editable.prototype.getBoundingRect=function(){var e;if(this.isLink){e={};var i=this.$element;e.left=i.offset().left-this.$window.scrollLeft(),e.top=i.offset().top-this.$window.scrollTop(),e.width=i.outerWidth(),e.height=parseInt(i.css("padding-top").replace("px",""),10)+i.height(),e.right=1,e.bottom=1,e.ok=!0}else if(this.getRange()&&this.getRange().collapsed){var n=t(this.getSelectionElement());this.saveSelectionByMarkers();var r=this.$element.find(".f-marker:first");r.css("display","inline");var a=r.offset();r.css("display","none"),e={},e.left=a.left-this.$window.scrollLeft(),e.width=0,e.height=(parseInt(n.css("line-height").replace("px",""),10)||10)-10-this.$window.scrollTop(),e.top=a.top,e.right=1,e.bottom=1,e.ok=!0,this.removeMarkers()}else this.getRange()&&(e=this.getRange().getBoundingClientRect());return e},t.Editable.prototype.repositionEditor=function(t){var e,i,n;if(this.options.inlineMode||t){if(e=this.getBoundingRect(),this.showBttnWrapper(),e.ok||e.left>=0&&e.top>=0&&e.right>0&&e.bottom>0)i=e.left+e.width/2,n=e.top+e.height,this.iOS()&&this.iOSVersion()<8||(i+=this.$window.scrollLeft(),n+=this.$window.scrollTop()),this.showByCoordinates(i,n);else if(this.options.alwaysVisible)this.hide();else{var r=this.$element.offset();this.showByCoordinates(r.left,r.top+10)}0===this.options.buttons.length&&this.hide()}},t.Editable.prototype.showByCoordinates=function(t,e){t-=22,e+=8;var i=this.$document.find(this.options.scrollableContainer);"body"!=this.options.scrollableContainer&&(t-=i.offset().left,e-=i.offset().top,this.iPad()||(t+=i.scrollLeft(),e+=i.scrollTop()));var n=Math.max(this.$popup_editor.outerWidth(),250);t+n>=i.outerWidth()-50&&t+44-n>0?(this.$popup_editor.addClass("right-side"),t=i.outerWidth()-(t+44),"static"==i.css("position")&&(t=t+parseFloat(i.css("margin-left"),10)+parseFloat(i.css("margin-right"),10)),this.$popup_editor.css("top",e),this.$popup_editor.css("right",t),this.$popup_editor.css("left","auto")):t+n<i.outerWidth()-50?(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",t),this.$popup_editor.css("right","auto")):(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",Math.max(i.outerWidth()-n,10)/2),this.$popup_editor.css("right","auto")),this.$popup_editor.show()},t.Editable.prototype.positionPopup=function(e){if(t(this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]')).length){var i=this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]'),n=i.width(),r=i.height(),a=i.offset().left+n/2,o=i.offset().top+r;this.showByCoordinates(a,o)}}}(jQuery),function(t){t.Editable.prototype.refreshImageAlign=function(t){this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var e="floatImageNone",i="center";t.hasClass("fr-fil")?(i="left",e="floatImageLeft"):t.hasClass("fr-fir")&&(i="right",e="floatImageRight"),this.$image_editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+i),this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshImageDisplay=function(){var t=this.$element.find(".f-img-editor");this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li').removeClass("active"),t.hasClass("fr-dib")?this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dib"]').addClass("active"):this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dii"]').addClass("active")},t.Editable.image_commands={align:{title:"Alignment",icon:"fa fa-align-center",refresh:t.Editable.prototype.refreshImageAlign,refreshOnShow:t.Editable.prototype.refreshImageAlign,seed:[{cmd:"floatImageLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"floatImageNone",title:"Align Center",icon:"fa fa-align-center"},{cmd:"floatImageRight",title:"Align Right",icon:"fa fa-align-right"}],callback:function(t,e,i){this[i](t)},undo:!0},display:{title:"Text Wrap",icon:"fa fa-star",refreshOnShow:t.Editable.prototype.refreshImageDisplay,namespace:"Image",seed:[{title:"Inline",value:"fr-dii"},{title:"Break Text",value:"fr-dib"}],callback:function(t,e,i){this.displayImage(t,i)},undo:!0},linkImage:{title:"Insert Link",icon:{type:"font",value:"fa fa-link"},callback:function(t){this.linkImage(t)}},replaceImage:{title:"Replace Image",icon:{type:"font",value:"fa fa-exchange"},callback:function(t){this.replaceImage(t)}},removeImage:{title:"Remove Image",icon:{type:"font",value:"fa fa-trash-o"},callback:function(t){this.removeImage(t)}}},t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedImageTypes:["jpeg","jpg","png","gif"],customImageButtons:{},defaultImageTitle:"Image title",defaultImageWidth:300,defaultImageDisplay:"block",defaultImageAlignment:"center",imageButtons:["display","align","linkImage","replaceImage","removeImage"],imageDeleteConfirmation:!0,imageDeleteURL:null,imageDeleteParams:{},imageMove:!0,imageResize:!0,imageLink:!0,imageTitle:!0,imageUpload:!0,imageUploadParams:{},imageUploadParam:"file",imageUploadToS3:!1,imageUploadURL:"http://i.froala.com/upload",maxImageSize:10485760,pasteImage:!0,textNearImage:!0}),t.Editable.prototype.hideImageEditorPopup=function(){this.$image_editor&&this.$image_editor.hide()},t.Editable.prototype.showImageEditorPopup=function(){this.$image_editor&&this.$image_editor.show(),this.options.imageMove||this.$element.attr("contenteditable",!1)},t.Editable.prototype.showImageWrapper=function(){this.$image_wrapper&&this.$image_wrapper.show()},t.Editable.prototype.hideImageWrapper=function(t){this.$image_wrapper&&(this.$element.attr("data-resize")||t||(this.closeImageMode(),this.imageMode=!1),this.$image_wrapper.hide(),this.$image_wrapper.find("input").blur())},t.Editable.prototype.showInsertImage=function(){this.hidePopups(),this.showImageWrapper()},t.Editable.prototype.showImageEditor=function(){this.hidePopups(),this.showImageEditorPopup()},t.Editable.prototype.insertImageHTML=function(){var e='<div class="froala-popup froala-image-popup" style="display: none;"><h4><span data-text="true">Insert Image</span><span data-text="true">Uploading image</span><i title="Cancel" class="fa fa-times" id="f-image-close-'+this._id+'"></i></h4>';return e+='<div id="f-image-list-'+this._id+'">',this.options.imageUpload&&(e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-upload-div-'+this._id+'"><strong data-text="true">Drop Image</strong><br>(<span data-text="true">or click</span>)<form target="frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.imageUploadURL+'" method="post" id="f-upload-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.imageUploadParam+'" accept="image/*"></form></div>',this.browser.msie&&t.Editable.getIEversion()<=9&&(e+='<iframe id="frame-'+this._id+'" name="frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;"></iframe>'),e+="</div>"),this.options.imageLink&&(e+='<div class="f-popup-line"><label><span data-text="true">Enter URL</span>: </label><input id="f-image-url-'+this._id+'" type="text" placeholder="http://example.com"><button class="f-browse fr-p-bttn" id="f-browser-'+this._id+'"><i class="fa fa-search"></i></button><button data-text="true" class="f-ok fr-p-bttn f-submit" id="f-image-ok-'+this._id+'">OK</button></div>'),e+="</div>",e+='<p class="f-progress" id="f-progress-'+this._id+'"><span></span></p>',e+="</div>"},t.Editable.prototype.iFrameLoad=function(){var t=this.$image_wrapper.find("iframe#frame-"+this._id);if(!t.attr("data-loaded"))return t.attr("data-loaded",!0),!1;try{var e=this.$image_wrapper.find("#f-upload-form-"+this._id);if(this.options.imageUploadToS3){var i=e.attr("action"),n=e.find('input[name="key"]').val(),r=i+n;this.writeImage(r),this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,r,n)}else{var a=t.contents().text();this.parseImageResponse(a)}}catch(o){this.throwImageError(7)}},t.Editable.prototype.initImage=function(){this.buildInsertImage(),(!this.isLink||this.isImage)&&this.initImagePopup(),this.addListener("destroy",this.destroyImage)},t.Editable.initializers.push(t.Editable.prototype.initImage),t.Editable.prototype.destroyImage=function(){this.$image_editor&&this.$image_editor.html("").removeData().remove(),this.$image_wrapper&&this.$image_wrapper.html("").removeData().remove()},t.Editable.prototype.buildInsertImage=function(){this.$image_wrapper=t(this.insertImageHTML()),this.$popup_editor.append(this.$image_wrapper);var e=this;if(this.$image_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.addListener("hidePopups",t.proxy(function(){this.hideImageWrapper(!0)},this)),this.$progress_bar=this.$image_wrapper.find("p#f-progress-"+this._id),this.options.imageUpload){if(this.browser.msie&&t.Editable.getIEversion()<=9){var i=this.$image_wrapper.find("iframe").get(0);i.attachEvent?i.attachEvent("onload",function(){e.iFrameLoad()}):i.onload=function(){e.iFrameLoad()}}this.$image_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadImage(this.files);else{if(!e.triggerEvent("beforeImageUpload",[],!1))return!1;var i=t(this).parents("form");i.find('input[type="hidden"]').remove();var n;for(n in e.options.imageUploadParams)i.prepend('<input type="hidden" name="'+n+'" value="'+e.options.imageUploadParams[n]+'" />');if(e.options.imageUploadToS3!==!1){for(n in e.options.imageUploadToS3.params)i.prepend('<input type="hidden" name="'+n+'" value="'+e.options.imageUploadToS3.params[n]+'" />');i.prepend('<input type="hidden" name="success_action_status" value="201" />'),i.prepend('<input type="hidden" name="X-Requested-With" value="xhr" />'),i.prepend('<input type="hidden" name="Content-Type" value="" />'),i.prepend('<input type="hidden" name="key" value="'+e.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+t(this).val().match(/[^\/\\]+$/)+'" />')}else i.prepend('<input type="hidden" name="XHR_CORS_TRARGETORIGIN" value="'+e.window.location.href+'" />');e.showInsertImage(),e.showImageLoader(!0),e.disable(),i.submit()}t(this).val("")})}this.buildDragUpload(),this.$image_wrapper.on("mouseup keydown","#f-image-url-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation()},this)),this.$image_wrapper.on("click","#f-image-ok-"+this._id,t.proxy(function(){this.writeImage(this.$image_wrapper.find("#f-image-url-"+this._id).val(),!0)},this)),this.$image_wrapper.on(this.mouseup,"#f-image-close-"+this._id,t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),this.$bttn_wrapper.show(),this.hideImageWrapper(!0),this.options.inlineMode&&0===this.options.buttons.length&&(this.imageMode?this.showImageEditor():this.hide()),this.imageMode||(this.restoreSelection(),this.focus()),void(this.options.inlineMode||this.imageMode?this.imageMode&&this.showImageEditor():this.hide()))},this)),this.$image_wrapper.on("click",function(t){t.stopPropagation()}),this.$image_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.prototype.deleteImage=function(e){if(this.options.imageDeleteURL){var i=this.options.imageDeleteParams;i.info=e.data("info"),i.src=e.attr("src"),t.ajax({type:"POST",url:this.options.imageDeleteURL,data:i,crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){e.parent().parent().hasClass("f-image-list")?e.parent().remove():e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteSuccess",[t],!1)},this)).fail(t.proxy(function(){e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Error during image delete."],!1)},this))}else e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Missing imageDeleteURL option."],!1)},t.Editable.prototype.imageHandle=function(){var e=this,i=t('<span data-fr-verified="true">').addClass("f-img-handle").on({movestart:function(i){e.hide(),e.$element.addClass("f-non-selectable").attr("contenteditable",!1),e.$element.attr("data-resize",!0),t(this).attr("data-start-x",i.startX),t(this).attr("data-start-y",i.startY)},move:function(i){var n=t(this),r=i.pageX-parseInt(n.attr("data-start-x"),10);n.attr("data-start-x",i.pageX),n.attr("data-start-y",i.pageY);var a=n.prevAll("img"),o=a.width();n.hasClass("f-h-ne")||n.hasClass("f-h-se")?a.attr("width",o+r):a.attr("width",o-r),e.triggerEvent("imageResize",[a],!1)},moveend:function(){t(this).removeAttr("data-start-x"),t(this).removeAttr("data-start-y");var i=t(this),n=i.prevAll("img");e.$element.removeClass("f-non-selectable"),e.isImage||e.$element.attr("contenteditable",!0),e.triggerEvent("imageResizeEnd",[n]),t(this).trigger("mouseup")},touchend:function(){t(this).trigger("moveend")}});return i},t.Editable.prototype.disableImageResize=function(){if(this.browser.mozilla)try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){}},t.Editable.prototype.isResizing=function(){return this.$element.attr("data-resize")},t.Editable.prototype.getImageStyle=function(t){var e="z-index: 1; position: relative; overflow: auto;",i=t,n="padding";return t.parent().hasClass("f-img-editor")&&(i=t.parent(),n="margin"),e+=" padding-left:"+i.css(n+"-left")+";",e+=" padding-right:"+i.css(n+"-right")+";",e+=" padding-bottom:"+i.css(n+"-bottom")+";",e+=" padding-top:"+i.css(n+"-top")+";",t.hasClass("fr-dib")?(e+=" vertical-align: top; display: block;",e+=t.hasClass("fr-fir")?" float: none; margin-right: 0; margin-left: auto;":t.hasClass("fr-fil")?" float: none; margin-left: 0; margin-right: auto;":" float: none; margin: auto;"):(e+=" display: inline-block;",e+=t.hasClass("fr-fir")?" float: right;":t.hasClass("fr-fil")?" float: left;":" float: none;"),e},t.Editable.prototype.getImageClass=function(t){var e=t.split(" ");return t="fr-fin",e.indexOf("fr-fir")>=0&&(t="fr-fir"),e.indexOf("fr-fil")>=0&&(t="fr-fil"),e.indexOf("fr-dib")>=0&&(t+=" fr-dib"),e.indexOf("fr-dii")>=0&&(t+=" fr-dii"),t},t.Editable.prototype.refreshImageButtons=function(t){this.$image_editor.find("button").removeClass("active");var e=t.css("float");e=t.hasClass("fr-fil")?"Left":t.hasClass("fr-fir")?"Right":"None",this.$image_editor.find('button[data-cmd="floatImage'+e+'"]').addClass("active"),this.raiseEvent("refreshImage",[t])},t.Editable.prototype.initImageEvents=function(){document.addEventListener&&!document.dropAssigned&&(document.dropAssigned=!0,document.addEventListener("drop",t.proxy(function(e){return t(".froala-element img.fr-image-move").length?(e.preventDefault(),e.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move"),!1):void 0},this))),this.disableImageResize();var e=this;this.$element.on("mousedown",'img:not([contenteditable="false"])',function(i){return e.isDisabled?!1:void(e.isResizing()||(e.initialized&&i.stopPropagation(),e.$element.attr("contenteditable",!1),t(this).addClass("fr-image-move")))}),this.$element.on("mouseup",'img:not([contenteditable="false"])',function(){return e.isDisabled?!1:void(e.isResizing()||(e.options.imageMove||e.isImage||e.isHTML||e.$element.attr("contenteditable",!0),t(this).removeClass("fr-image-move")))}),this.$element.on("click touchend",'img:not([contenteditable="false"])',function(i){if(e.isDisabled)return!1;if(!e.isResizing()&&e.initialized){if(i.preventDefault(),i.stopPropagation(),e.closeImageMode(),e.$element.blur(),e.refreshImageButtons(t(this)),e.$image_editor.find('.f-image-alt input[type="text"]').val(t(this).attr("alt")||t(this).attr("title")),e.showImageEditor(),!t(this).parent().hasClass("f-img-editor")||"SPAN"!=t(this).parent().get(0).tagName){var n=e.getImageClass(t(this).attr("class"));t(this).wrap('<span data-fr-verified="true" class="f-img-editor '+n+'"></span>'),0!==t(this).parents(".f-img-wrap").length||e.isImage?t(this).parents(".f-img-wrap").attr("class",n+" f-img-wrap"):t(this).parents("a").length>0?t(this).parents("a:first").wrap('<span data-fr-verified="true" class="f-img-wrap '+n+'"></span>'):t(this).parent().wrap('<span data-fr-verified="true" class="f-img-wrap '+n+'"></span>')}if(t(this).parent().find(".f-img-handle").remove(),e.options.imageResize){var r=e.imageHandle();t(this).parent().append(r.clone(!0).addClass("f-h-ne")),t(this).parent().append(r.clone(!0).addClass("f-h-se")),t(this).parent().append(r.clone(!0).addClass("f-h-sw")),t(this).parent().append(r.clone(!0).addClass("f-h-nw"))}e.showByCoordinates(t(this).offset().left+t(this).width()/2,t(this).offset().top+t(this).height()),e.imageMode=!0,e.$bttn_wrapper.find(".fr-bttn").removeClass("active"),e.clearSelection()}}),this.$element.on("mousedown touchstart",".f-img-handle",t.proxy(function(){return e.isDisabled?!1:void this.$element.attr("data-resize",!0)},this)),this.$element.on("mouseup",".f-img-handle",t.proxy(function(i){if(e.isDisabled)return!1;var n=t(i.target).prevAll("img");setTimeout(t.proxy(function(){this.$element.removeAttr("data-resize"),n.click()},this),0)},this))},t.Editable.prototype.execImage=function(e,i,n){var r=this.$element.find("span.f-img-editor"),a=r.find("img"),o=t.Editable.image_commands[e]||this.options.customImageButtons[e];o&&o.callback&&o.callback.apply(this,[a,e,i,n])},t.Editable.prototype.bindImageRefreshListener=function(e){
e.refresh&&this.addListener("refreshImage",t.proxy(function(t){e.refresh.apply(this,[t])},this))},t.Editable.prototype.buildImageButton=function(t,e){var i='<button class="fr-bttn" data-namespace="Image" data-cmd="'+e+'" title="'+t.title+'">';return i+=void 0!==this.options.icons[e]?this.prepareIcon(this.options.icons[e],t.title):this.prepareIcon(t.icon,t.title),i+="</button>",this.bindImageRefreshListener(t),i},t.Editable.prototype.buildImageAlignDropdown=function(t){this.bindImageRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var n=t.seed[i];e+='<li data-cmd="align" data-namespace="Image" data-val="'+n.cmd+'" title="'+n.title+'"><a href="#"><i class="'+n.icon+'"></i></a></li>'}return e+="</ul>"},t.Editable.prototype.buildImageDropdown=function(t){return dropdown=this.buildDefaultDropdown(t),btn=this.buildDropdownButton(t,dropdown),btn},t.Editable.prototype.image_command_dispatcher={align:function(t){var e=this.buildImageAlignDropdown(t),i=this.buildDropdownButton(t,e);return i}},t.Editable.prototype.buildImageButtons=function(){for(var e="",i=0;i<this.options.imageButtons.length;i++){var n=this.options.imageButtons[i];if(void 0!==t.Editable.image_commands[n]||void 0!==this.options.customImageButtons[n]){var r=t.Editable.image_commands[n]||this.options.customImageButtons[n];r.cmd=n;var a=this.image_command_dispatcher[n];e+=a?a.apply(this,[r]):r.seed?this.buildImageDropdown(r,n):this.buildImageButton(r,n)}}return e},t.Editable.prototype.initImagePopup=function(){this.$image_editor=t('<div class="froala-popup froala-image-editor-popup" style="display: none">');var e=t('<div class="f-popup-line f-popup-toolbar">').appendTo(this.$image_editor);e.append(this.buildImageButtons()),this.addListener("hidePopups",this.hideImageEditorPopup),this.options.imageTitle&&t('<div class="f-popup-line f-image-alt">').append('<label><span data-text="true">Title</span>: </label>').append(t('<input type="text">').on("mouseup keydown touchend",function(t){var e=t.which;e&&27===e||t.stopPropagation()})).append('<button class="fr-p-bttn f-ok" data-text="true" data-callback="setImageAlt" data-cmd="setImageAlt" title="OK">OK</button>').appendTo(this.$image_editor),this.$popup_editor.append(this.$image_editor),this.bindCommandEvents(this.$image_editor),this.bindDropdownEvents(this.$image_editor)},t.Editable.prototype.displayImage=function(t,e){var i=t.parents("span.f-img-editor");i.removeClass("fr-dii fr-dib").addClass(e),this.triggerEvent("imageDisplayed",[t,e]),t.click()},t.Editable.prototype.floatImageLeft=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fil"),this.isImage&&this.$element.css("float","left"),this.triggerEvent("imageFloatedLeft",[t]),t.click()},t.Editable.prototype.floatImageNone=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fin"),this.isImage||(e.parent().get(0)==this.$element.get(0)?e.wrap('<div style="text-align: center;"></div>'):e.parents(".f-img-wrap:first").css("text-align","center")),this.isImage&&this.$element.css("float","none"),this.triggerEvent("imageFloatedNone",[t]),t.click()},t.Editable.prototype.floatImageRight=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fir"),this.isImage&&this.$element.css("float","right"),this.triggerEvent("imageFloatedRight",[t]),t.click()},t.Editable.prototype.linkImage=function(t){this.imageMode=!0,this.showInsertLink();var e=t.parents("span.f-img-editor");"A"==e.parent().get(0).tagName?this.updateLinkValues(e.parent()):this.resetLinkValues()},t.Editable.prototype.replaceImage=function(t){this.showInsertImage(),this.imageMode=!0,this.$image_wrapper.find('input[type="text"]').val(t.attr("src")),this.showByCoordinates(t.offset().left+t.width()/2,t.offset().top+t.height())},t.Editable.prototype.removeImage=function(e){var i=e.parents("span.f-img-editor");if(0===i.length)return!1;var n=e.get(0),r="Are you sure? Image will be deleted.";if(t.Editable.LANGS[this.options.language]&&(r=t.Editable.LANGS[this.options.language].translation[r]),!this.options.imageDeleteConfirmation||confirm(r)){if(this.triggerEvent("beforeRemoveImage",[t(n)],!1)){var a=i.parents(this.valid_nodes.join(","));i.parents(".f-img-wrap").length?i.parents(".f-img-wrap").remove():i.remove(),this.refreshImageList(!0),this.hide(),a.length&&a[0]!=this.$element.get(0)&&""===t(a[0]).text()&&1==a[0].childNodes.length&&t(a[0]).remove(),this.wrapText(),this.triggerEvent("afterRemoveImage",[e]),this.focus(),this.imageMode=!1}}else e.click()},t.Editable.prototype.setImageAlt=function(){var t=this.$element.find("span.f-img-editor"),e=t.find("img");e.attr("alt",this.$image_editor.find('.f-image-alt input[type="text"]').val()),e.attr("title",this.$image_editor.find('.f-image-alt input[type="text"]').val()),this.hide(),this.closeImageMode(),this.triggerEvent("imageAltSet",[e])},t.Editable.prototype.buildImageMove=function(){var e=this;this.isLink||this.initDrag(),e.$element.on("dragover dragenter dragend",function(t){t.preventDefault()}),e.$element.on("drop",function(i){if(e.isDisabled)return!1;if(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),!e.options.imageUpload||0!==t(".froala-element img.fr-image-move").length){if(t(".froala-element .fr-image-move").length>0&&e.options.imageMove){i.preventDefault(),i.stopPropagation(),e.insertMarkersAtPoint(i.originalEvent),e.restoreSelectionByMarkers();var n=t("<div>").append(t(".froala-element img.fr-image-move").clone().removeClass("fr-image-move").addClass("fr-image-dropped")).html();e.insertHTML(n);var r=t(".froala-element img.fr-image-move").parent();t(".froala-element img.fr-image-move").remove(),r.get(0)!=e.$element.get(0)&&r.is(":empty")&&r.remove(),e.clearSelection(),e.initialized?setTimeout(function(){e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped").click()},0):e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped"),e.sync(),e.hideOtherEditors()}else i.preventDefault(),i.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move");return!1}if(i.originalEvent.dataTransfer&&i.originalEvent.dataTransfer.files&&i.originalEvent.dataTransfer.files.length){if(e.isDisabled)return!1;var a=i.originalEvent.dataTransfer.files;e.options.allowedImageTypes.indexOf(a[0].type.replace(/image\//g,""))>=0&&(e.insertMarkersAtPoint(i.originalEvent),e.showByCoordinates(i.originalEvent.pageX,i.originalEvent.pageY),e.uploadImage(a),i.preventDefault(),i.stopPropagation())}})},t.Editable.prototype.buildDragUpload=function(){var e=this;e.$image_wrapper.on("dragover","#f-upload-div-"+this._id,function(){return t(this).addClass("f-hover"),!1}),e.$image_wrapper.on("dragend","#f-upload-div-"+this._id,function(){return t(this).removeClass("f-hover"),!1}),e.$image_wrapper.on("drop","#f-upload-div-"+this._id,function(i){return i.preventDefault(),i.stopPropagation(),e.options.imageUpload?(t(this).removeClass("f-hover"),void e.uploadImage(i.originalEvent.dataTransfer.files)):!1})},t.Editable.prototype.showImageLoader=function(e){if(void 0===e&&(e=!1),e){var i="Please wait!";t.Editable.LANGS[this.options.language]&&(i=t.Editable.LANGS[this.options.language].translation[i]),this.$progress_bar.find("span").css("width","100%").text(i)}else this.$image_wrapper.find("h4").addClass("uploading");this.$image_wrapper.find("#f-image-list-"+this._id).hide(),this.$progress_bar.show(),this.showInsertImage()},t.Editable.prototype.hideImageLoader=function(){this.$progress_bar.hide(),this.$progress_bar.find("span").css("width","0%").text(""),this.$image_wrapper.find("#f-image-list-"+this._id).show(),this.$image_wrapper.find("h4").removeClass("uploading")},t.Editable.prototype.writeImage=function(e,i,n){if(i&&(e=this.sanitizeURL(e),""===e))return!1;var r=new Image;r.onerror=t.proxy(function(){this.hideImageLoader(),this.throwImageError(1)},this),r.onload=this.imageMode?t.proxy(function(){var t=this.$element.find(".f-img-editor > img");t.attr("src",e),this.hide(),this.hideImageLoader(),this.$image_editor.show(),this.enable(),this.triggerEvent("imageReplaced",[t,n]),setTimeout(function(){t.trigger("click")},0)},this):t.proxy(function(){this.insertLoadedImage(e,n)},this),this.showImageLoader(!0),r.src=e},t.Editable.prototype.processInsertImage=function(e,i){void 0===i&&(i=!0),this.enable(),this.focus(),this.restoreSelection();var n="";parseInt(this.options.defaultImageWidth,10)&&(n=' width="'+this.options.defaultImageWidth+'"');var r="fr-fin";"left"==this.options.defaultImageAlignment&&(r="fr-fil"),"right"==this.options.defaultImageAlignment&&(r="fr-fir"),r+=" fr-di"+this.options.defaultImageDisplay[0];var a='<img class="'+r+' fr-just-inserted" alt="'+this.options.defaultImageTitle+'" src="'+e+'"'+n+">",o=this.getSelectionElements()[0],s=this.getRange(),l=!this.browser.msie&&t.Editable.getIEversion()>8?t(s.startContainer):null;l&&l.hasClass("f-img-wrap")?(1===s.startOffset?(l.after("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()):0===s.startOffset&&(l.before("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()),this.insertHTML(a)):this.getSelectionTextInfo(o).atStart&&o!=this.$element.get(0)&&"TD"!=o.tagName&&"TH"!=o.tagName&&"LI"!=o.tagName?t(o).before("<"+this.options.defaultTag+">"+a+"</"+this.options.defaultTag+">"):this.insertHTML(a),this.disable()},t.Editable.prototype.insertLoadedImage=function(e,i){this.triggerEvent("imageLoaded",[e],!1),this.processInsertImage(e,!1),this.browser.msie&&this.$element.find("img").each(function(t,e){e.oncontrolselect=function(){return!1}}),this.enable(),this.hide(),this.hideImageLoader(),this.wrapText(),this.cleanupLists();var n,r=this.$element.find("img.fr-just-inserted").get(0);r&&(n=r.previousSibling),n&&3==n.nodeType&&/\u200B/gi.test(n.textContent)&&t(n).remove(),this.triggerEvent("imageInserted",[this.$element.find("img.fr-just-inserted"),i]),setTimeout(t.proxy(function(){this.$element.find("img.fr-just-inserted").removeClass("fr-just-inserted").trigger("touchend")},this),50)},t.Editable.prototype.throwImageErrorWithMessage=function(t){this.enable(),this.triggerEvent("imageError",[{message:t,code:0}],!1),this.hideImageLoader()},t.Editable.prototype.throwImageError=function(t){this.enable();var e="Unknown image upload error.";1==t?e="Bad link.":2==t?e="No link in upload response.":3==t?e="Error during file upload.":4==t?e="Parsing response failed.":5==t?e="Image too large.":6==t?e="Invalid image type.":7==t&&(e="Image can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("imageError",[{code:t,message:e}],!1),this.hideImageLoader()},t.Editable.prototype.uploadImage=function(e){if(!this.triggerEvent("beforeImageUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var i;if(this.drag_support.formdata&&(i=this.drag_support.formdata?new FormData:null),i){var n;for(n in this.options.imageUploadParams)i.append(n,this.options.imageUploadParams[n]);if(this.options.imageUploadToS3!==!1){for(n in this.options.imageUploadToS3.params)i.append(n,this.options.imageUploadToS3.params[n]);i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",e[0].type),i.append("key",this.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+e[0].name)}if(i.append(this.options.imageUploadParam,e[0]),e[0].size>this.options.maxImageSize)return this.throwImageError(5),!1;if(this.options.allowedImageTypes.indexOf(e[0].type.replace(/image\//g,""))<0)return this.throwImageError(6),!1}if(i){var r;if(this.options.crossDomain)r=this.createCORSRequest("POST",this.options.imageUploadURL);else{r=new XMLHttpRequest,r.open("POST",this.options.imageUploadURL);for(var a in this.options.headers)r.setRequestHeader(a,this.options.headers[a])}r.onload=t.proxy(function(){var e="Please wait!";t.Editable.LANGS[this.options.language]&&(e=t.Editable.LANGS[this.options.language].translation[e]),this.$progress_bar.find("span").css("width","100%").text(e);try{if(this.options.imageUploadToS3)201==r.status?this.parseImageResponseXML(r.responseXML):this.throwImageError(3);else if(r.status>=200&&r.status<300)this.parseImageResponse(r.responseText);else try{var i=t.parseJSON(r.responseText);i.error?this.throwImageErrorWithMessage(i.error):this.throwImageError(3)}catch(n){this.throwImageError(3)}}catch(n){this.throwImageError(4)}},this),r.onerror=t.proxy(function(){this.throwImageError(3)},this),r.upload.onprogress=t.proxy(function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0;this.$progress_bar.find("span").css("width",e+"%")}},this),this.disable(),r.send(i),this.showImageLoader()}}},t.Editable.prototype.parseImageResponse=function(e){try{if(!this.triggerEvent("afterImageUpload",[e],!1))return!1;var i=t.parseJSON(e);i.link?this.writeImage(i.link,!1,e):i.error?this.throwImageErrorWithMessage(i.error):this.throwImageError(2)}catch(n){this.throwImageError(4)}},t.Editable.prototype.parseImageResponseXML=function(e){try{var i=t(e).find("Location").text(),n=t(e).find("Key").text();this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,i,n),i?this.writeImage(i):this.throwImageError(2)}catch(r){this.throwImageError(4)}},t.Editable.prototype.setImageUploadURL=function(t){t&&(this.options.imageUploadURL=t),this.options.imageUploadToS3&&(this.options.imageUploadURL="https://"+this.options.imageUploadToS3.bucket+"."+this.options.imageUploadToS3.region+".amazonaws.com/")},t.Editable.prototype.closeImageMode=function(){this.$element.find("span.f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class"))),t(i).parents(".f-img-wrap").length>0?"A"==t(i).parent().parent().get(0).tagName?t(i).siblings("span.f-img-handle").remove().end().unwrap().parent().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap()},this)),this.$element.find("span.f-img-editor").length&&(this.$element.find("span.f-img-editor").remove(),this.$element.parents("span.f-img-editor").remove()),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0),this.$image_editor&&this.$image_editor.hide(),this.$link_wrapper&&this.options.linkText&&this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden")},t.Editable.prototype.refreshImageList=function(e){if(!this.isLink&&!this.options.editInPopup){var i=[],n=[],r=this;if(this.$element.find("img").each(function(e,a){var o=t(a);if(i.push(o.attr("src")),n.push(o),"false"==o.attr("contenteditable"))return!0;if(0!==o.parents(".f-img-editor").length||o.hasClass("fr-dii")||o.hasClass("fr-dib")||(r.options.textNearImage?o.addClass(o.hasClass("fr-fin")?"fr-dib":o.hasClass("fr-fil")||o.hasClass("fr-fir")?"fr-dii":"block"==o.css("display")&&"none"==o.css("float")?"fr-dib":"fr-dii"):(o.addClass("fr-dib"),r.options.imageButtons.splice(r.options.imageButtons.indexOf("display"),1))),r.options.textNearImage||o.removeClass("fr-dii").addClass("fr-dib"),0===o.parents(".f-img-editor").length&&!o.hasClass("fr-fil")&&!o.hasClass("fr-fir")&&!o.hasClass("fr-fin"))if(o.hasClass("fr-dii"))o.addClass("right"==o.css("float")?"fr-fir":"left"==o.css("float")?"fr-fil":"fr-fin");else{var s=o.attr("style");o.hide(),o.addClass(0===parseInt(o.css("margin-right"),10)&&s?"fr-fir":0===parseInt(o.css("margin-left"),10)&&s?"fr-fil":"fr-fin"),o.show()}o.css("margin",""),o.css("float",""),o.css("display",""),o.removeAttr("data-style")}),void 0===e)for(var a=0;a<this.imageList.length;a++)i.indexOf(this.imageList[a].attr("src"))<0&&this.triggerEvent("afterRemoveImage",[this.imageList[a]],!1);this.imageList=n}},t.Editable.prototype.insertImage=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertImage")),this.selectionInEditor()&&this.saveSelection(),this.showInsertImage(),this.imageMode=!1,this.$image_wrapper.find('input[type="text"]').val("")}}(jQuery),function(t){t.Editable.prototype.showLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.show(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList"),this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode||!this.options.linkText?this.$link_wrapper.find('input[type="text"].f-lt').parent().addClass("fr-hidden"):this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden"),this.imageMode&&this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.phone()?this.$document.scrollTop(this.$link_wrapper.offset().top+30):setTimeout(t.proxy(function(){this.imageMode&&this.iPad()||this.$link_wrapper.find('input[type="text"].f-lu').focus().select()},this),0),this.link=!0),this.refreshDisabledState()},t.Editable.prototype.hideLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.hide(),this.$link_wrapper.find("input").blur()),this.refreshDisabledState()},t.Editable.prototype.showInsertLink=function(){this.hidePopups(),this.showLinkWrapper()},t.Editable.prototype.updateLinkValues=function(e){var i=e.attr("href")||"http://";this.$link_wrapper.find("input.f-lt").val(e.text()),this.isLink?("#"==i&&(i=""),this.$link_wrapper.find("input#f-lu-"+this._id).val(i.replace(/\&amp;/g,"&")),this.$link_wrapper.find(".f-external-link").attr("href",i||"#")):(this.$link_wrapper.find("input.f-lu").val(i.replace(/\&amp;/g,"&")),this.$link_wrapper.find(".f-external-link").attr("href",i)),this.$link_wrapper.find("input.f-target").prop("checked","_blank"==e.attr("target")),this.$link_wrapper.find("li.f-choose-link-class").each(t.proxy(function(i,n){e.hasClass(t(n).data("class"))&&t(n).click()},this));for(var n in this.options.linkAttributes){var r=e.attr(n);this.$link_wrapper.find("input.fl-"+n).val(r?r:"")}this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()},t.Editable.prototype.initLinkEvents=function(){var e=this,i=function(t){t.stopPropagation(),t.preventDefault()},n=function(i){return i.stopPropagation(),i.preventDefault(),e.isDisabled?!1:""!==e.text()?(e.hide(),!1):(e.link=!0,e.clearSelection(),e.removeMarkers(),e.selectionDisabled||(t(this).before('<span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),t(this).after('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span>'),e.restoreSelectionByMarkers()),e.exec("createLink"),e.updateLinkValues(t(this)),e.showByCoordinates(t(this).offset().left+t(this).outerWidth()/2,t(this).offset().top+(parseInt(t(this).css("padding-top"),10)||0)+t(this).height()),e.showInsertLink(),t(this).hasClass("fr-file")?e.$link_wrapper.find("input.f-lu").attr("disabled","disabled"):e.$link_wrapper.find("input.f-lu").removeAttr("disabled"),void e.closeImageMode())};this.$element.on("mousedown","a",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.isLink?this.iOS()?(this.$element.on("touchstart",i),this.$element.on("touchend",n)):this.$element.on("click",n):this.iOS()?(this.$element.on("touchstart",'a:not([contenteditable="false"])',i),this.$element.on("touchend",'a:not([contenteditable="false"])',n),this.$element.on("touchstart",'a[contenteditable="false"]',i),this.$element.on("touchend",'a[contenteditable="false"]',i)):(this.$element.on("click",'a:not([contenteditable="false"])',n),this.$element.on("click",'a[contenteditable="false"]',i))},t.Editable.prototype.destroyLink=function(){this.$link_wrapper.html("").removeData().remove()},t.Editable.prototype.initLink=function(){this.buildCreateLink(),this.initLinkEvents(),this.addListener("destroy",this.destroyLink)},t.Editable.initializers.push(t.Editable.prototype.initLink),t.Editable.prototype.removeLink=function(){this.imageMode?("A"==this.$element.find(".f-img-editor").parent().get(0).tagName&&t(this.$element.find(".f-img-editor").get(0)).unwrap(),this.triggerEvent("imageLinkRemoved"),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1):(this.restoreSelection(),this.document.execCommand("unlink",!1,null),this.isLink||this.$element.find("a:empty").remove(),this.triggerEvent("linkRemoved"),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1)},t.Editable.prototype.writeLink=function(e,i,n,r,a){var o,s=this.options.noFollow;this.options.alwaysBlank&&(r=!0);var l,d="",h="",p="";s===!0&&/^https?:\/\//.test(e)&&(d='rel="nofollow"'),r===!0&&(h='target="_blank"');for(l in a)p+=" "+l+'="'+a[l]+'"';var c=e;if(e=this.sanitizeURL(e),this.options.convertMailAddresses){var u=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/i;u.test(e)&&0!==e.indexOf("mailto:")&&(e="mailto:"+e)}if(0===e.indexOf("mailto:")||""===this.options.linkAutoPrefix||/^(https?:|ftps?:|)\/\//.test(e)||(e=this.options.linkAutoPrefix+e),""===e)return this.$link_wrapper.find("input.f-lu").addClass("fr-error").focus(),this.triggerEvent("badLink",[c],!1),!1;if(this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode){if("A"!=this.$element.find(".f-img-editor").parent().get(0).tagName)this.$element.find(".f-img-editor").wrap('<a data-fr-link="true" href="'+e+'" '+h+" "+d+p+"></a>");else{var f=this.$element.find(".f-img-editor").parent();r===!0?f.attr("target","_blank"):f.removeAttr("target"),s===!0?f.attr("rel","nofollow"):f.removeAttr("rel");for(l in a)a[l]?f.attr(l,a[l]):f.removeAttr(l);f.removeClass(Object.keys(this.options.linkClasses).join(" ")),f.attr("href",e).addClass(n)}this.triggerEvent("imageLinkInserted",[e]),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1}else{var m=null;this.isLink?""===i&&(i=this.$element.text()):(this.restoreSelection(),o=this.getSelectionLinks(),o.length>0&&(m=o[0].attributes,is_file=t(o[0]).hasClass("fr-file")),this.saveSelectionByMarkers(),this.document.execCommand("unlink",!1,e),this.$element.find('span[data-fr-link="true"]').each(function(e,i){t(i).replaceWith(t(i).html())}),this.restoreSelectionByMarkers()),this.isLink?(this.$element.text(i),o=[this.$element.attr("href",e).get(0)]):(this.removeMarkers(),(this.options.linkText||""===this.text())&&(this.insertHTML('<span class="f-marker" data-fr-verified="true" data-id="0" data-type="true"></span>'+(i||this.clean(c))+'<span class="f-marker" data-fr-verified="true" data-id="0" data-type="false"></span>'),this.restoreSelectionByMarkers()),this.document.execCommand("createLink",!1,e),o=this.getSelectionLinks());for(var g=0;g<o.length;g++){if(m)for(var v=0;v<m.length;v++)"href"!=m[v].nodeName&&t(o[g]).attr(m[v].nodeName,m[v].value);r===!0?t(o[g]).attr("target","_blank"):t(o[g]).removeAttr("target"),s===!0&&/^https?:\/\//.test(e)?t(o[g]).attr("rel","nofollow"):t(o[g]).removeAttr("rel"),t(o[g]).data("fr-link",!0),t(o[g]).removeClass(Object.keys(this.options.linkClasses).join(" ")),t(o[g]).addClass(n);for(l in a)a[l]?t(o[g]).attr(l,a[l]):t(o[g]).removeAttr(l)}this.$element.find("a:empty").remove(),this.triggerEvent("linkInserted",[e]),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1}},t.Editable.prototype.createLinkHTML=function(){var t='<div class="froala-popup froala-link-popup" style="display: none;">';t+='<h4><span data-text="true">Insert Link</span><a target="_blank" title="Open Link" class="f-external-link" href="#"><i class="fa fa-external-link"></i></a><i title="Cancel" class="fa fa-times" id="f-link-close-'+this._id+'"></i></h4>',t+='<div class="f-popup-line fr-hidden"><input type="text" placeholder="Text" class="f-lt" id="f-lt-'+this._id+'"></div>';var e="";if(this.options.linkList.length&&(e="f-bi"),t+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu '+e+'" id="f-lu-'+this._id+'"/>',this.options.linkList.length){t+='<button class="fr-p-bttn f-browse-links" id="f-browse-links-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-list-'+this._id+'">';for(var i=0;i<this.options.linkList.length;i++){var n=this.options.linkList[i],r="";for(var a in n)r+=" data-"+a+'="'+n[a]+'"';t+='<li class="f-choose-link"'+r+">"+n.body+"</li>"}t+="</ul>"}if(t+="</div>",Object.keys(this.options.linkClasses).length){t+='<div class="f-popup-line"><input type="text" placeholder="Choose link type" class="f-bi" id="f-luc-'+this._id+'" disabled="disabled"/>',t+='<button class="fr-p-bttn f-browse-links" id="f-links-class-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-class-list-'+this._id+'">';for(var o in this.options.linkClasses){var s=this.options.linkClasses[o];t+='<li class="f-choose-link-class" data-class="'+o+'">'+s+"</li>"}t+="</ul>",t+="</div>"}for(var l in this.options.linkAttributes){var d=this.options.linkAttributes[l];t+='<div class="f-popup-line"><input class="fl-'+l+'" type="text" placeholder="'+d+'" id="fl-'+l+"-"+this._id+'"/></div>'}return t+='<div class="f-popup-line"><input type="checkbox" class="f-target" id="f-target-'+this._id+'"> <label data-text="true" for="f-target-'+this._id+'">Open in new tab</label><button data-text="true" type="button" class="fr-p-bttn f-ok f-submit" id="f-ok-'+this._id+'">OK</button>',this.options.unlinkButton&&(t+='<button type="button" data-text="true" class="fr-p-bttn f-ok f-unlink" id="f-unlink-'+this._id+'">UNLINK</button>'),t+="</div></div>"},t.Editable.prototype.buildCreateLink=function(){this.$link_wrapper=t(this.createLinkHTML()),this.$popup_editor.append(this.$link_wrapper);var e=this;this.addListener("hidePopups",this.hideLinkWrapper),this.$link_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||(t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"))},this)),this.$link_wrapper.on("click",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","*",function(t){t.stopPropagation()}),this.options.linkText&&this.$link_wrapper.on("mouseup keydown","input#f-lt-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("mouseup keydown touchend touchstart","input#f-lu-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click keydown","input#f-target-"+this._id,function(t){var e=t.which;e&&27===e||t.stopPropagation()}),this.$link_wrapper.on("touchend","button#f-ok-"+this._id,function(t){t.stopPropagation()}).on("click","button#f-ok-"+this._id,t.proxy(function(){var t,e=this.$link_wrapper.find("input#f-lt-"+this._id),i=this.$link_wrapper.find("input#f-lu-"+this._id),n=this.$link_wrapper.find("input#f-luc-"+this._id),r=this.$link_wrapper.find("input#f-target-"+this._id);t=e?e.val():"";var a=i.val();this.isLink&&""===a&&(a="#");var o="";n&&(o=n.data("class"));var s={};for(var l in this.options.linkAttributes)s[l]=this.$link_wrapper.find("input#fl-"+l+"-"+this._id).val();this.writeLink(a,t,o,r.prop("checked"),s)},this)),this.$link_wrapper.on("click touch","button#f-unlink-"+this._id,t.proxy(function(){this.link=!0,this.removeLink()},this)),this.options.linkList.length&&(this.$link_wrapper.on("click touch","li.f-choose-link",function(){e.resetLinkValues();var i=e.$link_wrapper.find("button#f-browse-links-"+e._id),n=e.$link_wrapper.find("input#f-lt-"+e._id),r=e.$link_wrapper.find("input#f-lu-"+e._id),a=e.$link_wrapper.find("input#f-target-"+e._id);n&&n.val(t(this).data("body")),r.val(t(this).data("href")),a.prop("checked",t(this).data("blank"));for(var o in e.options.linkAttributes)t(this).data(o)&&e.$link_wrapper.find("input#fl-"+o+"-"+e._id).val(t(this).data(o));i.click()}).on("mouseup","li.f-choose-link",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-browse-links-"+this._id+", button#f-browse-links-"+this._id+" > i",function(i){i.stopPropagation();var n=e.$link_wrapper.find("ul#f-link-list-"+e._id);e.$link_wrapper.trigger("hideLinkClassList"),t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),n.toggle()}).on("mouseup","button#f-browse-links-"+this._id+", button#f-browse-links-"+this._id+" > i",function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkList",function(){var t=e.$link_wrapper.find("ul#f-link-list-"+e._id),i=e.$link_wrapper.find("button#f-browse-links-"+e._id);t&&t.is(":visible")&&i.click()})),Object.keys(this.options.linkClasses).length&&(this.$link_wrapper.on("mouseup keydown","input#f-luc-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click touch","li.f-choose-link-class",function(){var i=e.$link_wrapper.find("input#f-luc-"+e._id);i.val(t(this).text()),i.data("class",t(this).data("class")),e.$link_wrapper.trigger("hideLinkClassList")}).on("mouseup","li.f-choose-link-class",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-links-class-"+this._id,function(i){i.stopPropagation(),e.$link_wrapper.trigger("hideLinkList");var n=e.$link_wrapper.find("ul#f-link-class-list-"+e._id);t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),n.toggle()}).on("mouseup","button#f-links-class-"+this._id,function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkClassList",function(){var t=e.$link_wrapper.find("ul#f-link-class-list-"+e._id),i=e.$link_wrapper.find("button#f-links-class-"+e._id);t&&t.is(":visible")&&i.click()})),this.$link_wrapper.on(this.mouseup,"i#f-link-close-"+this._id,t.proxy(function(){this.$bttn_wrapper.show(),this.hideLinkWrapper(),(!this.options.inlineMode&&!this.imageMode||this.isLink||0===this.options.buttons.length)&&this.hide(),this.imageMode?this.showImageEditor():(this.restoreSelection(),this.focus())},this))},t.Editable.prototype.getSelectionLinks=function(){var t,e,i,n,r=[];if(this.window.getSelection){var a=this.window.getSelection();if(a.getRangeAt&&a.rangeCount){n=this.document.createRange();for(var o=0;o<a.rangeCount;++o)if(t=a.getRangeAt(o),e=t.commonAncestorContainer,e&&1!=e.nodeType&&(e=e.parentNode),e&&"a"==e.nodeName.toLowerCase())r.push(e);else{i=e.getElementsByTagName("a");for(var s=0;s<i.length;++s)n.selectNodeContents(i[s]),n.compareBoundaryPoints(t.END_TO_START,t)<1&&n.compareBoundaryPoints(t.START_TO_END,t)>-1&&r.push(i[s])}}}else if(this.document.selection&&"Control"!=this.document.selection.type)if(t=this.document.selection.createRange(),e=t.parentElement(),"a"==e.nodeName.toLowerCase())r.push(e);else{i=e.getElementsByTagName("a"),n=this.document.body.createTextRange();for(var l=0;l<i.length;++l)n.moveToElementText(i[l]),n.compareEndPoints("StartToEnd",t)>-1&&n.compareEndPoints("EndToStart",t)<1&&r.push(i[l])}return r},t.Editable.prototype.resetLinkValues=function(){this.$link_wrapper.find("input").val(""),this.$link_wrapper.find('input[type="checkbox"].f-target').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find('input[type="text"].f-lt').val(this.text()),this.$link_wrapper.find('input[type="text"].f-lu').val("http://"),this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide();for(var t in this.options.linkAttributes)this.$link_wrapper.find('input[type="text"].fl-'+t).val("")},t.Editable.prototype.insertLink=function(){
this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("createLink")),this.selectionInEditor()&&this.saveSelection(),this.showInsertLink();var e=this.getSelectionLinks();e.length>0?this.updateLinkValues(t(e[0])):this.resetLinkValues()}}(jQuery),function(t){t.Editable.prototype.browserFixes=function(){this.backspaceEmpty(),this.backspaceInEmptyBlock(),this.fixHR(),this.domInsert(),this.fixIME(),this.cleanInvisibleSpace(),this.cleanBR(),this.insertSpace()},t.Editable.prototype.backspaceInEmptyBlock=function(){this.$element.on("keyup",t.proxy(function(e){var i=e.which;if(this.browser.mozilla&&!this.isHTML&&8==i){var n=t(this.getSelectionElement());this.valid_nodes.indexOf(n.get(0).tagName)>=0&&1==n.find("*").length&&""===n.text()&&1==n.find("br").length&&this.setSelection(n.get(0))}},this))},t.Editable.prototype.insertSpace=function(){this.browser.mozilla&&this.$element.on("keypress",t.proxy(function(t){var e=t.which,i=this.getSelectionElements()[0];this.isHTML||32!=e||"PRE"==i.tagName||(t.preventDefault(),this.insertSimpleHTML("&nbsp;"))},this))},t.Editable.prototype.cleanBR=function(){this.$element.on("keyup",t.proxy(function(){this.$element.find(this.valid_nodes.join(",")).each(t.proxy(function(e,i){if(["TH","TD","LI"].indexOf(i.tagName)>=0)return!0;var n=i.childNodes,r=null;if(!n.length||"BR"!=n[n.length-1].tagName)return!0;r=n[n.length-1];var a=r.previousSibling;a&&"BR"!=a.tagName&&t(r).parent().text().length>0&&this.valid_nodes.indexOf(a.tagName)<0&&t(r).remove()},this))},this))},t.Editable.prototype.replaceU200B=function(e){for(var i=0;i<e.length;i++)3==e[i].nodeType&&/\u200B/gi.test(e[i].textContent)?e[i].textContent=e[i].textContent.replace(/\u200B/gi,""):1==e[i].nodeType&&this.replaceU200B(t(e[i]).contents())},t.Editable.prototype.cleanInvisibleSpace=function(){var e=function(e){var i=t(e).text();return e&&/\u200B/.test(t(e).text())&&i.replace(/\u200B/gi,"").length>0?!0:!1};this.$element.on("keyup",t.proxy(function(){var i=this.getSelectionElement();e(i)&&0===t(i).find("li").length&&(this.saveSelectionByMarkers(),this.replaceU200B(t(i).contents()),this.restoreSelectionByMarkers())},this))},t.Editable.prototype.fixHR=function(){this.$element.on("keypress",t.proxy(function(e){var i=t(this.getSelectionElement());if(i.is("hr")||i.parents("hr").length)return!1;var n=e.which;if(8==n){var r=t(this.getSelectionElements()[0]);r.prev().is("hr")&&this.getSelectionTextInfo(r.get(0)).atStart&&(this.saveSelectionByMarkers(),r.prev().remove(),this.restoreSelectionByMarkers(),e.preventDefault())}},this))},t.Editable.prototype.backspaceEmpty=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;!this.isHTML&&8==e&&this.$element.hasClass("f-placeholder")&&t.preventDefault()},this))},t.Editable.prototype.domInsert=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;13===e&&(this.add_br=!0)},this)),this.$element.on("DOMNodeInserted",t.proxy(function(e){if("SPAN"!==e.target.tagName||t(e.target).attr("data-fr-verified")||this.no_verify||this.textEmpty(e.target)||t(e.target).replaceWith(t(e.target).contents()),"BR"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("type")},0),"A"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("_moz_dirty")},0),this.options.paragraphy&&this.add_br&&"BR"===e.target.tagName&&(t(e.target).prev().length&&"TABLE"===t(e.target).prev().get(0).tagName||t(e.target).next().length&&"TABLE"===t(e.target).next().get(0).tagName)){t(e.target).wrap('<p class="fr-p-wrap">');var i=this.$element.find("p.fr-p-wrap").removeAttr("class");this.setSelection(i.get(0))}"BR"===e.target.tagName&&this.isLastSibling(e.target)&&"LI"==e.target.parentNode.tagName&&this.textEmpty(e.target.parentNode)&&t(e.target).remove()},this)),this.$element.on("keyup",t.proxy(function(t){var e=t.which;8===e&&this.$element.find("span:not([data-fr-verified])").attr("data-fr-verified",!0),13===e&&(this.add_br=!1)},this))},t.Editable.prototype.fixIME=function(){try{this.$element.get(0).msGetInputContext&&(this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowShow",t.proxy(function(){this.ime=!0},this)),this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowHide",t.proxy(function(){this.ime=!1,this.$element.trigger("keydown"),this.oldHTML=""},this)))}catch(e){}}}(jQuery),function(t){t.Editable.prototype.handleEnter=function(){var e=t.proxy(function(){var e=this.getSelectionElement();return"LI"==e.tagName||this.parents(t(e),"li").length>0?!0:!1},this);this.$element.on("keypress",t.proxy(function(t){if(!this.isHTML&&!e()){var i=t.which;if(13==i&&!t.shiftKey){t.preventDefault(),this.saveUndoStep(),this.insertSimpleHTML("<break></break>");var n=this.getSelectionElements();if(n[0]==this.$element.get(0)?this.enterInMainElement(n[0]):this.enterInElement(n[0]),this.getSelectionTextInfo(this.$element.get(0)).atEnd)this.$wrapper.scrollTop(this.$element.height());else{var r=this.getBoundingRect();this.$wrapper.offset().top+this.$wrapper.height()<r.top+r.height&&this.$wrapper.scrollTop(r.top+this.$wrapper.scrollTop()-(this.$wrapper.height()+this.$wrapper.offset().top)+r.height+10)}}}},this))},t.Editable.prototype.enterInMainElement=function(e){var i=t(e).find("break").get(0);if(t(i).parent().get(0)==e)this.isLastSibling(i)?this.insertSimpleHTML("</br>"+this.markers_html+this.br):t(e).hasClass("f-placeholder")?t(e).html("</br>"+this.markers_html+this.br):this.insertSimpleHTML("</br>"+this.markers_html),t(e).find("break").remove(),this.restoreSelectionByMarkers();else if(t(i).parents(this.$element).length){for(e=this.getSelectionElement();"BREAK"==e.tagName||0===t(e).text().length&&e.parentNode!=this.$element.get(0);)e=e.parentNode;if(this.getSelectionTextInfo(e).atEnd)t(e).after(this.breakEnd(this.getDeepParent(e),!0)),this.$element.find("break").remove(),this.restoreSelectionByMarkers();else if(this.getSelectionTextInfo(e).atStart){for(;i.parentNode!=this.$element.get(0);)i=i.parentNode;t(i).before("<br/>"),this.$element.find("break").remove(),this.$element.find("a:empty").replaceWith(this.markers_html+"<br/>"),this.restoreSelectionByMarkers()}else this.breakMiddle(this.getDeepParent(e),!0),this.restoreSelectionByMarkers()}else t(i).remove()},t.Editable.prototype.enterInElement=function(e){if(["TD","TH"].indexOf(e.tagName)<0){var i=!1;if(this.emptyElement(e)&&e.parentNode&&"BLOCKQUOTE"==e.parentNode.tagName){t(e).before(this.$element.find("break"));var n=e;e=e.parentNode,t(n).remove(),i=!0}this.getSelectionTextInfo(e).atEnd?(t(e).after(this.breakEnd(e),!1),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):this.getSelectionTextInfo(e).atStart?(this.options.paragraphy?i?(t(e).before("<"+this.options.defaultTag+">"+this.markers_html+this.br+"</"+this.options.defaultTag+">"),this.restoreSelectionByMarkers()):t(e).before("<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">"):i?(t(e).before(this.markers_html+"<br/>"),this.restoreSelectionByMarkers()):t(e).before("<br/>"),this.$element.find("break").remove()):"PRE"==e.tagName?(this.$element.find("break").after("<br/>"+this.markers_html),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):(this.breakMiddle(e,!1,i),this.restoreSelectionByMarkers())}else this.enterInMainElement(e)},t.Editable.prototype.breakEnd=function(e,i){if(void 0===i&&(i=!1),"BLOCKQUOTE"==e.tagName){var n=t(e).contents();n.length&&"BR"==n[n.length-1].tagName&&t(n[n.length-1]).remove()}var r=t(e).find("break").get(0),a=this.br;this.options.paragraphy||(a="<br/>");var o=this.markers_html+a;for(i&&(o=this.markers_html+t.Editable.INVISIBLE_SPACE);r!=e;)"A"!=r.tagName&&"BREAK"!=r.tagName&&(o="<"+r.tagName+this.attrs(r)+">"+o+"</"+r.tagName+">"),r=r.parentNode;return i&&"A"!=r.tagName&&"BREAK"!=r.tagName&&(o="<"+r.tagName+this.attrs(r)+">"+o+"</"+r.tagName+">"),this.options.paragraphy&&(o="<"+this.options.defaultTag+">"+o+"</"+this.options.defaultTag+">"),i&&(o=a+o),o},t.Editable.prototype.breakMiddle=function(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t(e).find("break").get(0),a=this.markers_html;n&&(a="");for(var o="";r!=e;)r=r.parentNode,o=o+"</"+r.tagName+">",a="<"+r.tagName+this.attrs(r)+">"+a;var s="";n&&(s=this.options.paragraphy?"<"+this.options.defaultTag+">"+this.markers_html+"<br/></"+this.options.defaultTag+">":this.markers_html+"<br/>");var l="<"+e.tagName+this.attrs(e)+">"+t(e).html()+"</"+e.tagName+">";l=l.replace(/<break><\/break>/,o+(i?this.br:"")+s+a),t(e).replaceWith(l)}}(jQuery),function(t){t.Editable.prototype.isFirstSibling=function(t){var e=t.previousSibling;return e?3==e.nodeType&&""===e.textContent?this.isFirstSibling(e):!1:!0},t.Editable.prototype.isLastSibling=function(t){var e=t.nextSibling;return e?3==e.nodeType&&""===e.textContent?this.isLastSibling(e):!1:!0},t.Editable.prototype.getDeepParent=function(t){return t.parentNode==this.$element.get(0)?t:this.getDeepParent(t.parentNode)},t.Editable.prototype.attrs=function(t){for(var e="",i=t.attributes,n=0;n<i.length;n++){var r=i[n];e+=" "+r.nodeName+'="'+r.value+'"'}return e}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){function i(t){function e(){n?(i(),P(e),r=!0,n=!1):r=!1}var i=t,n=!1,r=!1;this.kick=function(){n=!0,r||e()},this.end=function(t){var e=i;t&&(r?(i=n?function(){e(),t()}:t,n=!0):t())}}function n(){return!0}function r(){return!1}function a(t){t.preventDefault()}function o(t){F[t.target.tagName.toLowerCase()]||t.preventDefault()}function s(t){return 1===t.which&&!t.ctrlKey&&!t.altKey}function l(t,e){var i,n;if(t.identifiedTouch)return t.identifiedTouch(e);for(i=-1,n=t.length;++i<n;)if(t[i].identifier===e)return t[i]}function d(t,e){var i=l(t.changedTouches,e.identifier);return!i||i.pageX===e.pageX&&i.pageY===e.pageY?void 0:i}function h(t){var e;s(t)&&(e={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:t.timeStamp},M(document,U.move,p,e),M(document,U.cancel,c,e))}function p(t){var e=t.data;b(t,e,t,u)}function c(){u()}function u(){B(document,U.move,p),B(document,U.cancel,c)}function f(t){var e,i;F[t.target.tagName.toLowerCase()]||(e=t.changedTouches[0],i={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:t.timeStamp,identifier:e.identifier},M(document,H.move+"."+e.identifier,m,i),M(document,H.cancel+"."+e.identifier,g,i))}function m(t){var e=t.data,i=d(t,e);i&&b(t,e,i,v)}function g(t){var e=t.data,i=l(t.changedTouches,e.identifier);i&&v(e.identifier)}function v(t){B(document,"."+t,m),B(document,"."+t,g)}function b(t,e,i,n){var r=i.pageX-e.startX,a=i.pageY-e.startY;D*D>r*r+a*a||E(t,e,i,r,a,n)}function y(){return this._handled=n,!1}function w(t){try{t._handled()}catch(e){return!1}}function E(t,e,i,n,r,a){var o,s;e.target,o=t.targetTouches,s=t.timeStamp-e.timeStamp,e.type="movestart",e.distX=n,e.distY=r,e.deltaX=n,e.deltaY=r,e.pageX=i.pageX,e.pageY=i.pageY,e.velocityX=n/s,e.velocityY=r/s,e.targetTouches=o,e.finger=o?o.length:1,e._handled=y,e._preventTouchmoveDefault=function(){t.preventDefault()},O(e.target,e),a(e.identifier)}function $(t){var e=t.data.timer;t.data.touch=t,t.data.timeStamp=t.timeStamp,e.kick()}function k(t){var e=t.data.event,i=t.data.timer;_(),I(e,i,function(){setTimeout(function(){B(e.target,"click",r)},0)})}function _(){B(document,U.move,$),B(document,U.end,k)}function x(t){var e=t.data.event,i=t.data.timer,n=d(t,e);n&&(t.preventDefault(),e.targetTouches=t.targetTouches,t.data.touch=n,t.data.timeStamp=t.timeStamp,i.kick())}function C(t){var e=t.data.event,i=t.data.timer,n=l(t.changedTouches,e.identifier);n&&(T(e),I(e,i))}function T(t){B(document,"."+t.identifier,x),B(document,"."+t.identifier,C)}function S(t,e,i){var n=i-t.timeStamp;t.type="move",t.distX=e.pageX-t.startX,t.distY=e.pageY-t.startY,t.deltaX=e.pageX-t.pageX,t.deltaY=e.pageY-t.pageY,t.velocityX=.3*t.velocityX+.7*t.deltaX/n,t.velocityY=.3*t.velocityY+.7*t.deltaY/n,t.pageX=e.pageX,t.pageY=e.pageY}function I(t,e,i){e.end(function(){return t.type="moveend",O(t.target,t),i&&i()})}function L(){return M(this,"movestart.move",w),!0}function A(){return B(this,"dragstart drag",a),B(this,"mousedown touchstart",o),B(this,"movestart",w),!0}function N(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(M(this,"dragstart."+t.guid+" drag."+t.guid,a,e,t.selector),M(this,"mousedown."+t.guid,o,e,t.selector))}function R(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(B(this,"dragstart."+t.guid+" drag."+t.guid),B(this,"mousedown."+t.guid))}var D=6,M=t.event.add,B=t.event.remove,O=function(e,i,n){t.event.trigger(i,n,e)},P=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t()},25)}}(),F={textarea:!0,input:!0,select:!0,button:!0},U={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},H={move:"touchmove",cancel:"touchend",end:"touchend"};t.event.special.movestart={setup:L,teardown:A,add:N,remove:R,_default:function(t){function n(){S(a,o.touch,o.timeStamp),O(t.target,a)}var a,o;t._handled()&&(a={target:t.target,startX:t.startX,startY:t.startY,pageX:t.pageX,pageY:t.pageY,distX:t.distX,distY:t.distY,deltaX:t.deltaX,deltaY:t.deltaY,velocityX:t.velocityX,velocityY:t.velocityY,timeStamp:t.timeStamp,identifier:t.identifier,targetTouches:t.targetTouches,finger:t.finger},o={event:a,timer:new i(n),touch:e,timeStamp:e},t.identifier===e?(M(t.target,"click",r),M(document,U.move,$,o),M(document,U.end,k,o)):(t._preventTouchmoveDefault(),M(document,H.move+"."+t.identifier,x,o),M(document,H.end+"."+t.identifier,C,o)))}},t.event.special.move={setup:function(){M(this,"movestart.move",t.noop)},teardown:function(){B(this,"movestart.move",t.noop)}},t.event.special.moveend={setup:function(){M(this,"movestart.moveend",t.noop)},teardown:function(){B(this,"movestart.moveend",t.noop)}},M(document,"mousedown.move",h),M(document,"touchstart.move",f),"function"==typeof Array.prototype.indexOf&&!function(t){for(var e=["changedTouches","targetTouches"],i=e.length;i--;)-1===t.event.props.indexOf(e[i])&&t.event.props.push(e[i])}(t)}),window.WYSIWYGModernizr=function(t,e,i){function n(t){u.cssText=t}function r(t,e){return typeof t===e}var a,o,s,l="2.7.1",d={},h=e.documentElement,p="modernizr",c=e.createElement(p),u=c.style,f=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),m={},g=[],v=g.slice,b=function(t,i,n,r){var a,o,s,l,d=e.createElement("div"),c=e.body,u=c||e.createElement("body");if(parseInt(n,10))for(;n--;)s=e.createElement("div"),s.id=r?r[n]:p+(n+1),d.appendChild(s);return a=["&#173;",'<style id="s',p,'">',t,"</style>"].join(""),d.id=p,(c?d:u).innerHTML+=a,u.appendChild(d),c||(u.style.background="",u.style.overflow="hidden",l=h.style.overflow,h.style.overflow="hidden",h.appendChild(u)),o=i(d,t),c?d.parentNode.removeChild(d):(u.parentNode.removeChild(u),h.style.overflow=l),!!o},y=function(e){var i=t.matchMedia||t.msMatchMedia;if(i)return i(e).matches;var n;return b("@media "+e+" { #"+p+" { position: absolute; } }",function(e){n="absolute"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).position}),n},w={}.hasOwnProperty;s=r(w,"undefined")||r(w.call,"undefined")?function(t,e){return e in t&&r(t.constructor.prototype[e],"undefined")}:function(t,e){return w.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=v.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=e.prototype;var a=new r,o=e.apply(a,i.concat(v.call(arguments)));return Object(o)===o?o:a}return e.apply(t,i.concat(v.call(arguments)))};return n}),m.touch=function(){var i;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?i=!0:b(["@media (",f.join("touch-enabled),("),p,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){i=9===t.offsetTop}),i};for(var E in m)s(m,E)&&(o=E.toLowerCase(),d[o]=m[E](),g.push((d[o]?"":"no-")+o));return d.addTest=function(t,e){if("object"==typeof t)for(var n in t)s(t,n)&&d.addTest(n,t[n]);else{if(t=t.toLowerCase(),d[t]!==i)return d;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(h.className+=" "+(e?"":"no-")+t),d[t]=e}return d},n(""),c=a=null,d._version=l,d._prefixes=f,d.mq=y,d.testStyles=b,d}(this,document),!function(t){t.Editable.prototype.coreInit=function(){var t=this,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=function(t){for(var e=t.toString(),i=0,n=0;n<e.length;n++)i+=parseInt(e.charAt(n),10);return i>10?i%9+1:i};if(t.options.key!==!1){var n=function(t,e,i){for(var n=Math.abs(i);n-->0;)t-=e;return 0>i&&(t+=123),t},r=function(t){return t},a=function(t){if(!t)return t;for(var a="",o=r("charCodeAt"),s=r("fromCharCode"),l=e.indexOf(t[0]),d=1;d<t.length-2;d++){for(var h=i(++l),p=t[o](d),c="";/[0-9-]/.test(t[d+1]);)c+=t[++d];c=parseInt(c,10)||0,p=n(p,h,c),p^=l-1&31,a+=String[s](p)}return a},o=r(a),s=function(t){return"none"==t.css("display")?(t.attr("style",t.attr("style")+o("zD4D2qJ-7dhuB-11bB4E1wqlhlfE4gjhkbB6C5eg1C-8h1besB-16e1==")),!0):!1},l=function(){for(var t=0,e=document.domain,i=e.split("."),n="_gd"+(new Date).getTime();t<i.length-1&&-1==document.cookie.indexOf(n+"="+n);)e=i.slice(-1-++t).join("."),document.cookie=n+"="+n+";domain="+e+";";return document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+e+";",e}(),d=function(){var e=o(t.options.key)||"";return e!==o("eQZMe1NJGC1HTMVANU==")&&e.indexOf(l,e.length-l.length)<0&&[o("9qqG-7amjlwq=="),o("KA3B3C2A6D1D5H5H1A3==")].indexOf(l)<0?(t.$box.append(o("uA5kygD3g1h1lzrA7E2jtotjvooB2A5eguhdC-22C-16nC2B3lh1deA-21C-16B4A2B4gi1F4D1wyA-13jA4H5C2rA-65A1C10dhzmoyJ2A10A-21d1B-13xvC2I4enC4C2B5B4G4G4H1H4A10aA8jqacD1C3c1B-16D-13A-13B2E5A4jtxfB-13fA1pewxvzA3E-11qrB4E4qwB-16icA1B3ykohde1hF4A2E4clA4C7E6haA4D1xtmolf1F-10A1H4lhkagoD5naalB-22B8B4quvB-8pjvouxB3A-9plnpA2B6D6BD2D1C2H1C3C3A4mf1G-10C-8i1G3C5B3pqB-9E5B1oyejA3ddalvdrnggE3C3bbj1jC6B3D3gugqrlD8B2DB-9qC-7qkA10D2VjiodmgynhA4HA-9D-8pI-7rD4PrE-11lvhE3B5A-16C7A6A3ekuD1==")),t.$lb=t.$box.find("> div:last"),t.$ab=t.$lb.find("> a"),s(t.$lb)||s(t.$ab)):void 0};d()}},t.Editable.initializers.push(t.Editable.prototype.coreInit)}(jQuery),function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedBlankTags:["TEXTAREA"],selfClosingTags:["br","input","img","hr","param","!--","source","embed","!","meta","link","base"],doNotJoinTags:["a"],iconClasses:["fa-"]}),t.Editable.prototype.isClosingTag=function(t){return t?null!==t.match(/^<\/([a-zA-Z0-9]+)([^<]+)*>$/gi):!1},t.Editable.prototype.tagName=function(t){return t.replace(/^<\/?([a-zA-Z0-9-!]+)([^>]+)*>$/gi,"$1").toLowerCase()},t.Editable.SELF_CLOSING_AFTER=["source"],t.Editable.prototype.isSelfClosingTag=function(t){var e=this.tagName(t);return this.options.selfClosingTags.indexOf(e.toLowerCase())>=0},t.Editable.prototype.tagKey=function(t){return t.type+(t.attrs||[]).sort().join("|")},t.Editable.prototype.extendedKey=function(t){return this.tagKey(t)+JSON.stringify(t.style)},t.Editable.prototype.mapDOM=function(e){var i=[],n={},r={},a=0,o=this;t(e).find(".f-marker").html(t.Editable.INVISIBLE_SPACE);var s=function(e,i){if(3===e.nodeType)return[];if(8===e.nodeType)return[{comment:!0,attrs:{},styles:{},idx:a++,sp:i,ep:i,text:e.textContent}];var n=e.tagName;"B"==n&&(n="STRONG"),"I"!=n||e.className&&null!=e.className.match(new RegExp(o.options.iconClasses.join("|"),"gi"))||(n="EM");var r={},s={},l=null;if(e.attributes)for(var d=0;d<e.attributes.length;d++){var h=e.attributes[d];"style"==h.nodeName?l=h.value:r[h.nodeName]=h.value}if(l){var p=l.match(/([^:]*):([^:;]*(;|$))/gi);if(p)for(var c=0;c<p.length;c++){var u=p[c].split(":"),f=u.slice(1).join(":").trim();";"==f[f.length-1]&&(f=f.substr(0,f.length-1)),s[u[0].trim()]=f}}var m=[];if(t.isEmptyObject(r)&&"SPAN"==e.tagName&&!t.isEmptyObject(s)){for(var g in s){var v={};v[g]=s[g],m.push({selfClosing:!1,attrs:r,styles:v,idx:a++,sp:i,ep:i+e.textContent.length,tagName:n,noJoin:e.nextSibling&&"BR"===e.nextSibling.tagName})}return m}return[{selfClosing:o.options.selfClosingTags.indexOf(n.toLowerCase())>=0,attrs:r,styles:s,idx:a++,sp:i,ep:i+e.textContent.length,tagName:n,noJoin:e.nextSibling&&"BR"===e.nextSibling.tagName}]},l=function(t,o){var d,h,p;if(t!=e)for(h=s(t,o),d=0;d<h.length;d++)p=h[d],i.push(p),n[p.sp]||(n[p.sp]={}),r[p.ep]||(r[p.ep]={}),n[p.sp][p.tagName]||(n[p.sp][p.tagName]=[]),r[p.ep][p.tagName]||(r[p.ep][p.tagName]=[]),n[p.sp][p.tagName].push(p),r[p.ep][p.tagName].push(p);var c=t.childNodes;if(c){for(d=0;d<c.length;d++)d>0&&8!=c[d-1].nodeType&&(o+=c[d-1].textContent.length),l(c[d],o);if(h)for(d=0;d<h.length;d++)p=h[d],p.ci=a++,n[p.ep]||(n[p.ep]={}),n[p.ep][p.tagName]||(n[p.ep][p.tagName]=[]),n[p.ep][p.tagName].push({shadow:!0,ci:a-1})}},d=function(){var e,r,a,s;for(e in n)for(var l in n[e])for(a=0;a<n[e][l].length;a++)if(r=n[e][l][a],!r.selfClosing&&!(r.dirty||r.shadow||r.comment||r.noJoin))for(var d=a+1;d<n[e][l].length;d++)if(s=n[e][l][d],!s.selfClosing&&!(s.dirty||s.shadow||s.comment||s.noJoin||1!=Object.keys(r.styles).length||1!=Object.keys(s.styles).length||s.sp==s.ep)){var h=Object.keys(r.styles)[0];if(s.styles[h]){r.sp=s.ep;for(var p=0;p<n[r.sp][r.tagName].length;p++){var c=n[r.sp][r.tagName][p];if(c.shadow&&c.ci==s.ci){n[r.sp][r.tagName].splice(p,0,r);break}}n[e][l].splice(a,1),a--;break}}for(e=0;e<i.length;e++)if(r=i[e],!(r.dirty||r.selfClosing||r.comment||r.noJoin||r.shadow||o.options.doNotJoinTags.indexOf(r.tagName.toLowerCase())>=0||!t.isEmptyObject(r.attrs)))if(r.sp==r.ep&&t.isEmptyObject(r.attrs)&&t.isEmptyObject(r.styles)&&o.options.allowedBlankTags.indexOf(r.tagName)<0)r.dirty=!0;else if(n[r.ep]&&n[r.ep][r.tagName])for(a=0;a<n[r.ep][r.tagName].length;a++)if(s=n[r.ep][r.tagName][a],r!=s&&!(s.dirty||s.selfClosing||s.shadow||s.comment||s.noJoin||!t.isEmptyObject(s.attrs)||JSON.stringify(s.styles)!=JSON.stringify(r.styles))){r.ep<s.ep&&(r.ep=s.ep),r.sp>s.sp&&(r.sp=s.sp),s.dirty=!0,e--;break}for(e=0;e<i.length;e++)if(r=i[e],!(r.dirty||r.selfClosing||r.comment||r.noJoin||r.shadow||!t.isEmptyObject(r.attrs)))if(r.sp==r.ep&&t.isEmptyObject(r.attrs)&&t.isEmptyObject(r.style)&&o.options.allowedBlankTags.indexOf(r.tagName)<0)r.dirty=!0;else if(n[r.sp]&&n[r.sp][r.tagName])for(a=n[r.sp][r.tagName].length-1;a>=0;a--)s=n[r.sp][r.tagName][a],r!=s&&(s.dirty||s.selfClosing||s.shadow||s.comment||s.noJoin||r.ep==s.ep&&t.isEmptyObject(s.attrs)&&(r.styles=t.extend(r.styles,s.styles),s.dirty=!0))};l(e,0),d();for(var h=i.length-1;h>=0;h--)i.dirty&&i.splice(h,1);return i},t.Editable.prototype.sortNodes=function(t,e){if(t.comment)return 1;if(t.selfClosing||e.selfClosing)return t.idx-e.idx;var i=t.ep-t.sp,n=e.ep-e.sp;return 0===i&&0===n?t.idx-e.idx:i===n?e.ci-t.ci:n-i},t.Editable.prototype.openTag=function(t){var e,i="<"+t.tagName.toLowerCase(),n=Object.keys(t.attrs).sort();for(e=0;e<n.length;e++){var r=n[e];i+=" "+r+'="'+t.attrs[r]+'"'}var a="",o=Object.keys(t.styles).sort();for(e=0;e<o.length;e++){var s=o[e];null!=t.styles[s]&&(a+=s.replace("_","-")+": "+t.styles[s]+"; ")}return""!==a&&(i+=' style="'+a.trim()+'"'),i+=">"},t.Editable.prototype.commentTag=function(t){var e="";if(t.selfClosing){var i;e="<"+t.tagName.toLowerCase();var n=Object.keys(t.attrs).sort();for(i=0;i<n.length;i++){var r=n[i];e+=" "+r+'="'+t.attrs[r]+'"'}var a="",o=Object.keys(t.styles).sort();for(i=0;i<o.length;i++){var s=o[i];null!=t.styles[s]&&(a+=s.replace("_","-")+": "+t.styles[s]+"; ")}""!==a&&(e+=' style="'+a.trim()+'"'),e+="/>"}else t.comment&&(e="<!--"+t.text+"-->");return e},t.Editable.prototype.closeTag=function(t){return"</"+t.tagName.toLowerCase()+">"},t.Editable.prototype.nodesOpenedAt=function(t,e){for(var i=[],n=t.length-1;n>=0&&t[n].sp==e;)i.push(t.pop()),n--;return i},t.Editable.prototype.entity=function(t){return ch_map={">":"&gt;","<":"&lt;","&":"&amp;"},ch_map[t]?ch_map[t]:t},t.Editable.prototype.removeInvisibleWhitespace=function(t){for(var e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];i.childNodes.length?this.removeInvisibleWhitespace(i):i.textContent=i.textContent.replace(/\u200B/gi,"")}},t.Editable.prototype.cleanOutput=function(e,i){var n,r,a,o;i&&this.removeInvisibleWhitespace(e);var s=this.mapDOM(e,i).sort(function(t,e){return e.sp-t.sp}),l=e.textContent;html="";var d=[],h=-1,p=t.proxy(function(){var e="";for(simple_nodes_to_close=[],d=d.sort(function(t,e){return t.idx-e.idx}).reverse();d.length;){for(var i=d.pop();simple_nodes_to_close.length&&simple_nodes_to_close[simple_nodes_to_close.length-1].ci<i.ci;)e+=this.closeTag(simple_nodes_to_close.pop());i.selfClosing||i.comment?e+=this.commentTag(i):(!t.isEmptyObject(i.attrs)||this.options.allowedBlankTags.indexOf(i.tagName)>=0)&&(e+=this.openTag(i),simple_nodes_to_close.push(i))}for(;simple_nodes_to_close.length;)e+=this.closeTag(simple_nodes_to_close.pop());html+=e},this),c={},u=[];for(n=0;n<=l.length;n++){if(c[n])for(r=c[n].length-1;r>=0;r--)if(u.length&&u[u.length-1].tagName==c[n][r].tagName&&JSON.stringify(u[u.length-1].styles)==JSON.stringify(c[n][r].styles))html+=this.closeTag(c[n][r]),u.pop();else{for(var f=[];u.length&&(u[u.length-1].tagName!==c[n][r].tagName||JSON.stringify(u[u.length-1].styles)!==JSON.stringify(c[n][r].styles));)o=u.pop(),html+=this.closeTag(o),f.push(o);for(html+=this.closeTag(c[n][r]),u.pop();f.length;){var m=f.pop();html+=this.openTag(m),u.push(m)}}for(var g=this.nodesOpenedAt(s,n).sort(this.sortNodes).reverse();g.length;){var v=g.pop();if(!v.dirty)if(v.selfClosing||v.comment)v.ci>h||"BR"==v.tagName?(p(),html+=this.commentTag(v),h=v.ci):d.length?(d.push(v),h<v.ci&&(h=v.ci)):(html+=this.commentTag(v),h<v.ci&&(h=v.ci));else if(v.ep>v.sp){v.ci>h&&p();var b=[];if("A"==v.tagName)for(var y=v.sp+1;y<v.ep;y++)if(c[y]&&c[y].length)for(a=0;a<c[y].length;a++)b.push(c[y][a]),html+=this.closeTag(c[y][a]),u.pop();var w=[];if("SPAN"==v.tagName&&("#123456"==v.styles["background-color"]||"#123456"===t.Editable.RGBToHex(v.styles["background-color"])||"#123456"==v.styles.color||"#123456"===t.Editable.RGBToHex(v.styles.color)))for(;u.length;){var E=u.pop();html+=this.closeTag(E),w.push(E)}for(html+=this.openTag(v),h<v.ci&&(h=v.ci),u.push(v),c[v.ep]||(c[v.ep]=[]),c[v.ep].push(v);b.length;)v=b.pop(),html+=this.openTag(v),u.push(v);for(;w.length;)v=w.pop(),html+=this.openTag(v),u.push(v)}else v.sp==v.ep&&(d.push(v),h<v.ci&&(h=v.ci))}p(),n!=l.length&&(html+=this.entity(l[n]))}return html=html.replace(/(<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>)\u200B(<\/span>)/gi,"$1$2"),html},t.Editable.prototype.wrapDirectContent=function(){var e=t.merge(["UL","OL","TABLE"],this.valid_nodes);if(!this.options.paragraphy)for(var i=null,n=this.$element.contents(),r=0;r<n.length;r++)1!=n[r].nodeType||e.indexOf(n[r].tagName)<0?(i||(i=t('<div class="fr-wrap">'),t(n[r]).before(i)),i.append(n[r])):i=null},t.Editable.prototype.cleanify=function(e,i,n){if(this.browser.msie&&t.Editable.getIEversion()<9)return!1;var r;if(this.isHTML)return!1;void 0===e&&(e=!0),void 0===n&&(n=!0),this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),n&&this.saveSelectionByMarkers(),e?r=this.getSelectionElements():(this.wrapDirectContent(),r=this.$element.find(this.valid_nodes.join(",")),0===r.length&&(r=[this.$element.get(0)]));var a,o;if(r[0]!=this.$element.get(0))for(var s=0;s<r.length;s++){var l=t(r[s]);0===l.find(this.valid_nodes.join(",")).length&&(a=l.html(),o=this.cleanOutput(l.get(0),i),o!==a&&l.html(o))}else 0===this.$element.find(this.valid_nodes.join(",")).length&&(a=this.$element.html(),o=this.cleanOutput(this.$element.get(0),i),o!==a&&this.$element.html(o));this.$element.find("[data-fr-idx]").removeAttr("data-fr-idx"),this.$element.find(".fr-wrap").each(function(){t(this).replaceWith(t(this).html())}),this.$element.find(".f-marker").html(""),n&&this.restoreSelectionByMarkers(),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1}}(jQuery),!function(t){t.Editable.prototype.refreshBlockStyles=function(){var e=this.getSelectionElements()[0],i=e.tagName.toLowerCase();this.$bttn_wrapper.find(".fr-block-style").empty();var n=this.options.blockStyles[i];if(void 0===n&&(n=this.options.defaultBlockStyle),void 0!==n){this.$bttn_wrapper.find('.fr-dropdown > button[data-name="blockStyle"].fr-trigger').removeAttr("disabled");for(var r in n){var a=n[r],o="";t(e).hasClass(r)&&(o=' class="active"'),this.$bttn_wrapper.find(".fr-block-style").append(t("<li"+o+">").append(t('<a href="#" data-text="true">').text(a).addClass(r)).attr("data-cmd","blockStyle").attr("data-val",r))}}},t.Editable.commands=t.extend(t.Editable.commands,{blockStyle:{title:"Block Style",icon:"fa fa-magic",refreshOnShow:t.Editable.prototype.refreshBlockStyles,callback:function(t,e,i){this.blockStyle(e,i)},undo:!0}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{defaultBlockStyle:{"f-italic":"Italic","f-typewriter":"Typewriter","f-spaced":"Spaced","f-uppercase":"Uppercase"},blockStylesToggle:!0,blockStyles:{}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{blockStyle:function(t){var e=this.buildDropdownBlockStyle(t),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownBlockStyle=function(){var t='<ul class="fr-dropdown-menu fr-block-style">';return t+="</ul>"},t.Editable.prototype.blockStyle=function(e){this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var i=this.getSelectionElements()[0].tagName;this.saveSelectionByMarkers();for(var n=this.getSelectionElements(),r=0;r<n.length;r++){var a=n[r];a!=this.$element.get(0)&&a.tagName==i&&(t(a).find(n).length>0||(t(a).hasClass(e)?(t(a).removeClass(e),""===t(a).attr("class")&&t(a).removeAttr("class")):(this.options.blockStylesToggle&&t(a).removeAttr("class"),t(a).addClass(e))))}this.cleanupLists(),this.restoreSelectionByMarkers(),this.triggerEvent("blockStyle")}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{maxCharacters:-1,countCharacters:!0}),t.Editable.prototype.validKeyCode=function(t,e){return e?!1:t>47&&58>t||32==t||13==t||t>64&&91>t||t>95&&112>t||t>185&&193>t||t>218&&223>t},t.Editable.prototype.charNumber=function(){return this.getText().length},t.Editable.prototype.checkCharNumber=function(t,e,i){if(e.options.maxCharacters<0)return!0;if(e.charNumber()<e.options.maxCharacters)return!0;var n=i.which,r=(i.ctrlKey||i.metaKey)&&!i.altKey;return e.validKeyCode(n,r)?(e.triggerEvent("maxCharNumberExceeded",[],!1),!1):!0},t.Editable.prototype.checkCharNumberOnPaste=function(e,i,n){if(i.options.maxCharacters<0)return!0;var r=t("<div>").html(n).text().length;return r+i.charNumber()<=i.options.maxCharacters?n:(i.triggerEvent("maxCharNumberExceeded",[],!1),"")},t.Editable.prototype.updateCharNumber=function(t,e){if(e.options.countCharacters){var i=e.charNumber()+(e.options.maxCharacters>0?"/"+e.options.maxCharacters:"");e.$box.attr("data-chars",i)}},t.Editable.prototype.initCharNumber=function(){this.$original_element.on("editable.keydown",this.checkCharNumber),this.$original_element.on("editable.afterPasteCleanup",this.checkCharNumberOnPaste),this.$original_element.on("editable.keyup",this.updateCharNumber),this.$original_element.on("editable.contentChanged",this.updateCharNumber),this.updateCharNumber(null,this)},t.Editable.initializers.push(t.Editable.prototype.initCharNumber)}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{colors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorGroups:[{text:"Text",cmd:"foreColor"},{text:"Background",cmd:"backColor"}],defaultColorGroup:"foreColor"}),t.Editable.prototype.refreshColors=function(){var t=this.getSelectionElement();this.$editor.find(".fr-color-picker button.fr-color-bttn").removeClass("active"),this.refreshColor(t,"background-color","backColor"),
this.refreshColor(t,"color","foreColor")},t.Editable.prototype.refreshColor=function(e,i,n){for(;t(e).get(0)!=this.$element.get(0);){if("transparent"!==t(e).css(i)&&"rgba(0, 0, 0, 0)"!==t(e).css(i)){this.$editor.find('.fr-color-picker button.fr-color-bttn[data-param="'+n+'"][data-val="'+t.Editable.RGBToHex(t(e).css(i))+'"]').addClass("active");break}e=t(e).parent()}},t.Editable.commands=t.extend(t.Editable.commands,{color:{icon:"fa fa-tint",title:"Color",refreshOnShow:t.Editable.prototype.refreshColors,callback:function(t,e,i){this[i].apply(this,[e])},callbackWithoutSelection:function(e,i,n){"backColor"===n&&(n="background-color"),"foreColor"===n&&(n="color"),this._startInFontExec(n,e,i),"#123456"===i&&""===this.text()&&(this.cleanify(!0,!1),this.$element.find("span").each(function(e,i){var n=t(i),r=n.css("background-color");("#123456"===r||"#123456"===t.Editable.RGBToHex(r))&&n.css("background-color",""),r=n.css("color"),("#123456"===r||"#123456"===t.Editable.RGBToHex(r))&&n.css("color","")}))},undo:!0}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{color:function(t){var e=this.buildDropdownColor(t),i=this.buildDropdownButton(t,e,"fr-color-picker");return i}}),t.Editable.prototype.buildColorList=function(t,e){for(var i=this.options.defaultColorGroup==t?"block":"none",n='<div class="fr-color-set fr-'+t+'" style="display: '+i+'">',r=0;r<e.length;r++){var a=e[r];n+="REMOVE"!==a?'<button type="button" class="fr-color-bttn" data-val="'+a+'" data-cmd="color" data-param="'+t+'" style="background: '+a+';">&nbsp;</button>':'<button type="button" class="fr-color-bttn" data-val="#123456" data-cmd="color" data-param="'+t+'" style="background: #FFF;"><i class="fa fa-eraser"></i></button>',r%this.options.colorsStep==this.options.colorsStep-1&&r>0&&(n+="<hr/>",r!=this.options.colorsStep-1&&r!=2*this.options.colorsStep-1||!this.options.colorsTopChoices||(n+='<div class="separator"></div>'))}return n+="</div>"},t.Editable.prototype.buildDropdownColor=function(){for(var e="",i='<div class="fr-dropdown-menu">',n=0;n<this.options.colorGroups.length;n++)i+=this.buildColorList(this.options.colorGroups[n].cmd,this.options.colorGroups[n].colors||this.options.colors);for(i+="<p>",n=0;n<this.options.colorGroups.length;n++)e=this.options.defaultColorGroup==this.options.colorGroups[n].cmd?"active":"",i+='<span class="fr-choose-color '+e+'" data-text="true" data-param="'+this.options.colorGroups[n].cmd+'" style="width: '+100/this.options.colorGroups.length+'%;">'+this.options.colorGroups[n].text+"</span>";i+="</p></div>",this.$bttn_wrapper.on(this.mousedown,".fr-choose-color",function(t){return t.preventDefault(),t.stopPropagation(),"mousedown"===t.type&&1!==t.which?!0:void 0});var r=this;return this.$bttn_wrapper.on(this.mouseup,".fr-choose-color",function(e){if(e.preventDefault(),e.stopPropagation(),"mouseup"===e.type&&1!==e.which)return!0;var i=t(this);i.siblings().removeClass("active"),i.addClass("active"),i.parents(".fr-dropdown-menu").find("button").attr("data-param",i.attr("data-param")),i.parents(".fr-dropdown-menu").find(".fr-color-set").hide(),i.parents(".fr-dropdown-menu").find(".fr-color-set.fr-"+i.attr("data-param")).show(),r.refreshColors()}),i},t.Editable.prototype.backColor=function(e){this.inlineStyle("background-color","backColor",e),this.saveSelectionByMarkers(),this.$element.find("span").each(function(e,i){var n=t(i),r=n.css("background-color");("#123456"===r||"#123456"===t.Editable.RGBToHex(r))&&(n.css("background-color",""),n.find("span").each(function(e,i){var n=t(i);n.css("background-color",""),""!==n.attr("style")||n.hasClass("f-marker")||n.replaceWith(n.contents())})),""!==n.attr("style")||n.hasClass("f-marker")||n.replaceWith(n.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var i=this.$editor.find('button.fr-color-bttn[data-cmd="backColor"][data-val="'+e+'"]');i.addClass("active"),i.siblings().removeClass("active")},t.Editable.prototype.foreColor=function(e){this.inlineStyle("color","foreColor",e),this.saveSelectionByMarkers(),this.$element.find("span").each(function(e,i){var n=t(i),r=n.css("color");("#123456"===r||"#123456"===t.Editable.RGBToHex(r))&&(n.css("color",""),n.find("span").each(function(e,i){var n=t(i);n.css("color",""),""!==n.attr("style")||n.hasClass("f-marker")||n.replaceWith(n.contents())})),""!==n.attr("style")||n.hasClass("f-marker")||n.replaceWith(n.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var i=this.$editor.find('button.fr-color-bttn[data-cmd="foreColor"][data-val="'+e+'"]');i.addClass("active"),i.siblings().removeClass("active")}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{entities:"&quot;&apos;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;"}),t.Editable.prototype.encodeEntities=function(t,e,n){var r="";for(i=0;i<n.length;i++)if(chr=n.charAt(i),"<"==chr){var a=n.indexOf(">",i+1);if(-1!==a){var o=n.substring(i,a+1);r+=o,i=a}}else r+=e.entities_map[chr]?e.entities_map[chr]:chr;return r},t.Editable.prototype.initEntities=function(){var e=t("<div>").html(this.options.entities).text(),i=this.options.entities.split(";");this.entities_reg_exp=new RegExp(e,"g"),this.entities_map={};for(var n=0;n<e.length;n++){var r=e.charAt(n);this.entities_map[r]=i[n]+";"}this.$original_element.on("editable.getHTML",this.encodeEntities)},t.Editable.initializers.push(t.Editable.prototype.initEntities)}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{uploadFile:{title:"Upload File",icon:"fa fa-paperclip",callback:function(){this.insertFile()},undo:!1}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedFileTypes:["*"],fileDeleteUrl:null,fileDeleteParams:{},fileUploadParams:{},fileUploadURL:"http://i.froala.com/upload",fileUploadParam:"file",maxFileSize:10485760,useFileName:!0}),t.Editable.prototype.showFileWrapper=function(){this.$file_wrapper&&this.$file_wrapper.show()},t.Editable.prototype.hideFileWrapper=function(){this.$file_wrapper&&(this.$file_wrapper.hide(),this.$file_wrapper.find("input").blur())},t.Editable.prototype.showFileUpload=function(){this.hidePopups(),this.showFileWrapper()},t.Editable.prototype.insertFile=function(){this.closeImageMode(),this.imageMode=!1,this.showFileUpload(),this.saveSelectionByMarkers(),this.options.inlineMode||this.positionPopup("uploadFile")},t.Editable.prototype.fileUploadHTML=function(){var e='<div class="froala-popup froala-file-popup" style="display: none;"><h4><span data-text="true">Upload file</span><i title="Cancel" class="fa fa-times" id="f-file-close-'+this._id+'"></i></h4>';return e+='<div id="f-file-list-'+this._id+'">',e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-file-upload-div-'+this._id+'"><strong data-text="true">Drop File</strong><br>(<span data-text="true">or click</span>)<form target="file-frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.fileUploadURL+'" method="post" id="f-file-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.fileUploadParam+'" accept="/*"></form></div>',this.browser.msie&&t.Editable.getIEversion()<=9&&(e+='<iframe id="file-frame-'+this._id+'" name="file-frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;" data-loaded="true"></iframe>'),e+="</div>",e+="</div>",e+='<p class="f-progress" id="f-file-progress-'+this._id+'"><span></span></p>',e+="</div>"},t.Editable.prototype.buildFileDrag=function(){var e=this;e.$file_wrapper.on("dragover","#f-file-upload-div-"+this._id,function(){return t(this).addClass("f-hover"),!1}),e.$file_wrapper.on("dragend","#f-file-upload-div-"+this._id,function(){return t(this).removeClass("f-hover"),!1}),e.$file_wrapper.on("drop","#f-file-upload-div-"+this._id,function(i){i.preventDefault(),i.stopPropagation(),t(this).removeClass("f-hover"),e.uploadFile(i.originalEvent.dataTransfer.files)}),e.$element.on("drop",function(i){var n=i.originalEvent.dataTransfer.files;if(0===t(".froala-element img.fr-image-move").length&&i.originalEvent.dataTransfer&&n&&n.length){if(e.isDisabled)return!1;e.options.allowedImageTypes.indexOf(n[0].type.replace(/image\//g,""))<0&&(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),e.insertMarkersAtPoint(i.originalEvent),e.showByCoordinates(i.originalEvent.pageX,i.originalEvent.pageY),e.uploadFile(n),i.preventDefault(),i.stopPropagation())}})},t.Editable.prototype.buildFileUpload=function(){this.$file_wrapper=t(this.fileUploadHTML()),this.$popup_editor.append(this.$file_wrapper),this.buildFileDrag();var e=this;if(this.$file_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.addListener("hidePopups",t.proxy(function(){this.hideFileWrapper()},this)),this.$file_progress_bar=this.$file_wrapper.find("p#f-file-progress-"+this._id),this.browser.msie&&t.Editable.getIEversion()<=9){var i=this.$file_wrapper.find("iframe").get(0);i.attachEvent?i.attachEvent("onload",function(){e.iFrameLoad()}):i.onload=function(){e.iFrameLoad()}}this.$file_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadFile(this.files);else{var i=t(this).parents("form");i.find('input[type="hidden"]').remove();var n;for(n in e.options.fileUploadParams)i.prepend('<input type="hidden" name="'+n+'" value="'+e.options.fileUploadParams[n]+'" />');e.$file_wrapper.find("#f-file-list-"+e._id).hide(),e.$file_progress_bar.show(),e.$file_progress_bar.find("span").css("width","100%").text("Please wait!"),e.showFileUpload(),i.submit()}t(this).val("")}),this.$file_wrapper.on(this.mouseup,"#f-file-close-"+this._id,t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.$bttn_wrapper.show(),this.hideFileWrapper(),this.restoreSelection(),this.focus(),this.hide()},this)),this.$file_wrapper.on("click",function(t){t.stopPropagation()}),this.$file_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.initializers.push(t.Editable.prototype.buildFileUpload),t.Editable.prototype.uploadFile=function(e){if(!this.triggerEvent("beforeFileUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var i;if(this.drag_support.formdata&&(i=this.drag_support.formdata?new FormData:null),i){var n;for(n in this.options.fileUploadParams)i.append(n,this.options.fileUploadParams[n]);if(i.append(this.options.fileUploadParam,e[0]),e[0].size>this.options.maxFileSize)return this.throwFileError(5),!1;if(this.options.allowedFileTypes.indexOf(e[0].type)<0&&this.options.allowedFileTypes.indexOf("*")<0)return this.throwFileError(6),!1}if(i){var r;if(this.options.crossDomain)r=this.createCORSRequest("POST",this.options.fileUploadURL);else{r=new XMLHttpRequest,r.open("POST",this.options.fileUploadURL);for(var a in this.options.headers)r.setRequestHeader(a,this.options.headers[a])}var o=e[0].name;r.onload=t.proxy(function(){this.$file_progress_bar.find("span").css("width","100%").text("Please wait!");try{r.status>=200&&r.status<300?this.parseFileResponse(r.responseText,o):this.throwFileError(3)}catch(t){this.throwFileError(4)}},this),r.onerror=t.proxy(function(){this.throwFileError(3)},this),r.upload.onprogress=t.proxy(function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0;this.$file_progress_bar.find("span").css("width",e+"%")}},this),r.send(i),this.$file_wrapper.find("#f-file-list-"+this._id).hide(),this.$file_progress_bar.show(),this.showFileUpload()}}},t.Editable.prototype.throwFileError=function(t){var e="Unknown file upload error.";1==t?e="Bad link.":2==t?e="No link in upload response.":3==t?e="Error during file upload.":4==t?e="Parsing response failed.":5==t?e="File too large.":6==t?e="Invalid file type.":7==t&&(e="File can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("fileError",[{code:t,message:e}],!1),this.hideFileLoader()},t.Editable.prototype.hideFileLoader=function(){this.$file_progress_bar.hide(),this.$file_progress_bar.find("span").css("width","0%").text(""),this.$file_wrapper.find("#f-file-list-"+this._id).show()},t.Editable.prototype.throwFileErrorWithMessage=function(t){this.triggerEvent("fileError",[{message:t,code:0}],!1),this.hideFileLoader()},t.Editable.prototype.parseFileResponse=function(e,i){try{if(!this.triggerEvent("afterFileUpload",[e],!1))return!1;var n=t.parseJSON(e);n.link?this.writeFile(n.link,i,e):n.error?this.throwFileErrorWithMessage(n.error):this.throwFileError(2)}catch(r){this.throwFileError(4)}},t.Editable.prototype.writeFile=function(t,e,i){this.restoreSelectionByMarkers(),this.focus(),this.options.useFileName||""===this.text()||(e=this.text()),this.insertHTML('<a class="fr-file" href="'+this.sanitizeURL(t)+'">'+e+"</a>"),this.hide(),this.hideFileLoader(),this.focus(),this.triggerEvent("fileUploaded",[e,t,i])}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{fontList:{"Arial,Helvetica":"Arial, Helvetica","Courier,Courier New":"Courier, Courier New",Georgia:"Georgia","Times New Roman,Times":"Times New Roman,Times","Trebuchet MS":"Trebuchet MS","Verdana, Geneva":"Verdana,Geneva"}}),t.Editable.prototype.refreshFontFamily=function(){var e=t(this.getSelectionElement());this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li[data-val="'+e.css("font-family").replace(/"/gi,'\\"')+'"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontFamily:{title:"Font Family",icon:"fa fa-font",refreshOnShow:t.Editable.prototype.refreshFontFamily,callback:function(t,e){this.inlineStyle("font-family",t,e)},undo:!0,callbackWithoutSelection:function(t,e){this._startInFontExec("font-family",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontFamily:function(t){var e=this.buildDropdownFontFamily(),i=this.buildDropdownButton(t,e,"fr-family");return i}}),t.Editable.prototype.buildDropdownFontFamily=function(){var t='<ul class="fr-dropdown-menu">';for(var e in this.options.fontList){var i=this.options.fontList[e],n='<li data-cmd="fontFamily" data-val="'+e+'">';n+='<a href="#" data-text="true" title="'+i+'" style="font-family: '+e+';">'+i+"</a></li>",t+=n}return t+="</ul>"}}(jQuery),!function(t){t.Editable.prototype.refreshFontSize=function(){var e=t(this.getSelectionElement()),i=parseInt(e.css("font-size").replace(/px/g,""),10)||16;this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li[data-val="'+i+'px"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontSize:{title:"Font Size",icon:"fa fa-text-height",refreshOnShow:t.Editable.prototype.refreshFontSize,seed:[{min:11,max:52}],undo:!0,callback:function(t,e){this.inlineStyle("font-size",t,e)},callbackWithoutSelection:function(t,e){this._startInFontExec("font-size",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontSize:function(t){var e=this.buildDropdownFontsize(t),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownFontsize=function(t){for(var e='<ul class="fr-dropdown-menu f-font-sizes">',i=0;i<t.seed.length;i++)for(var n=t.seed[i],r=n.min;r<=n.max;r++)e+='<li data-cmd="'+t.cmd+'" data-val="'+r+'px"><a href="#"><span>'+r+"px</span></a></li>";return e+="</ul>"}}(jQuery),!function(t){t.Editable.prototype.refreshFullscreen=function(){this.$box.hasClass("fr-fullscreen")?this.$editor.find('[data-cmd="fullscreen"]').addClass("active"):this.$editor.find('[data-cmd="fullscreen"]').removeClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fullscreen:{icon:"fa fa-expand",title:"Fullscreen",callback:function(){if(this.$box.toggleClass("fr-fullscreen"),t("body").toggleClass("fr-fullscreen"),this.$editor.find('[data-cmd="fullscreen"] i').toggleClass("fa-expand fa-compress"),this.refreshFullscreen(),this.$box.hasClass("fr-fullscreen"))this.$fullscreen_marker=t("<div>"),this.$box.after(this.$fullscreen_marker),this.$box.appendTo("body"),this.computeElementHeight();else{this.$wrapper.css("height",""),this.$element.css("minHeight",""),this.setDimensions(),this.options.scrollableContainer=this.oldScrollableContainer;var e=this.$document.find(this.options.scrollableContainer);e.append(this.$popup_editor),this.$fullscreen_marker.replaceWith(this.$box)}},refresh:t.Editable.prototype.refreshFullscreen}}),t.Editable.prototype.computeElementHeight=function(){var t=this.$window.height()-this.$editor.outerHeight()-parseFloat(this.$wrapper.css("padding-top"),10)-parseFloat(this.$wrapper.css("padding-bottom"),10)-parseFloat((this.$wrapper||this.$element).css("border-top-width"),10)-parseFloat((this.$wrapper||this.$element).css("border-bottom-width"),10)+2;this.$wrapper.css("height",t),this.$element.css("minHeight",t-parseInt(this.$element.css("padding-top"),10)-parseInt(this.$element.css("padding-bottom"),10)),this.$element.css("maxHeight",""),this.$wrapper.css("maxHeight",""),this.oldScrollableContainer=this.options.scrollableContainer,this.options.scrollableContainer=this.$wrapper,this.$wrapper.append(this.$popup_editor)},t.Editable.prototype.initFullscreen=function(){this.$window.on("resize",t.proxy(function(){this.$box.hasClass("fr-fullscreen")&&this.computeElementHeight()},this))},t.Editable.initializers.push(t.Editable.prototype.initFullscreen)}(jQuery),!function(t){t.Editable.prototype.refreshInlineStyles=function(){var e=this.getSelectionElements()[0],i=e.tagName.toLowerCase();this.$bttn_wrapper.find(".fr-block-style").empty();var n=this.options.blockStyles[i];if(void 0===n&&(n=this.options.defaultBlockStyle),void 0!==n){this.$bttn_wrapper.find('.fr-dropdown > button[data-name="blockStyle"].fr-trigger').removeAttr("disabled");for(var r in n){var a=n[r],o="";t(e).hasClass(r)&&(o=' class="active"'),this.$bttn_wrapper.find(".fr-block-style").append(t("<li"+o+">").append(t('<a href="#" data-text="true">').text(a).addClass(r)).attr("data-cmd","blockStyle").attr("data-val",r))}}},t.Editable.commands=t.extend(t.Editable.commands,{inlineStyle:{title:"Inline Style",icon:"fa fa-paint-brush",refreshOnShow:t.Editable.prototype.refreshInlineStyles,callback:function(t,e){this.applyInlineStyles(e)},callbackWithoutSelection:function(t,e){this.applyInlineStyles(e)}}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{inlineStyles:{"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{inlineStyle:function(t){var e=this.buildDropdownInlineStyle(),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownInlineStyle=function(){var t='<ul class="fr-dropdown-menu fr-inline-style">';for(var e in this.options.inlineStyles)t+='<li data-cmd="inlineStyle" data-val="'+e+'"><a href="#" style="'+this.options.inlineStyles[e]+'">'+e+"</a></li>";return t+="</ul>"},t.Editable.prototype.applyInlineStyles=function(e){this.insertHTML(""!==this.text()?this.start_marker+'<span data-fr-verified="true" style="'+this.options.inlineStyles[e]+'">'+this.text()+"</span>"+this.end_marker:'<span data-fr-verified="true" style="'+this.options.inlineStyles[e]+'">'+this.markers_html+t.Editable.INVISIBLE_SPACE+"</span>"),this.restoreSelectionByMarkers(),this.triggerEvent("inlineStyle")},t.Editable.prototype.startInInlineStyles=function(t){for(var e in this.options.inlineStyles[t])this._startInFontExec(e.replace(/([A-Z])/g,"-$1").toLowerCase(),null,this.options.inlineStyles[t][e]);this.triggerEvent("inlineStyle")}}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(t){this.formatList(t)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(t){this.formatList(t)},undo:!0}}),t.Editable.prototype.refreshLists=function(){var e=t(this.getSelectionElement()),i=this.parents(e,"ul, ol");if(i.length>0){var n="insertUnorderedList";"OL"==i[0].tagName&&(n="insertOrderedList"),this.$editor.find('button[data-cmd="'+n+'"]').addClass("active")}},t.Editable.prototype.processBackspace=function(e){var i=e.prev();if(i.length){for(this.removeMarkers(),("UL"==i.get(0).tagName||"OL"==i.get(0).tagName)&&(i=i.find("li:last"));i.find("> ul, > ol").length;)i=i.find("> ul li:last, > ol li:last");var n=i.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");if(0===i.text().length&&0===i.find("img, table, input, iframe, video").length)i.remove();else{if(this.emptyElement(i.get(0))||(this.keep_enter=!0,e.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(e,i){t(i).replaceWith(t(i).html())}),this.keep_enter=!1),n.length)if(t(n[n.length-1]).append(this.markers_html),0===e.find("ul, ol").length)t(n[n.length-1]).append(e.html());else{for(var r=!1,a=e.contents(),o=0;o<a.length;o++){var s=a[o];["OL","UL"].indexOf(a[o].tagName)>=0&&(r=!0),r?t(n[n.length-1]).after(s):t(n[n.length-1]).append(s)}this.$element.find("breakli").remove();var l=n[n.length-1].nextSibling;l&&"BR"==l.tagName&&t(l).remove()}else this.emptyElement(i.get(0))?(this.$element.find("breakli").replaceWith(this.markers_html),i.html(e.html())):(i.append(this.markers_html),i.append(e.html()));e.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()}this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(e,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},t.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var e,i=this.getSelectionElement(),n=this.parents(t(i),"table, li");if(n.length>0&&"TABLE"===n[0].tagName)return!0;if(e="LI"==i.tagName?t(i):this.parents(t(i),"li:first"),this.removeMarkers(),this.emptyElement(e.get(0))?(e.prepend("<breakli></breakli>"),1==e.find("br").length&&e.find("br").remove()):this.insertHTML("<breakli></breakli>"),e.find("breakli").prev().length&&"TABLE"===e.find("breakli").prev().get(0).tagName&&e.find("breakli").next().length&&"BR"===e.find("breakli").next().get(0).tagName)return this.setSelection(e.find("breakli").prev().find("td:first").get(0)),e.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var r,a=e.html(),o=[],s=0;s<a.length;s++){if(chr=a.charAt(s),"<"!=chr)return this.$element.find("breakli").remove(),!0;var l=a.indexOf(">",s+1);if(-1!==l){r=a.substring(s,l+1);var d=this.tagName(r);if(s=l,"breakli"==d){if(!this.isClosingTag(r)&&!this.isClosingTag(o[o.length-1]))return this.processBackspace(e),!1}else o.push(r)}}return this.$element.find("breakli").remove(),!0},t.Editable.prototype.textLiEnter=function(e){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var i,n,r=e.html(),a=[],o={},s=[],l=0,d=e.prop("attributes"),h="";for(n=0;n<d.length;n++)h+=" "+d[n].name+'="'+d[n].value+'"';var p=!1;for(n=0;n<r.length;n++)if(chr=r.charAt(n),"<"==chr){var c=r.indexOf(">",n+1);if(-1!==c){i=r.substring(n,c+1);var u=this.tagName(i);if(n=c,"breakli"==u){if(!this.isClosingTag(i)){for(var f=a.length-1;f>=0;f--){var m=this.tagName(a[f]);s.push("</"+m+">")}s.push("</li>"),s.push("<li"+h+">");for(var g=0;g<a.length;g++)s.push(a[g]);s.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>'),p=!1}}else if(s.push(i),p=!1,!this.isSelfClosingTag(i))if(this.isClosingTag(i)){var v=o[u].pop();a.splice(v,1)}else a.push(i),void 0===o[u]&&(o[u]=[]),o[u].push(a.length-1)}}else l++,32!=chr.charCodeAt(0)||p?(s.push(chr),p=!0):s.push("&nbsp;");var b=t(e.parents("ul, ol")[0]);e.replaceWith("<li"+h+">"+s.join("")+"</li>"),b.find("p:empty + table").prev().remove(),b.find("p + table").each(function(e,i){var n=t(i);n.prev().append(n.clone()),n.remove()}),b.find("table + p").each(function(e,i){var n=t(i);n.append(n.prev().clone()),n.prev().remove()}),this.keep_enter=!0,b.find(this.valid_nodes.join(",")).each(t.proxy(function(e,i){""===t(i).text().trim()&&0===t(i).find(this.valid_nodes.join(",")).length&&t(i).prepend(t.Editable.INVISIBLE_SPACE)},this)),this.keep_enter=!1},t.Editable.prototype.liEnter=function(){var e,i=this.getSelectionElement(),n=this.parents(t(i),"table, li");if(n.length>0&&"TABLE"==n[0].tagName)return!0;if(e="LI"==i.tagName?t(i):this.parents(t(i),"li:first"),this.getSelectionTextInfo(e.get(0)).atStart&&""===this.text())e.before("<li>"+t.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(e.text()).length&&0===e.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(e),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},t.Editable.prototype.listTab=function(){var e=t(this.getSelectionElement());return this.parents(e,"ul, ol").length>0&&0===this.parents(e,"table").length?(this.indent(),!1):void 0},t.Editable.prototype.listShiftTab=function(){var e=t(this.getSelectionElement());return this.parents(e,"ul, ol").length>0&&0===this.parents(e,"table").length?(this.outdent(),!1):void 0},t.Editable.prototype.indentList=function(t,e){return"LI"===t.get(0).tagName?(e?this.outdentLi(t):this.indentLi(t),this.cleanupLists(),!1):!0},t.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keypress",t.proxy(function(e){if(["TEXTAREA","INPUT"].indexOf(e.target.tagName)<0&&!this.isHTML){var i=e.which,n=this.getSelectionElement();if("LI"==n.tagName||this.parents(t(n),"li").length>0){if(13==i&&!e.shiftKey&&this.options.multiLine)return this.liEnter();if(8==i)return this.liBackspace()}}},this))},t.Editable.initializers.push(t.Editable.prototype.initList),t.Editable.prototype.formatList=function(e,i){if(this.browser.msie&&t.Editable.getIEversion()<9)return document.execCommand(e,!1,!1),!1;void 0===i&&(i=!0);var n,r,a=!1,o=!0,s=!1,l=this.getSelectionElements(),d=this.parents(t(l[0]),"ul, ol");if(d.length&&("UL"===d[0].tagName?"insertUnorderedList"!=e&&(a=!0):"insertOrderedList"!=e&&(a=!0)),this.saveSelectionByMarkers(),a){n="ol","insertUnorderedList"===e&&(n="ul");var h=t(d[0]);h.replaceWith("<"+n+">"+h.html()+"</"+n+">")}else{for(var p=0;p<l.length;p++)if(r=t(l[p]),("TD"==r.get(0).tagName||"TH"==r.get(0).tagName)&&this.wrapTextInElement(r),this.parents(r,"li").length>0||"LI"==r.get(0).tagName){var c;c="LI"==r.get(0).tagName?r:t(r.parents("li")[0]);var u=this.parents(r,"ul, ol");if(u.length>0&&(n=u[0].tagName.toLowerCase(),c.before('<span class="close-'+n+'" data-fr-verified="true"></span>'),c.after('<span class="open-'+n+'" data-fr-verified="true"></span>')),0===this.parents(t(u[0]),"ol, ul").length||a)if(0===c.find(this.valid_nodes.join(",")).length){var f=c.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===c.text().replace(/\u200B/gi,"").length&&(f+=c.find("br").length>0?"":this.br),f="<"+this.options.defaultTag+this.attrs(c.get(0))+">"+f,f=f+"</"+this.options.defaultTag+">"):f+=c.find("br").length>0?"":this.br,c.replaceWith(f)}else c.replaceWith(c.html().replace(/\u200B/gi,""));else this.parents(t(u[0]),"ol, ul").length>0&&(c.append('<span class="open-li" data-fr-verified="true"></span>'),c.before('<span class="close-li" data-fr-verified="true"></span>'));s=!0}else o=!1;s&&this.cleanupLists(),(o===!1||a===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),l=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(l,e),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!a&&this.wrapText(!0),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),e="insertUnorderedList"==e?"unorderedListInserted":"orderedListInserted",this.triggerEvent(e)},t.Editable.prototype.elementsToList=function(e,i){var n="<ol>";"insertUnorderedList"==i&&(n="<ul>"),e[0]==this.$element.get(0)&&(e=this.$element.find("> "+this.valid_nodes.join(", >")));for(var r=0;r<e.length;r++){var a=t(n);$element=t(e[r]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),i)):(""===$element.attr("class")&&$element.removeAttr("class"),a.append(t("<li>").html($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?$element.clone().html():$element.clone())),$element.replaceWith(a)))}},t.Editable.prototype.indentLi=function(e){var i=e.parents("ul, ol"),n=i.get(0).tagName.toLowerCase();e.find("> ul, > ol").length>0&&e.prev("li").length>0?(this.wrapTextInElement(e),e.find("> "+this.valid_nodes.join(" , > ")).each(function(e,i){t(i).wrap("<"+n+"></"+n+">").wrap("<li></li>")}),e.prev("li").append(e.find("> ul, > ol")),e.remove()):0===e.find("> ul, > ol").length&&e.prev("li").length>0&&(e.prev().append(t("<"+n+">").append(e.clone())),e.remove(),t(i.find("li").get().reverse()).each(function(e,i){var n=t(i);n.find(" > ul, > ol").length>0&&n.prev()&&n.prev().find(" > ul, > ol").length>0&&1===n.contents().length&&(n.prev().append(n.html()),n.remove())}))},t.Editable.prototype.outdentLi=function(e){var i=t(e.parents("ul, ol")[0]),n=this.parents(i,"ul, ol"),r=i.get(0).tagName.toLowerCase();0===e.prev("li").length&&this.parents(e,"li").length>0?(e.before('<span class="close-'+r+'" data-fr-verified="true"></span>'),e.before('<span class="close-li" data-fr-verified="true"></span>'),e.before('<span class="open-li" data-fr-verified="true"></span>'),e.after('<span class="open-'+r+'" data-fr-verified="true"></span>'),e.replaceWith(e.html())):(e.before('<span class="close-'+r+'" data-fr-verified="true"></span>'),e.after('<span class="open-'+r+'" data-fr-verified="true"></span>'),this.parents(e,"li").length>0&&(e.before('<span class="close-li" data-fr-verified="true"></span>'),e.after('<span class="open-li" data-fr-verified="true"></span>'))),n.length||(0===e.find(this.valid_nodes.join(",")).length?e.replaceWith(e.html().replace(/\u200b/gi,"")+this.br):(e.find(this.valid_nodes.join(", ")).each(t.proxy(function(e,i){
this.emptyElement(i)&&t(i).append(this.br)},this)),e.replaceWith(e.html().replace(/\u200b/gi,""))))},t.Editable.prototype.listTextEmpty=function(e){var i=t(e).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===i||e===this.$element.get(0))&&1===t(e).find("br").length}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{mediaManager:!0,imagesLoadURL:"http://i.froala.com/images",imagesLoadParams:{}}),t.Editable.prototype.showMediaManager=function(){this.$image_modal.show(),this.$overlay.show(),this.loadImages(),this.$document.find("body").css("overflow","hidden")},t.Editable.prototype.hideMediaManager=function(){this.$image_modal.hide(),this.$overlay.hide(),this.$document.find("body").css("overflow","")},t.Editable.prototype.mediaModalHTML=function(){var t='<div class="froala-modal"><div class="f-modal-wrapper"><h4><span data-text="true">Manage images</span><i title="Cancel" class="fa fa-times" id="f-modal-close-'+this._id+'"></i></h4>';return t+='<img class="f-preloader" id="f-preloader-'+this._id+'" alt="Loading..." src="'+this.options.preloaderSrc+'" style="display: none;">',t+=WYSIWYGModernizr.touch?'<div class="f-image-list f-touch" id="f-image-list-'+this._id+'"></div>':'<div class="f-image-list" id="f-image-list-'+this._id+'"></div>',t+="</div></div>"},t.Editable.prototype.buildMediaManager=function(){this.$image_modal=t(this.mediaModalHTML()).appendTo("body"),this.$preloader=this.$image_modal.find("#f-preloader-"+this._id),this.$media_images=this.$image_modal.find("#f-image-list-"+this._id),this.$overlay=t('<div class="froala-overlay">').appendTo("body"),this.$overlay.on("mouseup",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$image_modal.on("mouseup",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$image_modal.find("i#f-modal-close-"+this._id).click(t.proxy(function(){this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,"img",t.proxy(function(e){e.stopPropagation();var i=e.currentTarget;this.writeImage(t(i).attr("src")),this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,".f-delete-img",t.proxy(function(e){e.stopPropagation();var i=t(e.currentTarget).prev(),n="Are you sure? Image will be deleted.";t.Editable.LANGS[this.options.language]&&(n=t.Editable.LANGS[this.options.language].translation[n]),confirm(n)&&this.triggerEvent("beforeDeleteImage",[t(i)],!1)!==!1&&(t(i).parent().addClass("f-img-deleting"),this.deleteImage(t(i)))},this)),this.options.mediaManager&&(this.$image_wrapper.on("click","#f-browser-"+this._id,t.proxy(function(){this.showMediaManager()},this)).on("click","#f-browser-"+this._id+" i",t.proxy(function(){this.showMediaManager()},this)),this.$image_wrapper.find("#f-browser-"+this._id).show()),this.hideMediaManager()},t.Editable.prototype.destroyMediaManager=function(){this.hideMediaManager(),this.$overlay.html("").removeData().remove(),this.$image_modal.html("").removeData().remove()},t.Editable.prototype.initMediaManager=function(){return this.options.mediaManager?(this.buildMediaManager(),void this.addListener("destroy",this.destroyMediaManager)):!1},t.Editable.initializers.push(t.Editable.prototype.initMediaManager),t.Editable.prototype.processLoadedImages=function(t){try{if(t.error)this.throwImagesLoadErrorWithMessage(t.error);else{this.$media_images.empty();for(var e=0;e<t.length;e++)t[e].src?this.loadImage(t[e].src,t[e].info):this.loadImage(t[e])}}catch(i){this.throwLoadImagesError(4)}},t.Editable.prototype.throwImagesLoadErrorWithMessage=function(t){this.triggerEvent("imagesLoadError",[{message:t,code:0}],!1),this.hideImageLoader()},t.Editable.prototype.loadImages=function(){this.$preloader.show(),this.$media_images.empty(),this.options.imagesLoadURL?(t.support.cors=!0,t.getJSON(this.options.imagesLoadURL,this.options.imagesLoadParams,t.proxy(function(t){this.triggerEvent("imagesLoaded",[t],!1),this.processLoadedImages(t),this.$preloader.hide()},this)).fail(t.proxy(function(){this.throwLoadImagesError(2)},this))):this.throwLoadImagesError(3)},t.Editable.prototype.throwLoadImagesError=function(t){void 0===t&&(t=-1);var e="Unknown image upload error.";1==t?e="Bad link.":2==t?e="Error during request.":3==t?e="Missing imagesLoadURL option.":4==t&&(e="Parsing response failed."),this.triggerEvent("imagesLoadError",[{code:t,message:e}],!1),this.$preloader.hide()},t.Editable.prototype.loadImage=function(e,i){var n=new Image,r=t("<div>").addClass("f-empty");n.onload=t.proxy(function(){var n="Delete";t.Editable.LANGS[this.options.language]&&(n=t.Editable.LANGS[this.options.language].translation[n]);var a=t('<img src="'+e+'"/>');for(var o in i)a.attr("data-"+o,i[o]);r.append(a).append('<a class="f-delete-img"><span data-text="true">'+n+"</span></a>"),r.removeClass("f-empty"),this.$media_images.hide(),this.$media_images.show(),this.triggerEvent("imageLoaded",[e],!1)},this),n.onerror=t.proxy(function(){r.remove(),this.throwLoadImagesError(1)},this),n.src=e,this.$media_images.append(r)}}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{table:{title:"Table",icon:"fa fa-table",callback:function(t,e,i){this.table_commands[e]?this.table_commands[e].apply(this,[e,i]):this.table_commands.insertTable.apply(this,[e,i]),this.cleanupTables()}}}),t.Editable.DEFAULTS.buttons[t.Editable.DEFAULTS.buttons.indexOf("insertHorizontalRule")]="table",t.Editable.prototype.table_commands={insertTable:function(t,e){this.insertTable(t,e)},insertRowAbove:function(){this.insertRow("above")},insertRowBelow:function(){this.insertRow("below")},insertColumnBefore:function(){this.insertColumn("before")},insertColumnAfter:function(){this.insertColumn("after")},deleteColumn:function(){this.deleteColumn()},deleteRow:function(){this.deleteRow()},insertCellBefore:function(){this.insertCell("before")},insertCellAfter:function(){this.insertCell("after")},mergeCells:function(){this.mergeCells()},deleteCell:function(){this.deleteCell()},splitVertical:function(){this.splitVertical()},splitHorizontal:function(){this.splitHorizontal()},insertHeader:function(){this.insertHeader()},deleteHeader:function(){this.deleteHeader()},deleteTable:function(){this.deleteTable()}},t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{table:function(t){var e=this.buildDropdownTable(),i=this.buildDropdownButton(t,e,"fr-table");return this.bindTableDropdownEvents(),i}}),t.Editable.prototype.tableTab=function(){var e;this.currentCell&&(e=this.currentCell());var i=t(this.getSelectionElement());return i.parents("ul, ol").length>0?!0:e&&this.nextCell()?(this.setSelection(this.nextCell()),!1):void 0},t.Editable.prototype.tableShiftTab=function(){var e;this.currentCell&&(e=this.currentCell());var i=t(this.getSelectionElement());return i.parents("ul, ol").length>0?!0:e&&this.prevCell()?(this.setSelection(this.prevCell()),!1):void 0},t.Editable.prototype.initTable=function(){var e=this;this.$editor.on("click mouseup touch touchend",".fr-table a",function(i){i.preventDefault(),i.stopPropagation(),e.android()&&(t(this).parent().siblings().removeClass("hover"),t(this).parent().addClass("hover"))}),this.addListener("tab",this.tableTab),this.addListener("shift+tab",this.tableShiftTab)},t.Editable.initializers.push(t.Editable.prototype.initTable),t.Editable.prototype.buildDropdownTable=function(){var t='<ul class="fr-dropdown-menu fr-table">';t+='<li> <a href="#"><span data-text="true">Insert table</span> <i class="fa fa-chevron-right"></i></a><div class="select-table"> ',t+='<div class="fr-t-info">1 x 1</div>';for(var e=1;10>=e;e++){for(var i=1;10>=i;i++){var n="inline-block";(e>5||i>5)&&(n="none");var r="fr-bttn ";1==e&&1==i&&(r+=" hover"),t+='<span class="'+r+'" data-cmd="table" data-val="'+e+'" data-param="'+i+'" style="display: '+n+';"><span></span></span>'}t+='<div class="new-line"></div>'}return t+="</div> </li>",t+='<li><a href="#"><span data-text="true">Cell</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertCellBefore"><a href="#" data-text="true">Insert cell before</a></li><li data-cmd="table" data-val="insertCellAfter"><a href="#" data-text="true">Insert cell after</a></li><li data-cmd="table" data-val="deleteCell"><a href="#" data-text="true">Delete cell</a></li><li data-cmd="table" data-val="mergeCells"><a href="#" data-text="true">Merge cells</a></li><li data-cmd="table" data-val="splitHorizontal"><a href="#" data-text="true">Horizontal split</a></li><li data-cmd="table" data-val="splitVertical"><a href="#" data-text="true">Vertical split</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Row</span> <i class="fa fa-chevron-right"></i></a> <ul><li data-cmd="table" data-val="insertRowAbove"><a href="#" data-text="true">Insert row above</a></li><li data-cmd="table" data-val="insertRowBelow"><a href="#" data-text="true">Insert row below</a></li><li data-cmd="table" data-val="deleteRow"><a href="#" data-text="true">Delete row</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Column</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertColumnBefore"><a href="#" data-text="true">Insert column before</a></li> <li data-cmd="table" data-val="insertColumnAfter"><a href="#" data-text="true">Insert column after</a></li> <li data-cmd="table" data-val="deleteColumn"><a href="#" data-text="true">Delete column</a></li> </ul></li>',t+='<li data-cmd="table" data-val="deleteTable"><a href="#" data-text="true">Delete table</a></li>',t+="</ul>"},t.Editable.prototype.bindTableDropdownEvents=function(){var e=this;this.$bttn_wrapper.on("mouseenter",".fr-table .select-table > span",function(){var i=t(this).data("val"),n=t(this).data("param");e.$bttn_wrapper.find(".fr-table .select-table .fr-t-info").text(i+" x "+n),e.$bttn_wrapper.find(".fr-table .select-table > span").removeClass("hover");for(var r=1;10>=r;r++)for(var a=0;10>=a;a++){var o=e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="'+r+'"][data-param="'+a+'"]');i>=r&&n>=a?o.addClass("hover"):(i+1>=r||5>=r)&&(n+1>=a||5>=a)?o.css("display","inline-block"):(r>5||a>5)&&o.css("display","none")}}),this.$bttn_wrapper.on("mouseleave",".fr-table .select-table",function(){e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="1"][data-param="1"]').trigger("mouseenter")}),this.android()&&this.$bttn_wrapper.on("touchend",".fr-table .fr-trigger",function(){t(this).parents(".fr-table").find(".hover").removeClass("hover")})},t.Editable.prototype.tableMap=function(){var e=this.currentTable(),i=[];return e&&e.find("tr:not(:empty)").each(function(e,n){var r=t(n),a=0;r.find("th, td").each(function(n,r){for(var o=t(r),s=parseInt(o.attr("colspan"),10)||1,l=parseInt(o.attr("rowspan"),10)||1,d=e;e+l>d;d++)for(var h=a;a+s>h;h++)i[d]||(i[d]=[]),i[d][h]?a++:i[d][h]=r;a+=s})}),i},t.Editable.prototype.cellOrigin=function(t,e){for(var i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)if(e[i][n]==t)return{row:i,col:n}},t.Editable.prototype.canMergeCells=function(){var e=this.getSelectionCells();if(e.length<2)return!1;for(var i=this.tableMap(),n=0,r=32e3,a=0,o=32e3,s=0,l=0;l<e.length;l++){var d=t(e[l]),h=parseInt(d.attr("colspan"),10)||1,p=parseInt(d.attr("rowspan"),10)||1,c=this.cellOrigin(e[l],i);n+=h*p,r=Math.min(r,c.col),a=Math.max(a,c.col+h),o=Math.min(o,c.row),s=Math.max(s,c.row+p)}return n==(a-r)*(s-o)?{row:o,col:r,colspan:a-r,rowspan:s-o,map:i,cells:e}:null},t.Editable.prototype.getSelectionCells=function(){var e,i=[];if(this.browser.webkit||this.browser.msie){var n=this.getSelectionElements();for(e=0;e<n.length;e++)("TD"==n[e].tagName||"TH"==n[e].tagName)&&i.push(n[e])}else{var r=this.getRanges();for(e=0;e<r.length;e++){var a=r[e],o=!1;if("TD"==a.startContainer.tagName||"TH"==a.startContainer.tagName)i.push(a.startContainer),o=!0;else{var s=a.startContainer.childNodes,l=a.startOffset;if(s.length>l&&l>=0){var d=s[l];("TD"==d.tagName||"TH"==d.tagName)&&(i.push(d),o=!0)}}if(o===!1){var h=t(a.startContainer).parents("td:first, th:first");h.length>0&&i.push(h.get(0))}}}return i},t.Editable.prototype.currentCell=function(){var t=this.getSelectionCells();return t.length>0?t[0]:null},t.Editable.prototype.prevCell=function(){var e=this.currentCell();if(e){if(t(e).prev("td").length)return t(e).prev("td").get(0);if(t(e).parent().prev("tr").find("td").length)return t(e).parent().prev("tr").find("td:last").get(0)}return null},t.Editable.prototype.nextCell=function(){var e=this.currentCell();if(e){if(t(e).next("td").length)return t(e).next("td").get(0);if(t(e).parent().next("tr").find("td").length)return t(e).parent().next("tr").find("td").get(0)}return null},t.Editable.prototype.currentTable=function(){for(var e=t(this.getSelectionElement());e.get(0)!=this.$element.get(0)&&e.get(0)!=this.$document.find("body").get(0)&&"TABLE"!=e.get(0).tagName;)e=e.parent();return e.get(0)!=this.$element.get(0)?e:null},t.Editable.prototype.focusOnTable=function(){var t=this.currentTable();if(t){var e=t.find("td:first");this.setSelection(e.get(0))}},t.Editable.prototype.insertCell=function(e){for(var i=this.getSelectionCells(),n=0;n<i.length;n++){var r=t(i[n]);"before"==e?r.before(r.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE)):"after"==e&&r.after(r.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE))}"before"==e?this.triggerEvent("cellInsertedBefore"):"after"==e&&this.triggerEvent("cellInsertedAfter")},t.Editable.prototype.mergeCells=function(){var e=this.canMergeCells();if(e){var i=t(e.map[e.row][e.col]);i.attr("colspan",e.colspan),i.attr("rowspan",e.rowspan);for(var n=0;n<e.cells.length;n++){var r=e.cells[n];if(i.get(0)!=r){var a=t(r);i.append(a.html()),a.remove()}}this.setSelection(i.get(0))}this.hide(),this.triggerEvent("cellsMerged")},t.Editable.prototype.deleteCell=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var n=t(e[i]);n.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("cellDeleted")},t.Editable.prototype.insertHeader=function(){var t=this.currentTable();t&&t.find(" > thead").length>0&&this.triggerEvent("headerInserted")},t.Editable.prototype.deleteHeader=function(){},t.Editable.prototype.insertColumn=function(e){var i=this.currentCell();if(i)for(var n=t(i),r=this.tableMap(),a=this.cellOrigin(n.get(0),r),o=0;o<r.length;o++){var s=r[o][a.col],l=parseInt(t(s).attr("colspan"),10)||1,d=parseInt(t(s).attr("rowspan"),10)||1;if("before"==e){var h=r[o][a.col-1];h?h==s?t(h).attr("colspan",l+1):d>1?t(h).after("<"+h.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+h.tagName+">"):t(s).before("<"+s.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+s.tagName+">"):t(s).before("<"+s.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+s.tagName+">")}else if("after"==e){var p=r[o][a.col+1];p?p==s?t(p).attr("colspan",l+1):d>1?t(p).before("<"+p.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+p.tagName+">"):t(s).after("<"+s.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+s.tagName+">"):t(s).after("<"+s.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+s.tagName+">")}}this.hide(),"before"==e?this.triggerEvent("columnInsertedBefore"):"after"==e&&this.triggerEvent("columnInsertedAfter")},t.Editable.prototype.deleteColumn=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++)for(var n=t(e[i]),r=this.tableMap(),a=this.cellOrigin(n.get(0),r),o=0;o<r.length;o++){var s=r[o][a.col],l=parseInt(t(s).attr("colspan"),10)||1;1==l?t(s).remove():t(s).attr("colspan",l-1)}this.focusOnTable(),this.hide(),this.triggerEvent("columnDeleted")},t.Editable.prototype.insertRow=function(e){var i,n=this.currentCell();if(n){var r=t(n),a=this.tableMap(),o=this.cellOrigin(r.get(0),a),s=0,l=null;for(i=0;i<a[o.row].length;i++){var d=a[o.row][i],h=parseInt(t(d).attr("rowspan"),10)||1;if("above"==e)if(0===o.row)s++;else{var p=a[o.row-1][i];p==d&&l!=d?t(d).attr("rowspan",h+1):s++}else if("below"==e)if(o.row==a.length-1)s++;else{var c=a[o.row+1][i];c==d&&l!=d?t(d).attr("rowspan",h+1):s++}l=a[o.row][i]}var u="<tr>";for(i=0;s>i;i++)u+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";u+="</tr>","below"==e?r.closest("tr").after(u):"above"==e&&r.closest("tr").before(u)}this.hide(),"below"==e?this.triggerEvent("rowInsertedBelow"):"above"==e&&this.triggerEvent("rowInsertedAbove")},t.Editable.prototype.deleteRow=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var n=t(e[i]),r=this.tableMap(),a=this.cellOrigin(n.get(0),r),o=n.parents("tr:first");if(a)for(var s=0;s<r[a.row].length;s++){var l=r[a.row][s],d=parseInt(t(l).attr("rowspan"),10)||1;if(1==d)t(l).remove();else{var h=this.cellOrigin(l,r);if(t(l).attr("rowspan",d-1),h.row==a.row){var p=r[a.row+1];p&&p[s-1]&&(t(p[s-1]).after(t(l).clone()),t(l).remove())}}}o.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("rowDeleted")},t.Editable.prototype.splitVertical=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var n=t(e[i]),r=this.tableMap(),a=this.cellOrigin(n.get(0),r),o=parseInt(n.attr("colspan"),10)||1,s=parseInt(n.attr("rowspan"),10)||1;if(s>1){var l=Math.floor(s/2),d=a.row+(s-l),h=r[d][a.col-1];h||(h=r[d][a.col+o]),h?t(h).before(n.clone().attr("rowspan",l).html(t.Editable.INVISIBLE_SPACE)):n.parents("tr:first").after(t("<tr>").append(n.clone().attr("rowspan",l).html(t.Editable.INVISIBLE_SPACE))),n.attr("rowspan",s-l)}else{for(var p=t("<tr>").append(n.clone().html(t.Editable.INVISIBLE_SPACE)),c=null,u=0;u<r[a.row].length;u++){var f=r[a.row][u],m=parseInt(t(f).attr("rowspan"),10)||1;c!=f&&f!=n.get(0)&&t(f).attr("rowspan",m+1),c=f}n.parents("tr:first").after(p)}}this.hide(),this.triggerEvent("cellVerticalSplit")},t.Editable.prototype.splitHorizontal=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var n=t(e[i]),r=this.tableMap(),a=this.cellOrigin(n.get(0),r),o=parseInt(n.attr("colspan"),10)||1;if(o>1){var s=Math.floor(o/2);n.after(n.clone().attr("colspan",s).html(t.Editable.INVISIBLE_SPACE)),n.attr("colspan",o-s)}else{for(var l=null,d=0;d<r.length;d++){var h=r[d][a.col],p=parseInt(t(h).attr("colspan"),10)||1;l!=h&&h!=n.get(0)&&t(h).attr("colspan",p+1),l=h}n.after(n.clone().html(t.Editable.INVISIBLE_SPACE))}}this.hide(),this.triggerEvent("cellHorizontalSplit")},t.Editable.prototype.insertTable=function(e,i){for(var n='<table data-last-table="true" width="100%">',r=0;e>r;r++){n+="<tr>";for(var a=0;i>a;a++)n+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";n+="</tr>"}n+="</table>",this.focus();var o=this.getSelectionElement();this.breakHTML(n,this.parents(t(o),"li").length<0);var s=this.$element.find('table[data-last-table="true"]');s.removeAttr("data-last-table"),this.setSelection(s.find("td:first").get(0)),this.hide(),this.triggerEvent("tableInserted")},t.Editable.prototype.deleteTable=function(){var t=this.currentTable();t&&(t.remove(),this.focus(),this.hide(),this.triggerEvent("tableDeleted"))},t.Editable.prototype.cleanupTables=function(){this.$element.find('td[colspan="1"], th[colspan="1"]').each(function(){t(this).removeAttr("colspan")}),this.$element.find('td[rowspan="1"], th[rowspan="1"]').each(function(){t(this).removeAttr("rowspan")})}}(jQuery),!function(t){t.Editable.URLRegEx=/(\s|^|>)((http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+(\.[a-zA-Z]{2,3})?(:\d*)?(\/[^\s<]*)?)(\s|$|<)/gi,t.Editable.prototype.convertURLs=function(e){var i=this;e.each(function(){if("IFRAME"!=this.tagName)if(3==this.nodeType){var e=this.textContent.replace(/&nbsp;/gi,"");t.Editable.URLRegEx.test(e)&&(t(this).before(e.replace(t.Editable.URLRegEx,'$1<a href="$2">$2</a>$7')),t(this).remove())}else 1==this.nodeType&&["A","BUTTON","TEXTAREA"].indexOf(this.tagName)<0&&i.convertURLs(t(this).contents())})},t.Editable.prototype.processURLs=function(){this.$original_element.on("editable.afterPasteCleanup",function(e,i,n){return t.Editable.URLRegEx.test(n)?n.replace(t.Editable.URLRegEx,'$1<a href="$2">$2</a>$7'):void 0}),this.$original_element.on("editable.keyup",function(t,e,i){var n=i.which;(32==n||13==n)&&e.convertURLs(e.$element.contents())}),this.$original_element.on("editable.keydown",function(e,i,n){var r=n.which;if(32==r){var a=i.getSelectionElement();if(("A"==a.tagName||t(a).parents("a").length)&&i.getSelectionTextInfo(a).atEnd)return e.stopImmediatePropagation(),"A"!==a.tagName&&(a=t(a).parents("a")[0]),t(a).after('&nbsp;<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),i.restoreSelectionByMarkers(),!1}})},t.Editable.initializers.push(t.Editable.prototype.processURLs)}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{videoAllowedAttrs:["src","width","height","frameborder","allowfullscreen","webkitallowfullscreen","mozallowfullscreen","href","target","id","controls","value","name"],videoAllowedTags:["iframe","object","param","video","source","embed"],defaultVideoAlignment:"center",textNearVideo:!0}),t.Editable.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?(.+)/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/(videos-for-you|popular)?\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],t.Editable.video_commands={floatVideoLeft:{title:"Float Left",icon:{type:"font",value:"fa fa-align-left"}},floatVideoNone:{title:"Float None",icon:{type:"font",value:"fa fa-align-justify"}},floatVideoRight:{title:"Float Right",icon:{type:"font",value:"fa fa-align-right"}},removeVideo:{title:"Remove Video",icon:{type:"font",value:"fa fa-trash-o"}}},t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{videoButtons:["floatVideoLeft","floatVideoNone","floatVideoRight","removeVideo"]}),t.Editable.commands=t.extend(t.Editable.commands,{insertVideo:{title:"Insert Video",icon:"fa fa-video-camera",callback:function(){this.insertVideo()},undo:!1}}),t.Editable.prototype.insertVideo=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertVideo")),this.selectionInEditor()&&this.saveSelection(),this.showInsertVideo(),this.$video_wrapper.find("textarea").val("")},t.Editable.prototype.insertVideoHTML=function(){var t='<div class="froala-popup froala-video-popup" style="display: none;"><h4><span data-text="true">Insert Video</span><i title="Cancel" class="fa fa-times" id="f-video-close-'+this._id+'"></i></h4><div class="f-popup-line"><textarea placeholder="Embedded code" id="f-video-textarea-'+this._id+'"></textarea></div><p class="or"><span data-text="true">or</span></p><div class="f-popup-line"><input type="text" placeholder="http://youtube.com/" id="f-video-input-'+this._id+'"/><button data-text="true" class="f-ok f-submit fr-p-bttn" id="f-video-ok-'+this._id+'">OK</button></div></div>';return t},t.Editable.prototype.buildInsertVideo=function(){this.$video_wrapper=t(this.insertVideoHTML()),this.$popup_editor.append(this.$video_wrapper),this.addListener("hidePopups",this.hideVideoWrapper),this.$video_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$video_wrapper.on("mouseup keydown","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,t.proxy(function(t){t.stopPropagation()},this));var e=this;this.$video_wrapper.on("change","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,function(){"INPUT"==this.tagName?e.$video_wrapper.find("textarea#f-video-textarea-"+e._id).val(""):"TEXTAREA"==this.tagName&&e.$video_wrapper.find("input#f-video-input-"+e._id).val("")}),this.$video_wrapper.on("click","button#f-video-ok-"+this._id,t.proxy(function(){var t=this.$video_wrapper.find("input#f-video-input-"+this._id),e=this.$video_wrapper.find("textarea#f-video-textarea-"+this._id);""!==t.val()?this.writeVideo(t.val(),!1):""!==e.val()&&this.writeVideo(e.val(),!0)},this)),this.$video_wrapper.on(this.mouseup,"i#f-video-close-"+this._id,t.proxy(function(){this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this)),this.$video_wrapper.on("click",function(t){t.stopPropagation()}),this.$video_wrapper.on("click","*",function(t){t.stopPropagation()}),this.$window.on("keydown."+this._id,t.proxy(function(e){if(this.$element.find(".f-video-editor.active").length>0){var i=e.which;if(46==i||8==i)return e.stopPropagation(),e.preventDefault(),setTimeout(t.proxy(function(){this.removeVideo()},this),0),!1}},this))},t.Editable.prototype.destroyVideo=function(){this.$video_wrapper.html("").removeData().remove()},t.Editable.prototype.initVideo=function(){this.buildInsertVideo(),this.addVideoControls(),this.addListener("destroy",this.destroyVideo)},t.Editable.initializers.push(t.Editable.prototype.initVideo),t.Editable.prototype.hideVideoEditorPopup=function(){this.$video_editor&&(this.$video_editor.hide(),t("span.f-video-editor").removeClass("active"),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0))},t.Editable.prototype.showVideoEditorPopup=function(){this.hidePopups(),this.$video_editor&&this.$video_editor.show(),this.$element.removeAttr("contenteditable")},t.Editable.prototype.addVideoControlsHTML=function(){this.$video_editor=t('<div class="froala-popup froala-video-editor-popup" style="display: none">');for(var e=t('<div class="f-popup-line">').appendTo(this.$video_editor),i=0;i<this.options.videoButtons.length;i++){var n=this.options.videoButtons[i];if(void 0!==t.Editable.video_commands[n]){var r=t.Editable.video_commands[n],a='<button class="fr-bttn" data-callback="'+n+'" data-cmd="'+n+'" title="'+r.title+'">';a+=void 0!==this.options.icons[n]?this.prepareIcon(this.options.icons[n],r.title):this.prepareIcon(r.icon,r.title),a+="</button>",e.append(a)}}this.addListener("hidePopups",this.hideVideoEditorPopup),this.$popup_editor.append(this.$video_editor),this.bindCommandEvents(this.$video_editor)},t.Editable.prototype.floatVideoLeft=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvl"),this.triggerEvent("videoFloatedLeft"),t("span.f-video-editor.active").click()},t.Editable.prototype.floatVideoRight=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvr"),this.triggerEvent("videoFloatedRight"),t("span.f-video-editor.active").click()},t.Editable.prototype.floatVideoNone=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvn"),this.triggerEvent("videoFloatedNone"),t("span.f-video-editor.active").click()},t.Editable.prototype.removeVideo=function(){t("span.f-video-editor.active").remove(),this.hide(),this.triggerEvent("videoRemoved"),this.focus()},t.Editable.prototype.refreshVideo=function(){this.$element.find("iframe, object").each(function(e,i){for(var n=t(i),r=0;r<t.Editable.VIDEO_PROVIDERS.length;r++){var a=t.Editable.VIDEO_PROVIDERS[r];if(a.test_regex.test(n.attr("src"))){0===n.parents(".f-video-editor").length&&n.wrap('<span class="f-video-editor fr-fvn" data-fr-verified="true" contenteditable="false">');break}}}),this.browser.msie&&this.$element.find(".f-video-editor").each(function(){this.oncontrolselect=function(){return!1}}),this.options.textNearVideo||this.$element.find(".f-video-editor").attr("contenteditable",!1).addClass("fr-tnv")},t.Editable.prototype.addVideoControls=function(){this.addVideoControlsHTML(),this.addListener("sync",this.refreshVideo),this.$element.on("mousedown","span.f-video-editor",t.proxy(function(t){t.stopPropagation()},this)),this.$element.on("click touchend","span.f-video-editor",t.proxy(function(e){if(this.isDisabled)return!1;e.preventDefault(),e.stopPropagation();var i=e.currentTarget;this.clearSelection(),this.showVideoEditorPopup(),this.showByCoordinates(t(i).offset().left+t(i).width()/2,t(i).offset().top+t(i).height()+3),t(i).addClass("active"),this.refreshVideoButtons(i)},this))},t.Editable.prototype.refreshVideoButtons=function(e){var i=t(e).attr("class");this.$video_editor.find("[data-cmd]").removeClass("active"),i.indexOf("fr-fvl")>=0?this.$video_editor.find('[data-cmd="floatVideoLeft"]').addClass("active"):i.indexOf("fr-fvr")>=0?this.$video_editor.find('[data-cmd="floatVideoRight"]').addClass("active"):this.$video_editor.find('[data-cmd="floatVideoNone"]').addClass("active")},t.Editable.prototype.writeVideo=function(e,i){var n=null;if(i)n=this.clean(e,!0,!1,this.options.videoAllowedTags,this.options.videoAllowedAttrs);else for(var r=0;r<t.Editable.VIDEO_PROVIDERS.length;r++){var a=t.Editable.VIDEO_PROVIDERS[r];if(a.test_regex.test(e)){e=e.replace(a.url_regex,a.url_text),n=a.html.replace(/\{url\}/,e);break}}if(n){this.restoreSelection(),this.$element.focus();var o="fr-fvn";"left"==this.options.defaultVideoAlignment&&(o="fr-fvl"),"right"==this.options.defaultVideoAlignment&&(o="fr-fvr"),this.textNearVideo||(o+=" fr-tnv");try{this.insertHTML('<span contenteditable="false" class="f-video-editor '+o+'" data-fr-verified="true">'+n+"</span>")}catch(s){}this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.hide(),this.triggerEvent("videoInserted",[n])}else this.triggerEvent("videoError")},t.Editable.prototype.showVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.show(),this.$video_wrapper.find(".f-popup-line input").val(""))},t.Editable.prototype.hideVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.hide(),this.$video_wrapper.find("input").blur())},t.Editable.prototype.showInsertVideo=function(){this.hidePopups(),this.showVideoWrapper()}}(jQuery),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Spinner=e()}(this,function(){"use strict";function t(t,e){var i,n=document.createElement(t||"div");for(i in e)n[i]=e[i];return n}function e(t){for(var e=1,i=arguments.length;i>e;e++)t.appendChild(arguments[e]);return t}function i(t,e,i,n){var r=["opacity",e,~~(100*t),i,n].join("-"),a=.01+i/n*100,o=Math.max(1-(1-t)/e*(100-a),t),s=d.substring(0,d.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return p[r]||(c.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+o+"}"+a+"%{opacity:"+t+"}"+(a+.01)+"%{opacity:1}"+(a+e)%100+"%{opacity:"+t+"}100%{opacity:"+o+"}}",c.cssRules.length),p[r]=1),r}function n(t,e){var i,n,r=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<h.length;n++)if(i=h[n]+e,void 0!==r[i])return i;return void 0!==r[e]?e:void 0}function r(t,e){for(var i in e)t.style[n(t,i)||i]=e[i];return t}function a(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)void 0===t[n]&&(t[n]=i[n])}return t}function o(t,e){return"string"==typeof t?t:t[e%t.length]}function s(t){this.opts=a(t||{},s.defaults,u)}function l(){function i(e,i){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}c.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(t,n){function a(){return r(i("group",{coordsize:h+" "+h,coordorigin:-d+" "+-d}),{width:h,height:h})}function s(t,s,l){e(c,e(r(a(),{
rotation:360/n.lines*t+"deg",left:~~s}),e(r(i("roundrect",{arcsize:n.corners}),{width:d,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),i("fill",{color:o(n.color,t),opacity:n.opacity}),i("stroke",{opacity:0}))))}var l,d=n.length+n.width,h=2*d,p=2*-(n.width+n.length)+"px",c=r(a(),{position:"absolute",top:p,left:p});if(n.shadow)for(l=1;l<=n.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)s(l);return e(t,c)},s.prototype.opacity=function(t,e,i,n){var r=t.firstChild;n=n.shadow&&n.lines||0,r&&e+n<r.childNodes.length&&(r=r.childNodes[e+n],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=i))}}var d,h=["webkit","Moz","ms","O"],p={},c=function(){var i=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),u={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};s.defaults={},a(s.prototype,{spin:function(e){this.stop();var i=this,n=i.opts,a=i.el=r(t(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});if(r(a,{left:n.left,top:n.top}),e&&e.insertBefore(a,e.firstChild||null),a.setAttribute("role","progressbar"),i.lines(a,i.opts),!d){var o,s=0,l=(n.lines-1)*(1-n.direction)/2,h=n.fps,p=h/n.speed,c=(1-n.opacity)/(p*n.trail/100),u=p/n.lines;!function f(){s++;for(var t=0;t<n.lines;t++)o=Math.max(1-(s+(n.lines-t)*u)%p*c,n.opacity),i.opacity(a,t*n.direction+l,o,n);i.timeout=i.el&&setTimeout(f,~~(1e3/h))}()}return i},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(n,a){function s(e,i){return r(t(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:e,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*h+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var l,h=0,p=(a.lines-1)*(1-a.direction)/2;h<a.lines;h++)l=r(t(),{position:"absolute",top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:d&&i(a.opacity,a.trail,p+h*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&e(l,r(s("#000","0 0 4px #000"),{top:"2px"})),e(n,e(l,s(o(a.color,h),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(t,e,i){e<t.childNodes.length&&(t.childNodes[e].style.opacity=i)}});var f=r(t("group"),{behavior:"url(#default#VML)"});return!n(f,"transform")&&f.adj?l():d=n(f,"animation"),s}),function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.scrollReveal=e()}(this,function(t,e,i){return window.scrollReveal=function(t){"use strict";function e(i){return this instanceof e?(a=this,a.elems={},a.serial=1,a.blocked=!1,a.config=n(a.defaults,i),a.isMobile()&&!a.config.mobile||!a.isSupported()?void a.destroy():(a.config.viewport===t.document.documentElement?(t.addEventListener("scroll",r,!1),t.addEventListener("resize",r,!1)):a.config.viewport.addEventListener("scroll",r,!1),void a.init(!0))):new e(i)}var i,n,r,a;return e.prototype={defaults:{enter:"bottom",move:"8px",over:"0.6s",wait:"0s",easing:"ease",scale:{direction:"up",power:"5%"},rotate:{x:0,y:0,z:0},opacity:0,mobile:!1,reset:!1,viewport:t.document.documentElement,delay:"once",vFactor:.6,complete:function(t){}},init:function(t){var e,i,n;n=Array.prototype.slice.call(a.config.viewport.querySelectorAll("[data-sr]")),n.forEach(function(t){e=a.serial++,i=a.elems[e]={domEl:t},i.config=a.configFactory(i),i.styles=a.styleFactory(i),i.seen=!1,t.removeAttribute("data-sr"),t.setAttribute("style",i.styles.inline+i.styles.initial)}),a.scrolled=a.scrollY(),a.animate(t)},animate:function(t){function e(t){var e=a.elems[t];setTimeout(function(){e.domEl.setAttribute("style",e.styles.inline),e.config.complete(e.domEl),delete a.elems[t]},e.styles.duration)}var i,n,r;for(i in a.elems)a.elems.hasOwnProperty(i)&&(n=a.elems[i],r=a.isElemInViewport(n),r?("always"===a.config.delay||"onload"===a.config.delay&&t||"once"===a.config.delay&&!n.seen?n.domEl.setAttribute("style",n.styles.inline+n.styles.target+n.styles.transition):n.domEl.setAttribute("style",n.styles.inline+n.styles.target+n.styles.reset),n.seen=!0,n.config.reset||n.animating||(n.animating=!0,e(i))):!r&&n.config.reset&&n.domEl.setAttribute("style",n.styles.inline+n.styles.initial+n.styles.reset));a.blocked=!1},configFactory:function(t){var e={},i={},r=t.domEl.getAttribute("data-sr").split(/[, ]+/);return r.forEach(function(t,i){switch(t){case"enter":e.enter=r[i+1];break;case"wait":e.wait=r[i+1];break;case"move":e.move=r[i+1];break;case"ease":e.move=r[i+1],e.ease="ease";break;case"ease-in":if("up"==r[i+1]||"down"==r[i+1]){e.scale.direction=r[i+1],e.scale.power=r[i+2],e.easing="ease-in";break}e.move=r[i+1],e.easing="ease-in";break;case"ease-in-out":if("up"==r[i+1]||"down"==r[i+1]){e.scale.direction=r[i+1],e.scale.power=r[i+2],e.easing="ease-in-out";break}e.move=r[i+1],e.easing="ease-in-out";break;case"ease-out":if("up"==r[i+1]||"down"==r[i+1]){e.scale.direction=r[i+1],e.scale.power=r[i+2],e.easing="ease-out";break}e.move=r[i+1],e.easing="ease-out";break;case"hustle":if("up"==r[i+1]||"down"==r[i+1]){e.scale.direction=r[i+1],e.scale.power=r[i+2],e.easing="cubic-bezier( 0.6, 0.2, 0.1, 1 )";break}e.move=r[i+1],e.easing="cubic-bezier( 0.6, 0.2, 0.1, 1 )";break;case"over":e.over=r[i+1];break;case"flip":case"pitch":e.rotate=e.rotate||{},e.rotate.x=r[i+1];break;case"spin":case"yaw":e.rotate=e.rotate||{},e.rotate.y=r[i+1];break;case"roll":e.rotate=e.rotate||{},e.rotate.z=r[i+1];break;case"reset":e.reset="no"==r[i-1]?!1:!0;break;case"scale":if(e.scale={},"up"==r[i+1]||"down"==r[i+1]){e.scale.direction=r[i+1],e.scale.power=r[i+2];break}e.scale.power=r[i+1];break;case"vFactor":case"vF":e.vFactor=r[i+1];break;case"opacity":e.opacity=r[i+1];break;default:return}}),i=n(i,a.config),i=n(i,e),"top"===i.enter||"bottom"===i.enter?i.axis="Y":("left"===i.enter||"right"===i.enter)&&(i.axis="X"),("top"===i.enter||"left"===i.enter)&&(i.move="-"+i.move),i},styleFactory:function(t){function e(){0!==parseInt(s.move)&&(n+=" translate"+s.axis+"("+s.move+")",a+=" translate"+s.axis+"(0)"),0!==parseInt(s.scale.power)&&("up"===s.scale.direction?s.scale.value=1-.01*parseFloat(s.scale.power):"down"===s.scale.direction&&(s.scale.value=1+.01*parseFloat(s.scale.power)),n+=" scale("+s.scale.value+")",a+=" scale(1)"),s.rotate.x&&(n+=" rotateX("+s.rotate.x+")",a+=" rotateX(0)"),s.rotate.y&&(n+=" rotateY("+s.rotate.y+")",a+=" rotateY(0)"),s.rotate.z&&(n+=" rotateZ("+s.rotate.z+")",a+=" rotateZ(0)"),n+="; opacity: "+s.opacity+"; ",a+="; opacity: 1; "}var i,n,r,a,o,s=t.config,l=1e3*(parseFloat(s.over)+parseFloat(s.wait));return i=t.domEl.getAttribute("style")?t.domEl.getAttribute("style")+"; visibility: visible; ":"visibility: visible; ",o="-webkit-transition: -webkit-transform "+s.over+" "+s.easing+" "+s.wait+", opacity "+s.over+" "+s.easing+" "+s.wait+"; transition: transform "+s.over+" "+s.easing+" "+s.wait+", opacity "+s.over+" "+s.easing+" "+s.wait+"; -webkit-perspective: 1000;-webkit-backface-visibility: hidden;",r="-webkit-transition: -webkit-transform "+s.over+" "+s.easing+" 0s, opacity "+s.over+" "+s.easing+" 0s; transition: transform "+s.over+" "+s.easing+" 0s, opacity "+s.over+" "+s.easing+" 0s; -webkit-perspective: 1000; -webkit-backface-visibility: hidden; ",n="transform:",a="transform:",e(),n+="-webkit-transform:",a+="-webkit-transform:",e(),{transition:o,initial:n,target:a,reset:r,inline:i,duration:l}},getViewportH:function(){var e=a.config.viewport.clientHeight,i=t.innerHeight;return a.config.viewport===t.document.documentElement&&i>e?i:e},scrollY:function(){return a.config.viewport===t.document.documentElement?t.pageYOffset:a.config.viewport.scrollTop+a.config.viewport.offsetTop},getOffset:function(t){var e=0,i=0;do isNaN(t.offsetTop)||(e+=t.offsetTop),isNaN(t.offsetLeft)||(i+=t.offsetLeft);while(t=t.offsetParent);return{top:e,left:i}},isElemInViewport:function(e){function i(){var t=o+r*l,e=s-r*l,i=a.scrolled+a.getViewportH(),n=a.scrolled;return i>t&&e>n}function n(){var i=e.domEl,n=i.currentStyle||t.getComputedStyle(i,null);return"fixed"===n.position}var r=e.domEl.offsetHeight,o=a.getOffset(e.domEl).top,s=o+r,l=e.config.vFactor||0;return i()||n()},isMobile:function(){var e=navigator.userAgent||navigator.vendor||t.opera;return/(ipad|playbook|silk|android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))?!0:!1},isSupported:function(){for(var t=document.createElement("sensor"),e="Webkit,Moz,O,".split(","),i=("transition "+e.join("transition,")).split(","),n=0;n<i.length;n++)if(""===!t.style[i[n]])return!1;return!0},destroy:function(){var t=a.config.viewport,e=Array.prototype.slice.call(t.querySelectorAll("[data-sr]"));e.forEach(function(t){t.removeAttribute("data-sr")})}},r=function(t){a.blocked||(a.blocked=!0,a.scrolled=a.scrollY(),i(function(){a.animate()}))},n=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},i=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}(),e}(window),scrollReveal}),function(t){var e=new Array,n=new Array;t.fn.doAutosize=function(e){var i=t(this).data("minwidth"),n=t(this).data("maxwidth"),r="",a=t(this),o=t("#"+t(this).data("tester_id"));if(r!==(r=a.val())){var s=r.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");o.html(s);var l=o.width(),d=l+e.comfortZone>=i?l+e.comfortZone:i,h=a.width(),p=h>d&&d>=i||d>i&&n>d;p&&a.width(d)}},t.fn.resetAutosize=function(e){var i=t(this).data("minwidth")||e.minInputWidth||t(this).width(),n=t(this).data("maxwidth")||e.maxInputWidth||t(this).closest(".tagsinput").width()-e.inputPadding,r=t(this),a=t("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:r.css("fontSize"),fontFamily:r.css("fontFamily"),fontWeight:r.css("fontWeight"),letterSpacing:r.css("letterSpacing"),whiteSpace:"nowrap"}),o=t(this).attr("id")+"_autosize_tester";!t("#"+o).length>0&&(a.attr("id",o),a.appendTo("body")),r.data("minwidth",i),r.data("maxwidth",n),r.data("tester_id",o),r.css("width",i)},t.fn.addTag=function(i,r){return r=jQuery.extend({focus:!1,callback:!0},r),this.each(function(){var a=t(this).attr("id"),o=t(this).val().split(e[a]);if(""==o[0]&&(o=new Array),i=jQuery.trim(i),r.unique){var s=t(this).tagExist(i);1==s&&t("#"+a+"_tag").addClass("not_valid")}else var s=!1;if(""!=i&&1!=s){if(t("<span>").addClass("tag").append(t("<span>").text(i).append("&nbsp;&nbsp;"),t("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return t("#"+a).removeTag(escape(i))})).insertBefore("#"+a+"_addTag"),o.push(i),t("#"+a+"_tag").val(""),r.focus?t("#"+a+"_tag").focus():t("#"+a+"_tag").blur(),t.fn.tagsInput.updateTagsField(this,o),r.callback&&n[a]&&n[a].onAddTag){var l=n[a].onAddTag;l.call(this,i)}if(n[a]&&n[a].onChange){var d=o.length,l=n[a].onChange;l.call(this,t(this),o[d-1])}}}),!1},t.fn.removeTag=function(r){return r=unescape(r),this.each(function(){var a=t(this).attr("id"),o=t(this).val().split(e[a]);for(t("#"+a+"_tagsinput .tag").remove(),str="",i=0;i<o.length;i++)o[i]!=r&&(str=str+e[a]+o[i]);if(t.fn.tagsInput.importTags(this,str),n[a]&&n[a].onRemoveTag){var s=n[a].onRemoveTag;s.call(this,r)}}),!1},t.fn.tagExist=function(i){var n=t(this).attr("id"),r=t(this).val().split(e[n]);return jQuery.inArray(i,r)>=0},t.fn.importTags=function(e){var i=t(this).attr("id");t("#"+i+"_tagsinput .tag").remove(),t.fn.tagsInput.importTags(this,e)},t.fn.tagsInput=function(i){var a=jQuery.extend({interactive:!0,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},i),o=0;return this.each(function(){if("undefined"==typeof t(this).attr("data-tagsinput-init")){t(this).attr("data-tagsinput-init",!0),a.hide&&t(this).hide();var i=t(this).attr("id");(!i||e[t(this).attr("id")])&&(i=t(this).attr("id","tags"+(new Date).getTime()+o++).attr("id"));var s=jQuery.extend({pid:i,real_input:"#"+i,holder:"#"+i+"_tagsinput",input_wrapper:"#"+i+"_addTag",fake_input:"#"+i+"_tag"},a);e[i]=s.delimiter,(a.onAddTag||a.onRemoveTag||a.onChange)&&(n[i]=new Array,n[i].onAddTag=a.onAddTag,n[i].onRemoveTag=a.onRemoveTag,n[i].onChange=a.onChange);var l='<div id="'+i+'_tagsinput" class="tagsinput"><div id="'+i+'_addTag">';if(a.interactive&&(l=l+'<input id="'+i+'_tag" value="" data-default="'+a.defaultText+'" />'),l+='</div><div class="tags_clear"></div></div>',t(l).insertAfter(this),t(s.holder).css("width",a.width),t(s.holder).css("min-height",a.height),t(s.holder).css("height",a.height),""!=t(s.real_input).val()&&t.fn.tagsInput.importTags(t(s.real_input),t(s.real_input).val()),a.interactive){if(t(s.fake_input).val(t(s.fake_input).attr("data-default")),t(s.fake_input).css("color",a.placeholderColor),t(s.fake_input).resetAutosize(a),t(s.holder).bind("click",s,function(e){t(e.data.fake_input).focus()}),t(s.fake_input).bind("focus",s,function(e){t(e.data.fake_input).val()==t(e.data.fake_input).attr("data-default")&&t(e.data.fake_input).val(""),t(e.data.fake_input).css("color","#000000")}),void 0!=a.autocomplete_url){autocomplete_options={source:a.autocomplete_url};for(attrname in a.autocomplete)autocomplete_options[attrname]=a.autocomplete[attrname];void 0!==jQuery.Autocompleter?(t(s.fake_input).autocomplete(a.autocomplete_url,a.autocomplete),t(s.fake_input).bind("result",s,function(e,n,r){n&&t("#"+i).addTag(n[0]+"",{focus:!0,unique:a.unique})})):void 0!==jQuery.ui.autocomplete&&(t(s.fake_input).autocomplete(autocomplete_options),t(s.fake_input).bind("autocompleteselect",s,function(e,i){return t(e.data.real_input).addTag(i.item.value,{focus:!0,unique:a.unique}),!1}))}else t(s.fake_input).bind("blur",s,function(e){var i=t(this).attr("data-default");return""!=t(e.data.fake_input).val()&&t(e.data.fake_input).val()!=i?e.data.minChars<=t(e.data.fake_input).val().length&&(!e.data.maxChars||e.data.maxChars>=t(e.data.fake_input).val().length)&&t(e.data.real_input).addTag(t(e.data.fake_input).val(),{focus:!0,unique:a.unique}):(t(e.data.fake_input).val(t(e.data.fake_input).attr("data-default")),t(e.data.fake_input).css("color",a.placeholderColor)),!1});t(s.fake_input).bind("keypress",s,function(e){return r(e)?(e.preventDefault(),e.data.minChars<=t(e.data.fake_input).val().length&&(!e.data.maxChars||e.data.maxChars>=t(e.data.fake_input).val().length)&&t(e.data.real_input).addTag(t(e.data.fake_input).val(),{focus:!0,unique:a.unique}),t(e.data.fake_input).resetAutosize(a),!1):void(e.data.autosize&&t(e.data.fake_input).doAutosize(a))}),s.removeWithBackspace&&t(s.fake_input).bind("keydown",function(e){if(8==e.keyCode&&""==t(this).val()){e.preventDefault();var i=t(this).closest(".tagsinput").find(".tag:last").text(),n=t(this).attr("id").replace(/_tag$/,"");i=i.replace(/[\s]+x$/,""),t("#"+n).removeTag(escape(i)),t(this).trigger("focus")}}),t(s.fake_input).blur(),s.unique&&t(s.fake_input).keydown(function(e){(8==e.keyCode||String.fromCharCode(e.which).match(/\w+|[,/]+/))&&t(this).removeClass("not_valid")})}}}),this},t.fn.tagsInput.updateTagsField=function(i,n){var r=t(i).attr("id");t(i).val(n.join(e[r]))},t.fn.tagsInput.importTags=function(r,a){t(r).val("");var o=t(r).attr("id"),s=a.split(e[o]);for(i=0;i<s.length;i++)t(r).addTag(s[i],{focus:!1,callback:!1});if(n[o]&&n[o].onChange){var l=n[o].onChange;l.call(r,r,s[i])}};var r=function(e){var i=!1;return 13==e.which?!0:("string"==typeof e.data.delimiter?e.which==e.data.delimiter.charCodeAt(0)&&(i=!0):t.each(e.data.delimiter,function(t,n){e.which==n.charCodeAt(0)&&(i=!0)}),i)}}(jQuery),function(){function t(t){function e(e,i,n,r,a,o){for(;a>=0&&o>a;a+=t){var s=r?r[a]:a;n=i(n,e[s],s,e)}return n}return function(i,n,r,a){n=y(n,a,4);var o=!C(i)&&b.keys(i),s=(o||i).length,l=t>0?0:s-1;return arguments.length<3&&(r=i[o?o[l]:l],l+=t),e(i,n,r,o,l,s)}}function e(t){return function(e,i,n){i=w(i,n);for(var r=x(e),a=t>0?0:r-1;a>=0&&r>a;a+=t)if(i(e[a],a,e))return a;return-1}}function i(t,e,i){return function(n,r,a){var o=0,s=x(n);if("number"==typeof a)t>0?o=a>=0?a:Math.max(a+s,o):s=a>=0?Math.min(a+1,s):a+s+1;else if(i&&a&&s)return a=i(n,r),n[a]===r?a:-1;if(r!==r)return a=e(h.call(n,o,s),b.isNaN),a>=0?a+o:-1;for(a=t>0?o:s-1;a>=0&&s>a;a+=t)if(n[a]===r)return a;return-1}}function n(t,e){var i=A.length,n=t.constructor,r=b.isFunction(n)&&n.prototype||s,a="constructor";for(b.has(t,a)&&!b.contains(e,a)&&e.push(a);i--;)a=A[i],a in t&&t[a]!==r[a]&&!b.contains(e,a)&&e.push(a)}var r=this,a=r._,o=Array.prototype,s=Object.prototype,l=Function.prototype,d=o.push,h=o.slice,p=s.toString,c=s.hasOwnProperty,u=Array.isArray,f=Object.keys,m=l.bind,g=Object.create,v=function(){},b=function(t){return t instanceof b?t:this instanceof b?void(this._wrapped=t):new b(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports._=b):r._=b,b.VERSION="1.8.3";var y=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,a){return t.call(e,i,n,r,a)}}return function(){return t.apply(e,arguments)}},w=function(t,e,i){return null==t?b.identity:b.isFunction(t)?y(t,e,i):b.isObject(t)?b.matcher(t):b.property(t)};b.iteratee=function(t,e){return w(t,e,1/0)};var E=function(t,e){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var r=1;n>r;r++)for(var a=arguments[r],o=t(a),s=o.length,l=0;s>l;l++){var d=o[l];e&&void 0!==i[d]||(i[d]=a[d])}return i}},$=function(t){if(!b.isObject(t))return{};if(g)return g(t);v.prototype=t;var e=new v;return v.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},_=Math.pow(2,53)-1,x=k("length"),C=function(t){var e=x(t);return"number"==typeof e&&e>=0&&_>=e};b.each=b.forEach=function(t,e,i){e=y(e,i);var n,r;if(C(t))for(n=0,r=t.length;r>n;n++)e(t[n],n,t);else{var a=b.keys(t);for(n=0,r=a.length;r>n;n++)e(t[a[n]],a[n],t)}return t},b.map=b.collect=function(t,e,i){e=w(e,i);for(var n=!C(t)&&b.keys(t),r=(n||t).length,a=Array(r),o=0;r>o;o++){var s=n?n[o]:o;a[o]=e(t[s],s,t)}return a},b.reduce=b.foldl=b.inject=t(1),b.reduceRight=b.foldr=t(-1),b.find=b.detect=function(t,e,i){var n;return n=C(t)?b.findIndex(t,e,i):b.findKey(t,e,i),void 0!==n&&-1!==n?t[n]:void 0},b.filter=b.select=function(t,e,i){var n=[];return e=w(e,i),b.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},b.reject=function(t,e,i){return b.filter(t,b.negate(w(e)),i)},b.every=b.all=function(t,e,i){e=w(e,i);for(var n=!C(t)&&b.keys(t),r=(n||t).length,a=0;r>a;a++){var o=n?n[a]:a;if(!e(t[o],o,t))return!1}return!0},b.some=b.any=function(t,e,i){e=w(e,i);for(var n=!C(t)&&b.keys(t),r=(n||t).length,a=0;r>a;a++){var o=n?n[a]:a;if(e(t[o],o,t))return!0}return!1},b.contains=b.includes=b.include=function(t,e,i,n){return C(t)||(t=b.values(t)),("number"!=typeof i||n)&&(i=0),b.indexOf(t,e,i)>=0},b.invoke=function(t,e){var i=h.call(arguments,2),n=b.isFunction(e);return b.map(t,function(t){var r=n?e:t[e];return null==r?r:r.apply(t,i)})},b.pluck=function(t,e){return b.map(t,b.property(e))},b.where=function(t,e){return b.filter(t,b.matcher(e))},b.findWhere=function(t,e){return b.find(t,b.matcher(e))},b.max=function(t,e,i){var n,r,a=-(1/0),o=-(1/0);if(null==e&&null!=t){t=C(t)?t:b.values(t);for(var s=0,l=t.length;l>s;s++)n=t[s],n>a&&(a=n)}else e=w(e,i),b.each(t,function(t,i,n){r=e(t,i,n),(r>o||r===-(1/0)&&a===-(1/0))&&(a=t,o=r)});return a},b.min=function(t,e,i){var n,r,a=1/0,o=1/0;if(null==e&&null!=t){t=C(t)?t:b.values(t);for(var s=0,l=t.length;l>s;s++)n=t[s],a>n&&(a=n)}else e=w(e,i),b.each(t,function(t,i,n){r=e(t,i,n),(o>r||r===1/0&&a===1/0)&&(a=t,o=r)});return a},b.shuffle=function(t){for(var e,i=C(t)?t:b.values(t),n=i.length,r=Array(n),a=0;n>a;a++)e=b.random(0,a),e!==a&&(r[a]=r[e]),r[e]=i[a];return r},b.sample=function(t,e,i){return null==e||i?(C(t)||(t=b.values(t)),t[b.random(t.length-1)]):b.shuffle(t).slice(0,Math.max(0,e))},b.sortBy=function(t,e,i){return e=w(e,i),b.pluck(b.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var T=function(t){return function(e,i,n){var r={};return i=w(i,n),b.each(e,function(n,a){var o=i(n,a,e);t(r,n,o)}),r}};b.groupBy=T(function(t,e,i){b.has(t,i)?t[i].push(e):t[i]=[e]}),b.indexBy=T(function(t,e,i){t[i]=e}),b.countBy=T(function(t,e,i){b.has(t,i)?t[i]++:t[i]=1}),b.toArray=function(t){return t?b.isArray(t)?h.call(t):C(t)?b.map(t,b.identity):b.values(t):[]},b.size=function(t){return null==t?0:C(t)?t.length:b.keys(t).length},b.partition=function(t,e,i){e=w(e,i);var n=[],r=[];return b.each(t,function(t,i,a){(e(t,i,a)?n:r).push(t)}),[n,r]},b.first=b.head=b.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:b.initial(t,t.length-e)},b.initial=function(t,e,i){return h.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},b.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:b.rest(t,Math.max(0,t.length-e))},b.rest=b.tail=b.drop=function(t,e,i){return h.call(t,null==e||i?1:e)},b.compact=function(t){return b.filter(t,b.identity)};var S=function(t,e,i,n){for(var r=[],a=0,o=n||0,s=x(t);s>o;o++){var l=t[o];if(C(l)&&(b.isArray(l)||b.isArguments(l))){e||(l=S(l,e,i));var d=0,h=l.length;for(r.length+=h;h>d;)r[a++]=l[d++]}else i||(r[a++]=l)}return r};b.flatten=function(t,e){return S(t,e,!1)},b.without=function(t){return b.difference(t,h.call(arguments,1))},b.uniq=b.unique=function(t,e,i,n){b.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=w(i,n));for(var r=[],a=[],o=0,s=x(t);s>o;o++){var l=t[o],d=i?i(l,o,t):l;e?(o&&a===d||r.push(l),a=d):i?b.contains(a,d)||(a.push(d),r.push(l)):b.contains(r,l)||r.push(l)}return r},b.union=function(){return b.uniq(S(arguments,!0,!0))},b.intersection=function(t){for(var e=[],i=arguments.length,n=0,r=x(t);r>n;n++){var a=t[n];if(!b.contains(e,a)){for(var o=1;i>o&&b.contains(arguments[o],a);o++);o===i&&e.push(a)}}return e},b.difference=function(t){var e=S(arguments,!0,!0,1);return b.filter(t,function(t){return!b.contains(e,t)})},b.zip=function(){return b.unzip(arguments)},b.unzip=function(t){for(var e=t&&b.max(t,x).length||0,i=Array(e),n=0;e>n;n++)i[n]=b.pluck(t,n);return i},b.object=function(t,e){for(var i={},n=0,r=x(t);r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},b.findIndex=e(1),b.findLastIndex=e(-1),b.sortedIndex=function(t,e,i,n){i=w(i,n,1);for(var r=i(e),a=0,o=x(t);o>a;){var s=Math.floor((a+o)/2);i(t[s])<r?a=s+1:o=s}return a},b.indexOf=i(1,b.findIndex,b.sortedIndex),b.lastIndexOf=i(-1,b.findLastIndex),b.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),a=0;n>a;a++,t+=i)r[a]=t;return r};var I=function(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var a=$(t.prototype),o=t.apply(a,r);return b.isObject(o)?o:a};b.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,h.call(arguments,1));if(!b.isFunction(t))throw new TypeError("Bind must be called on a function");var i=h.call(arguments,2),n=function(){return I(t,n,e,this,i.concat(h.call(arguments)))};return n},b.partial=function(t){var e=h.call(arguments,1),i=function(){for(var n=0,r=e.length,a=Array(r),o=0;r>o;o++)a[o]=e[o]===b?arguments[n++]:e[o];for(;n<arguments.length;)a.push(arguments[n++]);return I(t,i,this,this,a)};return i},b.bindAll=function(t){var e,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=b.bind(t[i],t);return t},b.memoize=function(t,e){var i=function(n){var r=i.cache,a=""+(e?e.apply(this,arguments):n);return b.has(r,a)||(r[a]=t.apply(this,arguments)),r[a]};return i.cache={},i},b.delay=function(t,e){var i=h.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},b.defer=b.partial(b.delay,b,1),b.throttle=function(t,e,i){var n,r,a,o=null,s=0;i||(i={});var l=function(){s=i.leading===!1?0:b.now(),o=null,a=t.apply(n,r),o||(n=r=null)};return function(){var d=b.now();s||i.leading!==!1||(s=d);var h=e-(d-s);return n=this,r=arguments,0>=h||h>e?(o&&(clearTimeout(o),o=null),s=d,a=t.apply(n,r),o||(n=r=null)):o||i.trailing===!1||(o=setTimeout(l,h)),a}},b.debounce=function(t,e,i){var n,r,a,o,s,l=function(){var d=b.now()-o;e>d&&d>=0?n=setTimeout(l,e-d):(n=null,i||(s=t.apply(a,r),n||(a=r=null)))};return function(){a=this,r=arguments,o=b.now();var d=i&&!n;return n||(n=setTimeout(l,e)),d&&(s=t.apply(a,r),a=r=null),s}},b.wrap=function(t,e){return b.partial(e,t)},b.negate=function(t){return function(){return!t.apply(this,arguments)}},b.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},b.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},b.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),1>=t&&(e=null),i}},b.once=b.partial(b.before,2);var L=!{toString:null}.propertyIsEnumerable("toString"),A=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];b.keys=function(t){if(!b.isObject(t))return[];if(f)return f(t);var e=[];for(var i in t)b.has(t,i)&&e.push(i);return L&&n(t,e),e},b.allKeys=function(t){if(!b.isObject(t))return[];var e=[];for(var i in t)e.push(i);return L&&n(t,e),e},b.values=function(t){for(var e=b.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},b.mapObject=function(t,e,i){e=w(e,i);for(var n,r=b.keys(t),a=r.length,o={},s=0;a>s;s++)n=r[s],o[n]=e(t[n],n,t);return o},b.pairs=function(t){for(var e=b.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},b.invert=function(t){for(var e={},i=b.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},b.functions=b.methods=function(t){var e=[];for(var i in t)b.isFunction(t[i])&&e.push(i);return e.sort()},b.extend=E(b.allKeys),b.extendOwn=b.assign=E(b.keys),b.findKey=function(t,e,i){e=w(e,i);for(var n,r=b.keys(t),a=0,o=r.length;o>a;a++)if(n=r[a],e(t[n],n,t))return n},b.pick=function(t,e,i){var n,r,a={},o=t;if(null==o)return a;b.isFunction(e)?(r=b.allKeys(o),n=y(e,i)):(r=S(arguments,!1,!1,1),n=function(t,e,i){return e in i},o=Object(o));for(var s=0,l=r.length;l>s;s++){var d=r[s],h=o[d];n(h,d,o)&&(a[d]=h)}return a},b.omit=function(t,e,i){if(b.isFunction(e))e=b.negate(e);else{var n=b.map(S(arguments,!1,!1,1),String);e=function(t,e){return!b.contains(n,e)}}return b.pick(t,e,i)},b.defaults=E(b.allKeys,!0),b.create=function(t,e){var i=$(t);return e&&b.extendOwn(i,e),i},b.clone=function(t){return b.isObject(t)?b.isArray(t)?t.slice():b.extend({},t):t},b.tap=function(t,e){return e(t),t},b.isMatch=function(t,e){var i=b.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),a=0;n>a;a++){var o=i[a];if(e[o]!==r[o]||!(o in r))return!1}return!0};var N=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof b&&(t=t._wrapped),e instanceof b&&(e=e._wrapped);var r=p.call(t);if(r!==p.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var a="[object Array]"===r;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,s=e.constructor;if(o!==s&&!(b.isFunction(o)&&o instanceof o&&b.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),a){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!N(t[l],e[l],i,n))return!1}else{var d,h=b.keys(t);if(l=h.length,b.keys(e).length!==l)return!1;for(;l--;)if(d=h[l],!b.has(e,d)||!N(t[d],e[d],i,n))return!1}return i.pop(),n.pop(),!0};b.isEqual=function(t,e){return N(t,e)},b.isEmpty=function(t){return null==t?!0:C(t)&&(b.isArray(t)||b.isString(t)||b.isArguments(t))?0===t.length:0===b.keys(t).length},b.isElement=function(t){return!(!t||1!==t.nodeType)},b.isArray=u||function(t){return"[object Array]"===p.call(t)},b.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},b.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){b["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),b.isArguments(arguments)||(b.isArguments=function(t){return b.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(b.isFunction=function(t){return"function"==typeof t||!1}),b.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},b.isNaN=function(t){return b.isNumber(t)&&t!==+t},b.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===p.call(t)},b.isNull=function(t){return null===t},b.isUndefined=function(t){return void 0===t},b.has=function(t,e){return null!=t&&c.call(t,e)},b.noConflict=function(){return r._=a,this},b.identity=function(t){return t},b.constant=function(t){return function(){return t}},b.noop=function(){},b.property=k,b.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},b.matcher=b.matches=function(t){return t=b.extendOwn({},t),function(e){return b.isMatch(e,t)}},b.times=function(t,e,i){var n=Array(Math.max(0,t));e=y(e,i,1);for(var r=0;t>r;r++)n[r]=e(r);return n},b.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},b.now=Date.now||function(){return(new Date).getTime()};var R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},D=b.invert(R),M=function(t){var e=function(e){return t[e]},i="(?:"+b.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}};b.escape=M(R),b.unescape=M(D),b.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),b.isFunction(n)?n.call(t):n};var B=0;b.uniqueId=function(t){var e=++B+"";

return t?t+e:e},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\u2028|\u2029/g,U=function(t){return"\\"+P[t]};b.template=function(t,e,i){!e&&i&&(e=i),e=b.defaults({},e,b.templateSettings);var n=RegExp([(e.escape||O).source,(e.interpolate||O).source,(e.evaluate||O).source].join("|")+"|$","g"),r=0,a="__p+='";t.replace(n,function(e,i,n,o,s){return a+=t.slice(r,s).replace(F,U),r=s+e.length,i?a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var o=new Function(e.variable||"obj","_",a)}catch(s){throw s.source=a,s}var l=function(t){return o.call(this,t,b)},d=e.variable||"obj";return l.source="function("+d+"){\n"+a+"}",l},b.chain=function(t){var e=b(t);return e._chain=!0,e};var H=function(t,e){return t._chain?b(e).chain():e};b.mixin=function(t){b.each(b.functions(t),function(e){var i=b[e]=t[e];b.prototype[e]=function(){var t=[this._wrapped];return d.apply(t,arguments),H(this,i.apply(b,t))}})},b.mixin(b),b.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];b.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],H(this,i)}}),b.each(["concat","join","slice"],function(t){var e=o[t];b.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),b.prototype.value=function(){return this._wrapped},b.prototype.valueOf=b.prototype.toJSON=b.prototype.value,b.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return b})}.call(this),Sanitize.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i,Sanitize.RELATIVE="__RELATIVE__",Sanitize.ALL="__ALL__",Sanitize.prototype.clean_node=function(t){function e(t,e){var i;for(i=0;i<e.length;i++)if(e[i]==t)return i;return-1}function n(){var t,e,i=[],n={};for(t=0;t<arguments.length;t++)if(arguments[t]&&arguments[t].length)for(e=0;e<arguments[t].length;e++)n[arguments[t][e]]||(n[arguments[t][e]]=!0,i.push(arguments[t][e]));return i}function r(t){var e;switch(t.nodeType){case 1:a.call(this,t);break;case 3:e=t.cloneNode(!1),this.current_element.appendChild(e);break;case 5:e=t.cloneNode(!1),this.current_element.appendChild(e);break;case 8:this.config.allow_comments&&(e=t.cloneNode(!1),this.current_element.appendChild(e));break;default:console&&console.log&&console.log("unknown node type",t.nodeType)}}function a(t){var i,a,s,l,d,h,p,c,u,f,m=o.call(this,t);if(t=m.node,s=t.nodeName.toLowerCase(),a=this.current_element,this.allowed_elements[s]||m.whitelist){this.current_element=this.dom.createElement(t.nodeName),a.appendChild(this.current_element);var g=this.config.attributes;for(l=n(g[s],g[Sanitize.ALL],m.attr_whitelist),i=0;i<l.length;i++)h=l[i],d=t.attributes[h],d&&(f=!0,this.config.protocols[s]&&this.config.protocols[s][h]&&(c=this.config.protocols[s][h],u=d.value.toLowerCase().match(Sanitize.REGEX_PROTOCOL),f=u?-1!=e(u[1],c):-1!=e(Sanitize.RELATIVE,c)),f&&(p=document.createAttribute(h),p.value=d.value,this.current_element.setAttributeNode(p)));if(this.config.add_attributes[s])for(h in this.config.add_attributes[s])p=document.createAttribute(h),p.value=this.config.add_attributes[s][h],this.current_element.setAttributeNode(p)}else if(-1!=e(t,this.whitelist_nodes)){for(this.current_element=t.cloneNode(!0);this.current_element.childNodes.length>0;)this.current_element.removeChild(this.current_element.firstChild);a.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[s])for(i=0;i<t.childNodes.length;i++)r.call(this,t.childNodes[i]);this.current_element.normalize&&this.current_element.normalize(),this.current_element=a}function o(t){var i,r,a,o={attr_whitelist:[],node:t,whitelist:!1};for(i=0;i<this.transformers.length;i++)if(a=this.transformers[i]({allowed_elements:this.allowed_elements,config:this.config,node:t,node_name:t.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!=a){if("object"!=typeof a)throw new Error("transformer output must be an object or null");if(a.whitelist_nodes&&a.whitelist_nodes instanceof Array)for(r=0;r<a.whitelist_nodes.length;r++)-1==e(a.whitelist_nodes[r],this.whitelist_nodes)&&this.whitelist_nodes.push(a.whitelist_nodes[r]);o.whitelist=a.whitelist?!0:!1,a.attr_whitelist&&(o.attr_whitelist=n(o.attr_whitelist,a.attr_whitelist)),o.node=a.node?a.node:o.node}return o}var s=this.dom.createDocumentFragment();for(this.current_element=s,this.whitelist_nodes=[],i=0;i<t.childNodes.length;i++)r.call(this,t.childNodes[i]);return s.normalize&&s.normalize(),s},"function"==typeof define&&define("sanitize",[],function(){return Sanitize}),function(t,e){"object"==typeof exports?module.exports=e(require("spin.js")):"function"==typeof define&&define.amd?define(["spin"],e):t.Ladda=e(t.Spinner)}(this,function(t){"use strict";function e(t){if(void 0===t)return void console.warn("Ladda button target must be defined.");t.querySelector(".ladda-label")||(t.innerHTML='<span class="ladda-label">'+t.innerHTML+"</span>");var e,i=t.querySelector(".ladda-spinner");i||(i=document.createElement("span"),i.className="ladda-spinner"),t.appendChild(i);var n,r={start:function(){return e||(e=o(t)),t.setAttribute("disabled",""),t.setAttribute("data-loading",""),clearTimeout(n),e.spin(i),this.setProgress(0),this},startAfter:function(t){return clearTimeout(n),n=setTimeout(function(){r.start()},t),this},stop:function(){return t.removeAttribute("disabled"),t.removeAttribute("data-loading"),clearTimeout(n),e&&(n=setTimeout(function(){e.stop()},1e3)),this},toggle:function(){return this.isLoading()?this.stop():this.start(),this},setProgress:function(e){e=Math.max(Math.min(e,1),0);var i=t.querySelector(".ladda-progress");0===e&&i&&i.parentNode?i.parentNode.removeChild(i):(i||(i=document.createElement("div"),i.className="ladda-progress",t.appendChild(i)),i.style.width=(e||0)*t.offsetWidth+"px")},enable:function(){return this.stop(),this},disable:function(){return this.stop(),t.setAttribute("disabled",""),this},isLoading:function(){return t.hasAttribute("data-loading")},remove:function(){clearTimeout(n),t.removeAttribute("disabled",""),t.removeAttribute("data-loading",""),e&&(e.stop(),e=null);for(var i=0,a=l.length;a>i;i++)if(r===l[i]){l.splice(i,1);break}}};return l.push(r),r}function i(t,e){for(;t.parentNode&&t.tagName!==e;)t=t.parentNode;return e===t.tagName?t:void 0}function n(t){for(var e=["input","textarea","select"],i=[],n=0;e.length>n;n++)for(var r=t.getElementsByTagName(e[n]),a=0;r.length>a;a++)r[a].hasAttribute("required")&&i.push(r[a]);return i}function r(t,r){r=r||{};var a=[];"string"==typeof t?a=s(document.querySelectorAll(t)):"object"==typeof t&&"string"==typeof t.nodeName&&(a=[t]);for(var o=0,l=a.length;l>o;o++)(function(){var t=a[o];if("function"==typeof t.addEventListener){var s=e(t),l=-1;t.addEventListener("click",function(){var e=!0,a=i(t,"FORM");if(void 0!==a)for(var o=n(a),d=0;o.length>d;d++)""===o[d].value.replace(/^\s+|\s+$/g,"")&&(e=!1),"checkbox"!==o[d].type&&"radio"!==o[d].type||o[d].checked||(e=!1),"email"===o[d].type&&(e=/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(o[d].value));e&&(s.startAfter(1),"number"==typeof r.timeout&&(clearTimeout(l),l=setTimeout(s.stop,r.timeout)),"function"==typeof r.callback&&r.callback.apply(null,[s]))},!1)}})()}function a(){for(var t=0,e=l.length;e>t;t++)l[t].stop()}function o(e){var i,n=e.offsetHeight;0===n&&(n=parseFloat(window.getComputedStyle(e).height)),n>32&&(n*=.8),e.hasAttribute("data-spinner-size")&&(n=parseInt(e.getAttribute("data-spinner-size"),10)),e.hasAttribute("data-spinner-color")&&(i=e.getAttribute("data-spinner-color"));var r=12,a=.2*n,o=.6*a,s=7>a?2:3;return new t({color:i||"#fff",lines:r,radius:a,length:o,width:s,zIndex:"auto",top:"auto",left:"auto",className:""})}function s(t){for(var e=[],i=0;t.length>i;i++)e.push(t[i]);return e}var l=[];return{bind:r,create:e,stopAll:a}}),function(){window.Dante={Editor:{ToolTip:{},PopOver:{},Menu:{}},defaults:{image_placeholder:"../images/dante/media-loading-placeholder.png"},version:"0.0.14"}}.call(this),function(){var t,e,i,n;String.prototype.killWhiteSpace=function(){return this.replace(/\s/g,"")},String.prototype.reduceWhiteSpace=function(){return this.replace(/\s+/g," ")},n={},window.Dante.utils=n,n.log=function(t,e){return window.debugMode||e?console.log(t):void 0},n.getBase64Image=function(t){var e,i,n;return e=document.createElement("canvas"),e.width=t.width,e.height=t.height,i=e.getContext("2d"),i.drawImage(t,0,0),n=e.toDataURL("image/png")},n.generateUniqueName=function(){return Math.random().toString(36).slice(8)},n.saveSelection=function(){var t,e,i,n;if(window.getSelection){if(n=window.getSelection(),n.getRangeAt&&n.rangeCount){for(i=[],t=0,e=n.rangeCount;e>t;)i.push(n.getRangeAt(t)),++t;return i}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},n.restoreSelection=function(t){var e,i,n;if(t)if(window.getSelection)for(n=window.getSelection(),n.removeAllRanges(),e=0,i=t.length;i>e;)n.addRange(t[e]),++e;else document.selection&&t.select&&t.select()},n.getNode=function(){var t,e,i;return e=void 0,i=void 0,t=void 0,document.selection&&document.selection.createRange?(e=document.selection.createRange(),e.parentElement()):window.getSelection&&(i=window.getSelection(),i.getRangeAt?i.rangeCount>0&&(e=i.getRangeAt(0)):(e=document.createRange(),e.setStart(i.anchorNode,i.anchorOffset),e.setEnd(i.focusNode,i.focusOffset),e.collapsed!==i.isCollapsed&&(e.setStart(i.focusNode,i.focusOffset),e.setEnd(i.anchorNode,i.anchorOffset))),e)?(t=e.commonAncestorContainer,3===t.nodeType?t.parentNode:t):void 0},n.getSelectionDimensions=function(){var t,e,i,n,r,a,o;return r=document.selection,i=void 0,o=0,t=0,e=0,a=0,r?"Control"!==r.type&&(i=r.createRange(),o=i.boundingWidth,t=i.boundingHeight):window.getSelection&&(r=window.getSelection(),r.rangeCount&&(i=r.getRangeAt(0).cloneRange(),i.getBoundingClientRect&&(n=i.getBoundingClientRect(),o=n.right-n.left,t=n.bottom-n.top))),{width:o,height:t,top:n.top,left:n.left}},n.getCaretPosition=function(t){var e,i,n,r,a,o;return e=0,i=null,r=void 0,n=void 0,window.getSelection?(r=window.getSelection(),r.rangeCount&&(n=r.getRangeAt(0),n.commonAncestorContainer.parentNode===t&&(e=n.endOffset))):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),n.parentElement()===t&&(a=document.createElement("span"),t.insertBefore(a,t.firstChild),o=n.duplicate(),o.moveToElementText(a),o.setEndPoint("EndToEnd",n),e=o.text.length)),e},n.isElementInViewport=function(t){var e;return"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]),e=t.getBoundingClientRect(),e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},t=20,i=function(t,e){var i;return i=document.createRange(),i.selectNodeContents(t),i.setEnd(e.startContainer,e.startOffset),0===i.toString().trim().length},e=function(t,e){var i;return i=document.createRange(),i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),0===i.toString().trim().length},$.fn.editableIsCaret=function(){return"Caret"===window.getSelection().type},$.fn.editableRange=function(){var t;return t=window.getSelection(),t.rangeCount>0?t.getRangeAt(0):void 0},$.fn.editableCaretRange=function(){return this.editableIsCaret()?this.editableRange():void 0},$.fn.editableSetRange=function(t){var e;return e=window.getSelection(),e.rangeCount>0&&e.removeAllRanges(),e.addRange(t)},$.fn.editableFocus=function(t){var e,i;return null==t&&(t=!0),this.attr("contenteditable")?(i=window.getSelection(),i.rangeCount>0&&i.removeAllRanges(),e=document.createRange(),e.selectNodeContents(this[0]),e.collapse(t),i.addRange(e)):void 0},$.fn.editableCaretAtStart=function(){var t;return t=this.editableRange(),t?i(this[0],t):!1},$.fn.editableCaretAtEnd=function(){var t;return t=this.editableRange(),t?e(this[0],t):!1},$.fn.editableCaretOnFirstLine=function(){var n,r,a;return(a=this.editableRange())?i(this[0],a)?!0:(n=e(this[0],a)?this[0].getBoundingClientRect().bottom-t:a.getClientRects()[0].top,r=this[0].getBoundingClientRect().top,r+t>n):!1},$.fn.editableCaretOnLastLine=function(){var n,r,a;return(a=this.editableRange())?e(this[0],a)?!0:(n=i(this[0],a)?this[0].getBoundingClientRect().top+t:a.getClientRects()[0].bottom,r=this[0].getBoundingClientRect().bottom,n>r-t):!1},$.fn.exists=function(){return this.length>0}}.call(this),function(){var t;Dante.View=function(){function t(t){null==t&&(t={}),t.el&&(this.el=t.el),this._ensureElement(),this.initialize.apply(this,arguments),this._ensureEvents()}return t.prototype.initialize=function(t){null==t&&(t={})},t.prototype.events=function(){},t.prototype.render=function(){return this},t.prototype.remove=function(){return this._removeElement(),this.stopListening(),this},t.prototype._removeElement=function(){return this.$el.remove()},t.prototype.setElement=function(t){return this._setElement(t),this},t.prototype.setEvent=function(t){return _.isEmpty(t)?void 0:_.each(t,function(t){return function(e,i){var n,r,a;if(a=i.split(" "),_.isFunction(e))r=e;else{if(!_.isString(e))throw"error event needs a function or string";r=t[e]}return n=a.length>1?a.splice(1,3).join(" "):null,$(t.el).on(a[0],n,_.bind(r,t))}}(this))},t.prototype._ensureElement=function(){return this.setElement(_.result(this,"el"))},t.prototype._ensureEvents=function(){return this.setEvent(_.result(this,"events"))},t.prototype._setElement=function(t){return this.$el=t instanceof $?t:$(t),this.el=this.$el[0]},t}(),t=function(t,e){var i,n,r;return r=this,n=void 0,n=t&&_.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},_.extend(n,r,e),i=function(){this.constructor=n},i.prototype=r.prototype,n.prototype=new i,t&&_.extend(n.prototype,t),n.__super__=r.prototype,n},Dante.View.extend=t}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.Editor=function(i){function r(){return this.setupFirstAndLast=e(this.setupFirstAndLast,this),this.addClassesToElement=e(this.addClassesToElement,this),this.handlePaste=e(this.handlePaste,this),this.handleArrowForKeyDown=e(this.handleArrowForKeyDown,this),this.handleArrow=e(this.handleArrow,this),this.handleMouseUp=e(this.handleMouseUp,this),this.selection=e(this.selection,this),this.render=e(this.render,this),this.restart=e(this.restart,this),this.start=e(this.start,this),this.appendInitialContent=e(this.appendInitialContent,this),this.appendMenus=e(this.appendMenus,this),this.template=e(this.template,this),this.initialize=e(this.initialize,this),r.__super__.constructor.apply(this,arguments)}var a,o,s,l,d,h,p,c;return n(r,i),a=8,p=9,s=13,h=32,l=37,c=38,d=39,o=40,r.prototype.events={mouseup:"handleMouseUp",keydown:"handleKeyDown",keyup:"handleKeyUp",paste:"handlePaste",dblclick:"handleDblclick",dragstart:"handleDrag",drop:"handleDrag","click .graf--figure .aspectRatioPlaceholder":"handleGrafFigureSelectImg","click .graf--figure figcaption":"handleGrafFigureSelectCaption","mouseover .graf--figure.graf--iframe":"handleGrafFigureSelectIframe","mouseleave .graf--figure.graf--iframe":"handleGrafFigureUnSelectIframe","keyup .graf--figure figcaption":"handleGrafCaptionTyping","mouseover .markup--anchor":"displayPopOver","mouseout  .markup--anchor":"hidePopOver"},r.prototype.initialize=function(t){var e,i,n,r,a;return null==t&&(t={}),this.editor_options=t,this.initial_html=$(this.el).html(),this.current_range=null,this.current_node=null,this.el=t.el||"#editor",this.upload_url=t.upload_url||"/uploads.json",this.upload_callback=t.upload_callback,this.oembed_url=t.oembed_url||"http://api.embed.ly/1/oembed?url=",this.extract_url=t.extract_url||"http://api.embed.ly/1/extract?key=86c28a410a104c8bb58848733c82f840&url=",this.default_loading_placeholder=t.default_loading_placeholder||Dante.defaults.image_placeholder,this.store_url=t.store_url,this.store_method=t.store_method||"POST",this.spell_check=t.spellcheck||!1,this.disable_title=t.disable_title||!1,this.store_interval=t.store_interval||15e3,this.paste_element_id="#dante-paste-div",this.tooltip_class=t.tooltip_class||Dante.Editor.Tooltip,t.base_widgets||(t.base_widgets=["uploader","embed","embed_extract"]),this.widgets=[],window.debugMode=t.debug||!1,window.debugMode&&$(this.el).addClass("debug"),localStorage.getItem("contenteditable")&&$(this.el).html(localStorage.getItem("contenteditable")),this.store(),a=t.title_placeholder||"Title",this.title_placeholder="<span class='defaultValue defaultValue--root'>"+a+"</span><br>",r=t.title||"",this.title=r,e=t.body_placeholder||"Tell your story",this.body_placeholder="<span class='defaultValue defaultValue--root'>"+e+"</span><br>",i=t.embed_placeholder||"Paste a YouTube, Vine, Vimeo, or other video link, and press Enter",this.embed_placeholder="<span class='defaultValue defaultValue--root'>"+i+"</span><br>",n=t.extract_placeholder||"Paste a link to embed content from another site (e.g. Twitter) and press Enter",this.extract_placeholder="<span class='defaultValue defaultValue--root'>"+n+"</span><br>",this.initializeWidgets(t)},r.prototype.initializeWidgets=function(t){var e,i;return e=t.base_widgets,i=this,e.indexOf("uploader")>=0&&(this.uploader_widget=new Dante.View.TooltipWidget.Uploader({current_editor:this}),this.widgets.push(this.uploader_widget)),e.indexOf("embed")>=0&&(this.embed_widget=new Dante.View.TooltipWidget.Embed({current_editor:this}),this.widgets.push(this.embed_widget)),e.indexOf("embed_extract")>=0&&(this.embed_extract_widget=new Dante.View.TooltipWidget.EmbedExtract({current_editor:this}),this.widgets.push(this.embed_extract_widget)),t.extra_tooltip_widgets?_.each(t.extra_tooltip_widgets,function(t){return function(e){return e.current_editor||(e.current_editor=i),t.widgets.push(e)}}(this)):void 0},r.prototype.store=function(){return this.store_url?setTimeout(function(t){return function(){return t.checkforStore()}}(this),this.store_interval):void 0},r.prototype.checkforStore=function(){return this.content===this.getContent()?(t.log("content not changed skip store"),this.store()):(t.log("content changed! update"),this.content=this.getContent(),$.ajax({url:this.store_url,method:this.store_method,data:{body:this.getContent()},success:function(e){return t.log("store!"),t.log(e)},complete:function(t){return function(e){return t.store()}}(this)}))},r.prototype.getContent=function(){return $(this.el).find(".section-inner").html()},r.prototype.renderTitle=function(){return"<h3 class='graf graf--h3'>"+(this.title.length>0?this.title:this.title_placeholder)+"</h3>"},r.prototype.template=function(){return"<section class='section--first section--last'> <div class='section-divider layoutSingleColumn'> <hr class='section-divider'> </div> <div class='section-content'> <div class='section-inner layoutSingleColumn'> "+(this.disable_title?"":this.renderTitle())+" <p class='graf graf--p'>"+this.body_placeholder+"<p> </div> </div> </section>"},r.prototype.baseParagraphTmpl=function(){return"<p class='graf--p' name='"+t.generateUniqueName()+"'><br></p>"},r.prototype.appendMenus=function(){return $("<div id='dante-menu' class='dante-menu'></div>").insertAfter(this.el),$("<div class='inlineTooltip'></div>").insertAfter(this.el),this.editor_menu=new Dante.Editor.Menu({editor:this}),this.tooltip_view=new this.tooltip_class({editor:this,widgets:this.widgets}),this.pop_over=new Dante.Editor.PopOver({editor:this}),this.pop_over.render().hide(),this.tooltip_view.render().hide()},r.prototype.appendInitialContent=function(){return $(this.el).find(".section-inner").html(this.initial_html),$(this.el).attr("spellcheck",this.spell_check)},r.prototype.start=function(){return this.render(),$(this.el).attr("contenteditable","true"),$(this.el).addClass("postField postField--body editable smart-media-plugin"),$(this.el).wrap("<article class='postArticle'><div class='postContent'><div class='notesSource'></div></div></article>"),this.appendMenus(),_.isEmpty(this.initial_html.trim())||this.appendInitialContent(),this.parseInitialMess()},r.prototype.restart=function(){return this.render()},r.prototype.render=function(){return this.template(),$(this.el).html(this.template())},r.prototype.getSelectedText=function(){var t;return t="","undefined"!=typeof window.getSelection?t=window.getSelection().toString():"undefined"!=typeof document.selection&&"Text"===document.selection.type&&(t=document.selection.createRange().text),t},r.prototype.selection=function(){var t;return window.getSelection?t=window.getSelection():document.selection&&"Control"!==document.selection.type?t=document.selection:void 0},r.prototype.getRange=function(){var t,e;return t=$(this.el)[0],e=selection&&selection.rangeCount&&selection.getRangeAt(0),e||(e=document.createRange()),t.contains(e.commonAncestorContainer)||(e.selectNodeContents(t),e.collapse(!1)),e},r.prototype.setRange=function(t){return t=t||this.current_range,t||(t=this.getRange(),t.collapse(!1)),this.selection().removeAllRanges(),this.selection().addRange(t),this},r.prototype.getCharacterPrecedingCaret=function(){var t,e,i,n;return t="",n=void 0,i=void 0,e=void 0,window.getSelection?(n=window.getSelection(),n.rangeCount>0&&(i=n.getRangeAt(0).cloneRange(),i.collapse(!0),i.setStart(this.getNode(),0),t=i.toString().slice(0))):(n=document.selection)&&"Control"!==n.type&&(i=n.createRange(),e=i.duplicate(),e.moveToElementText(containerEl),e.setEndPoint("EndToStart",i),t=e.text.slice(0)),t},r.prototype.isLastChar=function(){return $(this.getNode()).text().trim().length===this.getCharacterPrecedingCaret().trim().length},r.prototype.isFirstChar=function(){return 0===this.getCharacterPrecedingCaret().trim().length},r.prototype.isSelectingAll=function(t){var e,i;return e=this.getSelectedText().killWhiteSpace().length,i=$(t).text().killWhiteSpace().length,e===i},r.prototype.setRangeAt=function(t,e){var i,n;return null==e&&(e=0),i=document.createRange(),n=window.getSelection(),i.setStart(t,e),i.collapse(!0),n.removeAllRanges(),n.addRange(i),t.focus()},r.prototype.setRangeAtText=function(t,e){var i,n,r;return null==e&&(e=0),n=document.createRange(),r=window.getSelection(),i=t.firstChild,n.setStart(i,0),n.setEnd(i,0),n.collapse(!0),r.removeAllRanges(),r.addRange(n),t.focus()},r.prototype.focus=function(t){return t||this.setRange(),$(this.el).focus(),this},r.prototype.focusNode=function(t,e){return e.setStartAfter(t),e.setEndBefore(t),e.collapse(!1),this.setRange(e)},r.prototype.getNode=function(){var t,e,i;if(t=void 0,i=$(this.el).find(".section-inner")[0],!(this.selection().rangeCount<1)){if(e=this.selection().getRangeAt(0),t=e.commonAncestorContainer,!t||t===i)return null;for(;t&&(1!==t.nodeType||!$(t).hasClass("graf"))&&t.parentNode!==i;)t=t.parentNode;if(!$(t).hasClass("graf--li"))for(;t&&t.parentNode!==i;)t=t.parentNode;return i&&i.contains(t)?t:null}},r.prototype.displayMenu=function(e){return setTimeout(function(e){return function(){var i;return e.editor_menu.render(),i=t.getSelectionDimensions(),e.relocateMenu(i),e.editor_menu.show()}}(this),10)},r.prototype.handleDrag=function(){return!1},r.prototype.handleGrafCaptionTyping=function(e){return _.isEmpty(t.getNode().textContent.trim())?$(this.getNode()).addClass("is-defaultValue"):$(this.getNode()).removeClass("is-defaultValue")},r.prototype.handleTextSelection=function(t){var e;return this.editor_menu.hide(),e=this.getSelectedText(),$(t).is(".graf--mixtapeEmbed, .graf--figure")||_.isEmpty(e.trim())?void 0:(this.current_node=t,this.displayMenu())},r.prototype.relocateMenu=function(t){var e,i,n,r;return e=this.editor_menu.$el.outerHeight(),n=this.editor_menu.$el.width()/2,r=t.top+$(window).scrollTop()-e,i=t.left+t.width/2-n,this.editor_menu.$el.offset({left:i,top:r})},r.prototype.hidePlaceholder=function(t){return $(t).find("span.defaultValue").remove().html("<br>")},r.prototype.displayEmptyPlaceholder=function(t){return $(".graf--first").html(this.title_placeholder),$(".graf--last").html(this.body_placeholder)},r.prototype.displayPopOver=function(t){return this.pop_over.displayAt(t)},r.prototype.hidePopOver=function(t){return this.pop_over.hide(t)},r.prototype.handleGrafFigureSelectImg=function(e){var i;return t.log("FIGURE SELECT"),i=e.currentTarget,this.markAsSelected(i),$(i).parent(".graf--figure").addClass("is-selected is-mediaFocused"),this.selection().removeAllRanges()},r.prototype.handleGrafFigureSelectIframe=function(e){var i;return t.log("FIGURE IFRAME SELECT"),i=e.currentTarget,this.iframeSelected=i,this.markAsSelected(i),$(i).addClass("is-selected is-mediaFocused"),this.selection().removeAllRanges()},r.prototype.handleGrafFigureUnSelectIframe=function(e){var i;return t.log("FIGURE IFRAME UNSELECT"),i=e.currentTarget,this.iframeSelected=null,$(i).removeClass("is-selected is-mediaFocused")},r.prototype.handleGrafFigureSelectCaption=function(e){var i;return t.log("FIGCAPTION"),i=e.currentTarget,$(i).parent(".graf--figure").removeClass("is-mediaFocused")},r.prototype.handleMouseUp=function(e){var i;return t.log("MOUSE UP"),i=this.getNode(),_.isNull(i)?void 0:(this.prev_current_node=i,this.handleTextSelection(i),this.hidePlaceholder(i),this.markAsSelected(i),this.displayTooltipAt(i))},r.prototype.scrollTo=function(e){var i;if(!t.isElementInViewport($(e)))return i=e.offset().top,$("html, body").animate({scrollTop:i},20)},r.prototype.handleArrow=function(t){var e;return e=$(this.getNode()),e.length>0?(this.markAsSelected(e),this.displayTooltipAt(e)):void 0},r.prototype.handleArrowForKeyDown=function(e){var i,n,r,a,o,s,l;switch(i=this.getNode(),n=$(i),t.log(e),r=e.originalEvent.key||e.originalEvent.keyIdentifier,t.log("ENTER ARROW for key "+r),r){case"Down":if((_.isUndefined(n)||!n.exists())&&$(".is-selected").exists()&&(n=$(".is-selected")),o=n.next(),t.log("NEXT NODE IS "+o.attr("class")),t.log("CURRENT NODE IS "+n.attr("class")),!$(n).hasClass("graf"))return;if(!n.hasClass("graf--figure")&&!$(n).editableCaretOnLastLine())return;if(t.log("ENTER ARROW PASSED RETURNS"),o.hasClass("graf--figure")&&i)return a=o.find(".imageCaption"),this.scrollTo(a),t.log("1 down"),t.log(a[0]),this.skip_keyup=!0,this.selection().removeAllRanges(),this.markAsSelected(o),o.addClass("is-mediaFocused is-selected"),!1;if(o.hasClass("graf--mixtapeEmbed"))return a=n.next(".graf--mixtapeEmbed"),s=a[0].childNodes.length,this.setRangeAt(a[0],s),this.scrollTo(a),t.log("2 down"),!1;if(n.hasClass("graf--figure")&&o.hasClass("graf"))return this.scrollTo(o),t.log("3 down, from figure to next graf"),this.markAsSelected(o),this.setRangeAt(o[0]),!1;break;case"Up":if(l=n.prev(),t.log("PREV NODE IS "+l.attr("class")+" "+l.attr("name")),t.log("CURRENT NODE IS up "+n.attr("class")),!$(n).hasClass("graf"))return;if(!$(n).editableCaretOnFirstLine())return;if(t.log("ENTER ARROW PASSED RETURNS"),l.hasClass("graf--figure"))return t.log("1 up"),a=l.find(".imageCaption"),this.scrollTo(a),this.skip_keyup=!0,this.selection().removeAllRanges(),this.markAsSelected(l),l.addClass("is-mediaFocused"),!1;if(l.hasClass("graf--mixtapeEmbed"))return a=n.prev(".graf--mixtapeEmbed"),s=a[0].childNodes.length,this.setRangeAt(a[0],s),this.scrollTo(a),t.log("2 up"),!1;if(n.hasClass("graf--figure")&&l.hasClass("graf"))return this.setRangeAt(l[0]),this.scrollTo(l),t.log("3 up"),!1;if(l.hasClass("graf"))return a=n.prev(".graf"),s=a[0].childNodes.length,this.scrollTo(a),t.log("4 up"),this.skip_keyup=!0,this.markAsSelected(l),!1}},r.prototype.parseInitialMess=function(){return this.setupElementsClasses($(this.el).find(".section-inner"),function(t){return function(e){return t.handleUnwrappedImages(e)}}(this))},r.prototype.handleDblclick=function(){var e;return t.log("handleDblclick"),e=this.getNode(),_.isNull(e)&&this.setRangeAt(this.prev_current_node),!1},r.prototype.handlePaste=function(e){var i,n;return t.log("pasted!"),this.aa=this.getNode(),n=void 0,window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(i=e.originalEvent.clipboardData,n=i.getData(_.isEmpty(i.getData("text/html"))?"text/plain":"text/html")),t.log("Process and handle text..."),n.match(/<\/*[a-z][^>]+?>/gi)?(t.log("HTML DETECTED ON PASTE"),n=n.replace(/&.*;/g,""),n=n.replace(/<div>([\w\W]*?)<\/div>/gi,"<p>$1</p>"),document.body.appendChild($("<div id='"+this.paste_element_id.replace("#","")+"' class='dante-paste'></div>")[0]),$(this.paste_element_id).html("<span>"+n+"</span>"),this.setupElementsClasses($(this.paste_element_id),function(t){return function(e){var i,n,r,a,o;return r=$(e.html()).insertAfter($(t.aa)),e.remove(),i=r.last()[0],a=i.childNodes.length,t.setRangeAt(i,a),n=$(t.getNode()),t.markAsSelected(n),t.displayTooltipAt($(t.el).find(".is-selected")),t.handleUnwrappedImages(r),o=n.offset().top,$("html, body").animate({scrollTop:o},20)}}(this)),!1):void 0},r.prototype.handleUnwrappedImages=function(e){return _.each(e.find("img"),function(e){return function(i){return t.log("process image here!"),e.uploader_widget.uploadExistentImage(i)}}(this))},r.prototype.handleInmediateDeletion=function(t){var e;return this.inmediateDeletion=!1,e=$(this.baseParagraphTmpl()).insertBefore($(t)),e.addClass("is-selected"),this.setRangeAt($(t).prev()[0]),$(t).remove()},r.prototype.handleUnwrappedNode=function(t){var e,i;return i=$(this.baseParagraphTmpl()),this.setElementName(i),$(t).wrap(i),e=$("[name='"+i.attr("name")+"']"),e.addClass("is-selected"),this.setRangeAt(e[0]),!1},r.prototype.handleNullAnchor=function(){var e,i,n,r,a,o;return t.log("WARNING! this is an empty node"),a=this.selection(),a.isCollapsed&&a.rangeCount>0?(r=a.getRangeAt(0),o=$(this.baseParagraphTmpl())[0],r.insertNode(o),r.setStart(o,0),r.setEnd(o,0),a.removeAllRanges(),a.addRange(r),e=$(r.commonAncestorContainer),n=e.prev(),i=n[0].childNodes.length,t.log("PREV NODE"),t.log(n),n.hasClass("graf")?(this.setRangeAt(n[0],i),e.remove(),this.markAsSelected(this.getNode())):n.hasClass("graf--mixtapeEmbed")?(this.setRangeAt(n[0],i),e.remove(),this.markAsSelected(this.getNode())):n.hasClass("postList")?this.setRangeAt(n.find("li").last()[0]):n||this.setRangeAt(this.$el.find(".section-inner p")[0]),this.displayTooltipAt($(this.el).find(".is-selected"))):void 0},r.prototype.handleCompleteDeletion=function(e){return _.isEmpty($(e).text().trim())?(t.log("HANDLE COMPLETE DELETION"),this.selection().removeAllRanges(),this.render(),setTimeout(function(t){return function(){return t.setRangeAt($(t.el).find(".section-inner p")[0])}}(this),20),this.completeDeletion=!0):void 0},r.prototype.handleTab=function(e){var i,n;return t.log("HANDLE TAB"),i=".graf, .graf--mixtapeEmbed, .graf--figure, .graf--figure",n=$(e).next(i),$(n).hasClass("graf--figure")?(n=$(n).find("figcaption"),this.setRangeAt(n[0]),this.markAsSelected($(n).parent(".graf--figure")),this.displayTooltipAt(n),this.scrollTo($(n)),!1):((_.isEmpty(n)||_.isUndefined(n[0]))&&(n=$(".graf:first")),this.setRangeAt(n[0]),this.markAsSelected(n),this.displayTooltipAt(n),this.scrollTo($(n)))},r.prototype.handleKeyDown=function(e){var i,n,r,l,d;if(t.log("KEYDOWN"),i=this.getNode(),l=$(i),i&&this.markAsSelected(i),e.which===p)return this.handleTab(i),!1;if(e.which===s){if($(this.el).find(".is-selected").removeClass("is-selected"),t.log(this.isLastChar()),l.hasClass("graf--p")?(r=this.handleSmartList(l,e),r&&(i=r)):l.hasClass("graf--li")&&this.handleListLineBreak(l,e),
t.log("HANDLING WIDGET KEYDOWNS"),_.each(this.widgets,function(t){return function(t){return t.handleEnterKey?t.handleEnterKey(e,l):void 0}}(this)),(l.hasClass("graf--mixtapeEmbed")||l.hasClass("graf--iframe")||l.hasClass("graf--figure"))&&(t.log("supress linebreak from embed !(last char)"),!this.isLastChar()))return!1;if(l.hasClass("graf--iframe")||l.hasClass("graf--figure"))return this.isLastChar()?(this.handleLineBreakWith("p",l),this.setRangeAtText($(".is-selected")[0]),$(".is-selected").trigger("mouseup"),!1):!1;this.tooltip_view.cleanOperationClasses($(i)),i&&this.editor_menu.lineBreakReg.test(i.nodeName)&&this.isLastChar()&&(t.log("new paragraph if it's the last character"),e.preventDefault(),this.handleLineBreakWith("p",l)),setTimeout(function(t){return function(){var e;return e=t.getNode(),_.isUndefined(e)?void 0:(t.setElementName($(e)),"div"===e.nodeName.toLowerCase()&&(e=t.replaceWith("p",$(e))[0]),t.markAsSelected($(e)),t.setupFirstAndLast(),_.isEmpty($(e).text().trim())&&(_.each($(e).children(),function(t){return $(t).remove()}),$(e).append("<br>")),t.displayTooltipAt($(t.el).find(".is-selected")))}}(this),2)}if(e.which===a){if(n=!1,this.tooltip_view.hide(),t.log("removing from down"),this.reachedTop&&t.log("REACHED TOP"),this.prevented||this.reachedTop&&this.isFirstChar())return!1;if(t.log("pass initial validations"),i=this.getNode(),d=t.getNode(),t.log(i),t.log(d),t.log("HANDLING WIDGET BACKSPACES"),_.each(this.widgets,function(r){return function(r){return _.isFunction(r.handleBackspaceKey)&&!n?(n=r.handleBackspaceKey(e,i),t.log(n)):void 0}}(this)),n)return e.preventDefault(),t.log("SCAPE FROM BACKSPACE HANDLER"),!1;if(l.hasClass("graf--li")&&0===this.getCharacterPrecedingCaret().length)return this.handleListBackspace(l,e);if($(i).hasClass("graf--p")&&this.isFirstChar()&&$(i).prev().hasClass("graf--figure")&&0===this.getSelectedText().length&&(e.preventDefault(),$(i).prev().find("img").click(),t.log("Focus on the previous image")),($(d).hasClass("section-content")||$(d).hasClass("graf--first"))&&(t.log("SECTION DETECTED FROM KEYDOWN "+_.isEmpty($(d).text())),_.isEmpty($(d).text())))return!1;if(i&&3===i.nodeType&&t.log("TextNode detected from Down!"),($(i).hasClass("graf--mixtapeEmbed")||$(i).hasClass("graf--iframe"))&&_.isEmpty($(i).text().trim()||this.isFirstChar()))return t.log("Check for inmediate deletion on empty embed text"),this.inmediateDeletion=this.isSelectingAll(i),this.inmediateDeletion&&this.handleInmediateDeletion($(i)),!1;if($(i).prev().hasClass("graf--mixtapeEmbed")&&this.isFirstChar()&&!_.isEmpty($(i).text().trim()))return!1}return e.which===h&&(t.log("SPACEBAR"),l.hasClass("graf--p")&&this.handleSmartList(l,e)),_.contains([c,o],e.which)&&(t.log(e.which),this.handleArrowForKeyDown(e)),i&&(_.isEmpty($(i).text())||(this.tooltip_view.hide(),$(i).removeClass("graf--empty"))),_.isUndefined(i)&&$(".is-selected").hasClass("is-mediaFocused")?(this.setRangeAt($(".is-selected").find("figcaption")[0]),$(".is-selected").removeClass("is-mediaFocused"),!1):void 0},r.prototype.handleKeyUp=function(e,i){var n,r,p;if(this.skip_keyup)return this.skip_keyup=null,t.log("SKIP KEYUP"),!1;if(t.log("KEYUP"),this.editor_menu.hide(),this.reachedTop=!1,n=this.getNode(),p=t.getNode(),this.handleTextSelection(n),_.contains([a,h,s],e.which)&&$(n).hasClass("graf--li")&&this.removeSpanTag($(n)),e.which===a){if($(p).hasClass("postField--body")&&(t.log("ALL GONE from UP"),this.handleCompleteDeletion($(this.el)),this.completeDeletion))return this.completeDeletion=!1,!1;if(($(p).hasClass("section-content")||$(p).hasClass("graf--first"))&&(t.log("SECTION DETECTED FROM KEYUP "+_.isEmpty($(p).text())),_.isEmpty($(p).text())))return r=$(p).next(".graf")[0],r&&(this.setRangeAt(r),$(p).remove(),this.setupFirstAndLast()),!1;if(_.isNull(n))return this.handleNullAnchor(),!1;$(n).hasClass("graf--first")&&(t.log("THE FIRST ONE! UP"),this.getSelectedText()===this.getNode().textContent&&(t.log("remove selection dectected"),this.getNode().innerHTML="<br>"),this.markAsSelected(n),this.setupFirstAndLast())}return _.contains([l,c,d,o],e.which)?this.handleArrow(e):void 0},r.prototype.handleLineBreakWith=function(t,e){var i;return i=$("<"+t+" class='graf graf--"+t+" graf--empty is-selected'><br/></"+t+">"),i.insertAfter(e.parent().is('[class^="graf--"]')?e.parent():e),this.setRangeAt(i[0]),this.scrollTo(i)},r.prototype.replaceWith=function(t,e){var i;return i=$("<"+t+" class='graf graf--"+t+" graf--empty is-selected'><br/></"+t+">"),e.replaceWith(i),this.setRangeAt(i[0]),this.scrollTo(i),i},r.prototype.displayTooltipAt=function(e){return t.log("POSITION FOR TOOLTIP"),e=$(e),e&&!_.isUndefined(e)&&!_.isEmpty(e)&&"LI"!==e[0].tagName&&(this.tooltip_view.hide(),_.isEmpty(e.text()))?(this.positions=e.offset(),this.tooltip_view.render(),this.tooltip_view.move(this.positions)):void 0},r.prototype.markAsSelected=function(e){return t.log(e),_.isUndefined(e)?void 0:($(this.el).find(".is-selected").removeClass("is-mediaFocused is-selected"),$(e).addClass("is-selected"),$(e).find(".defaultValue").remove(),$(e).hasClass("graf--first")&&(this.reachedTop=!0,0===$(e).find("br").length)?$(e).append("<br>"):void 0)},r.prototype.addClassesToElement=function(e){var i,n,r;switch(i=e,n=i.nodeName.toLowerCase()){case"p":case"pre":case"div":$(i).hasClass("graf--mixtapeEmbed")||$(i).removeClass().addClass("graf graf--"+n),"p"===n&&0===$(i).find("br").length&&$(i).append("<br>");break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":"h1"===n?(r=$("<h2 class='graf graf--h2'>"+$(i).text()+"</h2>"),$(i).replaceWith(r),this.setElementName(i)):$(i).removeClass().addClass("graf graf--"+n);break;case"code":$(i).unwrap().wrap("<p class='graf graf--pre'></p>"),i=$(i).parent();break;case"ol":case"ul":t.log("lists"),$(i).removeClass().addClass("postList"),_.each($(i).find("li"),function(t){return $(t).removeClass().addClass("graf graf--li")});break;case"img":t.log("images"),this.uploader_widget.uploadExistentImage(i);break;case"a":case"strong":case"em":case"br":case"b":case"u":case"i":t.log("links"),$(i).wrap("<p class='graf graf--p'></p>"),i=$(i).parent();break;case"blockquote":i=$(i).removeClass().addClass("graf graf--"+n);break;case"figure":$(i).hasClass(".graf--figure")&&(i=$(i));break;default:$(i).wrap("<p class='graf graf--"+n+"'></p>"),i=$(i).parent()}return i},r.prototype.setupElementsClasses=function(t,e){return t=_.isUndefined(t)?$(this.el).find(".section-inner"):t,this.cleanContents(t),this.wrapTextNodes(t),_.each(t.children(),function(t){return function(e){var i;return i=$(e).prop("tagName").toLowerCase(),e=t.addClassesToElement(e),t.setElementName(e)}}(this)),this.setupLinks(t.find("a")),this.setupFirstAndLast(),_.isFunction(e)?e(t):void 0},r.prototype.cleanContents=function(e){var i,n;return t.log("ti"),t.log(e),e=_.isUndefined(e)?$(this.el).find(".section-inner"):e,i=this.paste_element_id,n=new Sanitize({elements:["strong","img","em","br","a","blockquote","b","u","i","pre","p","h1","h2","h3","h4","ul","ol","li"],attributes:{__ALL__:["class"],a:["href","title","target"],img:["src"]},protocols:{a:{href:["http","https","mailto"]}},transformers:[function(t){return"span"===t.node_name&&$(t.node).hasClass("defaultValue")?{whitelist_nodes:[t.node]}:$(t.node).hasClass("dante-paste")?{whitelist_nodes:[t.node]}:null},function(t){return"div"===t.node_name&&$(t.node).hasClass("graf--mixtapeEmbed")?{whitelist_nodes:[t.node]}:"a"===t.node_name&&$(t.node).parent(".graf--mixtapeEmbed").exists()?{attr_whitelist:["style"]}:null},function(t){return"figure"===t.node_name&&$(t.node).hasClass("graf--iframe")?{whitelist_nodes:[t.node]}:"div"===t.node_name&&$(t.node).hasClass("iframeContainer")&&$(t.node).parent(".graf--iframe").exists()?{whitelist_nodes:[t.node]}:"iframe"===t.node_name&&$(t.node).parent(".iframeContainer").exists()?{whitelist_nodes:[t.node]}:"figcaption"===t.node_name&&$(t.node).parent(".graf--iframe").exists()?{whitelist_nodes:[t.node]}:null},function(t){return"figure"===t.node_name&&$(t.node).hasClass("graf--figure")?{whitelist_nodes:[t.node]}:"div"===t.node_name&&$(t.node).hasClass("aspectRatioPlaceholder")&&$(t.node).parent(".graf--figure").exists()?{whitelist_nodes:[t.node]}:"div"===t.node_name&&$(t.node).hasClass("aspect-ratio-fill")&&$(t.node).parent(".aspectRatioPlaceholder").exists()?{whitelist_nodes:[t.node]}:"img"===t.node_name&&$(t.node).parent(".graf--figure").exists()?{whitelist_nodes:[t.node]}:"a"===t.node_name&&$(t.node).parent(".graf--mixtapeEmbed").exists()?{attr_whitelist:["style"]}:"figcaption"===t.node_name&&$(t.node).parent(".graf--figure").exists()?{whitelist_nodes:[t.node]}:"span"===t.node_name&&$(t.node).parent(".imageCaption").exists()?{whitelist_nodes:[t.node]}:null}]}),e.exists()?(t.log("CLEAN HTML "+e[0].tagName),e.html(n.clean_node(e[0]))):void 0},r.prototype.setupLinks=function(t){return _.each(t,function(t){return function(e){return t.setupLink(e)}}(this))},r.prototype.setupLink=function(t){var e,i;return i=$(t).parent().prop("tagName").toLowerCase(),$(t).addClass("markup--anchor markup--"+i+"-anchor"),e=$(t).attr("href"),$(t).attr("data-href",e)},r.prototype.preCleanNode=function(t){var e;return e=new Sanitize({elements:["strong","em","br","a","b","u","i","ul","ol","li"],attributes:{a:["href","title","target"]},protocols:{a:{href:["http","https","mailto"]}}}),$(t).html(e.clean_node(t[0])),t=this.addClassesToElement($(t)[0]),$(t)},r.prototype.setupFirstAndLast=function(){var t;return t=$(this.el).find(".section-inner").children(),t.removeClass("graf--last , graf--first"),t.first().addClass("graf--first"),t.last().addClass("graf--last")},r.prototype.wrapTextNodes=function(t){return t=_.isUndefined(t)?$(this.el).find(".section-inner"):t,t.contents().filter(function(){return 3===this.nodeType&&this.data.trim().length>0}).wrap("<p class='graf grap--p'></p>")},r.prototype.setElementName=function(e){return $(e).attr("name",t.generateUniqueName())},r.prototype.listify=function(e,i,n){var r,a,o;switch(t.log("LISTIFY PARAGRAPH"),this.removeSpanTag(e),o=e.html().replace(/&nbsp;/g," ").replace(n,""),i){case"ul":a=$("<ul></ul>");break;case"ol":a=$("<ol></ol>");break;default:return!1}return this.addClassesToElement(a[0]),this.replaceWith("li",e),r=$(".is-selected"),this.setElementName(r[0]),r.html(o).wrap(a),0===r.find("br").length&&r.append("<br/>"),this.setRangeAt(r[0]),r[0]},r.prototype.handleSmartList=function(e,i){var n,r,a,o;return t.log("HANDLE A SMART LIST"),r=this.getCharacterPrecedingCaret(),a=r.match(/^\s*(\-|\*)\s*$/),a?(t.log("CREATING LIST ITEM"),i.preventDefault(),o=new RegExp(/\s*(\-|\*)\s*/),n=this.listify(e,"ul",o)):(a=r.match(/^\s*1(\.|\))\s*$/),a&&(t.log("CREATING LIST ITEM"),i.preventDefault(),o=new RegExp(/\s*1(\.|\))\s*/),n=this.listify(e,"ol",o))),n},r.prototype.handleListLineBreak=function(e,i){var n,r,a;return t.log("LIST LINE BREAK"),this.tooltip_view.hide(),n=e.parent("ol, ul"),r=$("<p></p>"),t.log(e.prev()),1===n.children().length&&""===e.text()?this.replaceWith("p",n):""===e.text()&&0!==e.next().length?i.preventDefault():0===e.next().length&&(""===e.text()?(i.preventDefault(),t.log("BREAK FROM LIST"),n.after(r),e.addClass("graf--removed").remove()):0!==e.prev().length&&""===e.prev().text()&&""===this.getCharacterPrecedingCaret()&&(i.preventDefault(),t.log("PREV IS EMPTY"),a=e.html(),n.after(r),e.prev().remove(),e.addClass("graf--removed").remove(),r.html(a))),n&&0===n.children().length&&n.remove(),t.log(e),e.hasClass("graf--removed")?(t.log("ELEMENT REMOVED"),this.addClassesToElement(r[0]),this.setRangeAt(r[0]),this.markAsSelected(r[0]),this.scrollTo(r)):void 0},r.prototype.handleListBackspace=function(e,i){var n,r,a;return n=e.parent("ol, ul"),t.log("LIST BACKSPACE"),0===e.prev().length?(i.preventDefault(),n.before(e),a=e.html(),this.replaceWith("p",e),r=$(".is-selected"),r.removeClass("graf--empty").html(a).attr("name",t.generateUniqueName()),0===n.children().length&&n.remove(),this.setupFirstAndLast()):void 0},r.prototype.removeSpanTag=function(t){var e,i,n,r;for(e=t.find("span"),n=0,r=e.length;r>n;n++)i=e[n],$(i).hasClass("defaultValue")||$(i).replaceWith($(i).html());return t},r}(Dante.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var r in i)e.call(i,r)&&(t[r]=i[r]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};Dante.View.TooltipWidget=function(e){function n(){return this.hide=t(this.hide,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.initialize=function(t){return null==t&&(t={}),this.icon=t.icon,this.title=t.title,this.actionEvent=t.title},n.prototype.hide=function(){return this.current_editor.tooltip_view.hide()},n}(Dante.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.View.TooltipWidget.Uploader=function(i){function r(){return this.handleBackspaceKey=e(this.handleBackspaceKey,this),this.uploadCompleted=e(this.uploadCompleted,this),this.updateProgressBar=e(this.updateProgressBar,this),this.uploadFile=e(this.uploadFile,this),this.uploadFiles=e(this.uploadFiles,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.initialize=function(t){return null==t&&(t={}),this.icon=t.icon||"icon-image",this.title=t.title||"Add an image",this.action=t.action||"menu-image",this.current_editor=t.current_editor},r.prototype.handleClick=function(t){return this.imageSelect(t)},r.prototype.insertTemplate=function(){return"<figure contenteditable='false' class='graf graf--figure is-defaultValue' name='"+t.generateUniqueName()+"' tabindex='0'> <div style='' class='aspectRatioPlaceholder is-locked'> <div style='padding-bottom: 100%;' class='aspect-ratio-fill'></div> <img src='' data-height='' data-width='' data-image-id='' class='graf-image' data-delayed-src=''> </div> <figcaption contenteditable='true' data-default-value='Type caption for image (optional)' class='imageCaption'> <span class='defaultValue'>Type caption for image (optional)</span> <br> </figcaption> </figure>"},r.prototype.uploadExistentImage=function(e,i){var n,r,a,o,s,l,d;if(null==i&&(i={}),t.log("process image here!"),o=$(this.insertTemplate()),o.find("img").attr("src",this.current_editor.default_loading_placeholder),$(e).parents(".graf").length>0){if($(e).parents(".graf").hasClass("graf--figure"))return;t.log("UNO"),o.insertBefore($(e).parents(".graf")),a=this.current_editor.getNode(),a&&(this.current_editor.preCleanNode($(a)),this.current_editor.addClassesToElement(a))}else t.log("DOS"),$(e).replaceWith(o);if(t.log($("[name='"+o.attr("name")+"']").attr("name")),this.replaceImg(e,$("[name='"+o.attr("name")+"']")),r=$("[name='"+o.attr("name")+"']").parentsUntil(".section-inner").length,0!==r){for(d=[],n=s=0,l=r-1;l>=s;n=s+=1)d.push($("[name='"+o.attr("name")+"']").unwrap());return d}},r.prototype.replaceImg=function(e,i){var n,r;return t.log(i.attr("name")),t.log(i),$(e).remove(),n=new Image,n.src=e.src,r=this,n.onload=function(){var n;return t.log("replace image with loaded info"),t.log(i.attr("name")),t.log(this.width+"x"+this.height),n=r.getAspectRatio(this.width,this.height),i.find(".aspectRatioPlaceholder").css({"max-width":n.width,"max-height":n.height}),i.find(".graf-image").attr({"data-height":this.height,"data-width":this.width}),i.find(".aspect-ratio-fill").css({"padding-bottom":""+n.ratio+"%"}),i.find("img").attr("src",e.src)}},r.prototype.displayAndUploadImages=function(t){return this.displayCachedImage(t)},r.prototype.imageSelect=function(t){var e,i;return e=$('<input type="file" multiple="multiple">').click(),i=this,e.change(function(){var t;return t=this,i.uploadFiles(t.files)})},r.prototype.displayCachedImage=function(e){var i;return this.current_editor.tooltip_view.hide(),i=new FileReader,i.onload=function(i){return function(n){var r,a,o;return r=new Image,r.src=n.target.result,a=i.current_editor.getNode(),o=i,r.onload=function(){var i,r,s,l;return s=$(o.insertTemplate()),l=$(s).insertBefore($(a)),r=s.find("img.graf-image").attr("src",n.target.result),r.height=this.height,r.width=this.width,t.log("UPLOADED SHOW FROM CACHE"),i=o.getAspectRatio(this.width,this.height),l.find(".aspectRatioPlaceholder").css({"max-width":i.width,"max-height":i.height}),l.find(".graf-image").attr({"data-height":this.height,"data-width":this.width}),l.find(".aspect-ratio-fill").css({"padding-bottom":""+i.ratio+"%"}),o.uploadFile(e,l)}}}(this),i.readAsDataURL(e)},r.prototype.getAspectRatio=function(e,i){var n,r,a,o,s,l,d;return o=700,a=700,s=0,d=e,r=i,d>o?(s=o/d,r*=s,d*=s):r>a&&(s=a/r,d*=s,r*=s),n=r/d*100,l={width:d,height:r,ratio:n},t.log(l),l},r.prototype.formatData=function(t){var e;return e=new FormData,e.append("file",t),e},r.prototype.uploadFiles=function(t){var e,i,n,r;for(e={"image/png":!0,"image/jpeg":!0,"image/gif":!0},n=0,r=[];n<t.length;)i=t[n],e[i.type]===!0&&($(this.placeholder).append('<progress class="progress" min="0" max="100" value="0">0</progress>'),this.displayAndUploadImages(i)),r.push(n++);return r},r.prototype.uploadFile=function(e,i){var n,r;return r=i,n=function(t){return function(e){return t.uploadCompleted(e,r)}}(this),$.ajax({type:"post",url:this.current_editor.upload_url,xhr:function(t){return function(){var e;return e=new XMLHttpRequest,e.upload.onprogress=t.updateProgressBar,e}}(this),cache:!1,contentType:!1,success:function(t){return function(e){t.current_editor.upload_callback&&(e=t.current_editor.upload_callback(e)),n(e)}}(this),error:function(e){return function(e){return t.log("ERROR: got error uploading file "+e.responseText)}}(this),processData:!1,data:this.formatData(e)})},r.prototype.updateProgressBar=function(e){var i,n;return i=$(".progress:first",this.$el),n="",e.lengthComputable?(n=e.loaded/e.total*100,n=null!=n?n:{complete:0},t.log("complete"),t.log(n)):void 0},r.prototype.uploadCompleted=function(t,e){return e.find("img").attr("src",t)},r.prototype.handleBackspaceKey=function(e,i){var n;if(t.log("handleBackspaceKey on uploader widget"),$(i).hasClass("is-selected")&&$(i).hasClass("graf--figure")){if(n=this.current_editor.selection().anchorNode,null!=n&&$(n.parentNode).hasClass("imageCaption"))return this.current_editor.isFirstChar()?!0:!1}else if($(".is-selected").hasClass("is-mediaFocused"))return t.log("Replacing selected node"),this.current_editor.replaceWith("p",$(".is-selected")),this.current_editor.setRangeAt($(".is-selected")[0]),!0},r}(Dante.View.TooltipWidget)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.View.TooltipWidget.Embed=function(i){function r(){return this.getEmbedFromNode=e(this.getEmbedFromNode,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.initialize=function(t){return null==t&&(t={}),this.icon=t.icon||"icon-video",this.title=t.title||"Add a video",this.action=t.action||"embed",this.current_editor=t.current_editor},r.prototype.handleClick=function(t){return this.displayEmbedPlaceHolder(t)},r.prototype.handleEnterKey=function(t,e){return e.hasClass("is-embedable")?this.getEmbedFromNode(e):void 0},r.prototype.embedTemplate=function(){return"<figure contenteditable='false' class='graf--figure graf--iframe graf--first' name='504e' tabindex='0'> <div class='iframeContainer'> <iframe frameborder='0' width='700' height='393' data-media-id='' src='' data-height='480' data-width='854'> </iframe> </div> <figcaption contenteditable='true' data-default-value='Type caption for embed (optional)' class='imageCaption'> <a rel='nofollow' class='markup--anchor markup--figure-anchor' data-href='' href='' target='_blank'> </a> </figcaption> </figure>"},r.prototype.displayEmbedPlaceHolder=function(){var t;return t=this.current_editor.embed_placeholder,this.node=this.current_editor.getNode(),$(this.node).html(t).addClass("is-embedable"),this.current_editor.setRangeAt(this.node),this.hide(),!1},r.prototype.getEmbedFromNode=function(e){return this.node=$(e),this.node_name=this.node.attr("name"),this.node.addClass("spinner"),$.getJSON(""+this.current_editor.oembed_url+$(this.node).text()).success(function(e){return function(i){var n,r,a,o;return e.node=$("[name="+e.node_name+"]"),n=$(i.html).prop("src"),a=$(e.embedTemplate()),a.attr("name",e.node.attr("name")),$(e.node).replaceWith(a),r=$(".graf--iframe[name="+e.node.attr("name")+"]"),r.find("iframe").attr("src",n),o=i.url||i.author_url,t.log("URL IS "+o),r.find(".markup--anchor").attr("href",o).text(o),e.hide()}}(this)).error(function(t){return function(e){return t.node.removeClass("spinner")}}(this))},r}(Dante.View.TooltipWidget)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.View.TooltipWidget.EmbedExtract=function(i){function r(){return this.getExtract=e(this.getExtract,this),this.getExtractFromNode=e(this.getExtractFromNode,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.initialize=function(t){return null==t&&(t={}),this.icon=t.icon||"icon-embed",this.title=t.title||"Add an embed",this.action=t.action||"embed-extract",this.current_editor=t.current_editor},r.prototype.handleClick=function(t){return this.displayExtractPlaceHolder(t)},r.prototype.handleEnterKey=function(t,e){return e.hasClass("is-extractable")?this.getExtractFromNode(e):void 0},r.prototype.extractTemplate=function(){return"<div class='graf graf--mixtapeEmbed is-selected' name=''> <a target='_blank' data-media-id='' class='js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock' href=''> </a> <a data-tooltip-type='link' data-tooltip-position='bottom' data-tooltip='' title='' class='markup--anchor markup--mixtapeEmbed-anchor' data-href='' href='' target='_blank'> <strong class='markup--strong markup--mixtapeEmbed-strong'></strong> <em class='markup--em markup--mixtapeEmbed-em'></em> </a> </div>"},r.prototype.displayExtractPlaceHolder=function(){var t;return t=this.current_editor.extract_placeholder,this.node=this.current_editor.getNode(),$(this.node).html(t).addClass("is-extractable"),this.current_editor.setRangeAt(this.node),this.hide(),!1},r.prototype.getExtractFromNode=function(t){return this.node=$(t),this.node_name=this.node.attr("name"),this.node.addClass("spinner"),$.getJSON(""+this.current_editor.extract_url+$(this.node).text()).success(function(t){return function(e){var i,n,r,a;return t.node=$("[name="+t.node_name+"]"),i=$(e.html).prop("src"),a=$(t.extractTemplate()),a.attr("name",t.node.attr("name")),$(t.node).replaceWith(a),r=$(".graf--mixtapeEmbed[name="+t.node.attr("name")+"]"),r.find("strong").text(e.title),r.find("em").text(e.description),r.append(e.provider_url),r.find(".markup--anchor").attr("href",e.url),_.isEmpty(e.images)||(n=r.find(".mixtapeImage"),n.css("background-image","url("+e.images[0].url+")"),n.removeClass("mixtapeImage--empty u-ignoreBlock")),t.hide()}}(this)).error(function(t){return function(e){return t.node.removeClass("spinner")}}(this))},r.prototype.getExtract=function(e){return $.getJSON(""+this.current_editor.extract_url+e).done(function(e){return t.log(e)})},r}(Dante.View.TooltipWidget)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.Editor.Tooltip=function(i){function r(){return this.hide=e(this.hide,this),this.toggleOptions=e(this.toggleOptions,this),this.render=e(this.render,this),this.initialize=e(this.initialize,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.el=".inlineTooltip",r.prototype.events={"click .inlineTooltip-button.control":"toggleOptions","click .inlineTooltip-menu button":"handleClick"},r.prototype.initialize=function(t){return null==t&&(t={}),this.current_editor=t.editor,this.widgets=t.widgets},r.prototype.template=function(){var t;return t="",_.each(this.widgets,function(e){var i;return i=e.action_value?"data-action-value='"+e.action_value+"'":"",t+="<button class='inlineTooltip-button scale' title='"+e.title+"' data-action='inline-menu-"+e.action+"' "+i+"> <span class='tooltip-icon "+e.icon+"'></span> </button>"}),"<button class='inlineTooltip-button control' title='Close Menu' data-action='inline-menu'> <span class='tooltip-icon icon-plus'></span> </button> <div class='inlineTooltip-menu'> "+t+" </div>"},r.prototype.findWidgetByAction=function(t){return _.find(this.widgets,function(e){return e.action===t})},r.prototype.render=function(){return $(this.el).html(this.template()),$(this.el).addClass("is-active"),this},r.prototype.toggleOptions=function(){return t.log("Toggle Options!!"),$(this.el).toggleClass("is-scaled"),!1},r.prototype.move=function(t){var e,i,n,r,a,o;return o=$(this.el),i=o.find(".control").css("width"),e=o.find(".inlineTooltip-menu").css("padding-left"),a=parseInt(i.replace(/px/,""))+parseInt(e.replace(/px/,"")),n=t.left-a,r=t.top,$(this.el).offset({top:r,left:n})},r.prototype.handleClick=function(e){var i,n,r;return n=$(e.currentTarget).data("action"),t.log(n),r=n.replace("inline-menu-",""),(i=this.findWidgetByAction(r))&&i.handleClick(e),!1},r.prototype.cleanOperationClasses=function(t){return t.removeClass("is-embedable is-extractable")},r.prototype.hide=function(){return $(this.el).removeClass("is-active is-scaled")},r}(Dante.View)}.call(this),function(){var t,e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var r in i)e.call(i,r)&&(t[r]=i[r]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};t=Dante.utils,Dante.Editor.PopOver=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.el="body",n.prototype.events={"mouseover .popover":"cancelHide","mouseout  .popover":"hide"},n.prototype.initialize=function(e){return null==e&&(e={}),t.log("initialized popover"),this.editor=e.editor,this.hideTimeout,this.settings={timeout:300}},n.prototype.template=function(){return"<div class='popover popover--tooltip popover--Linktooltip popover--bottom is-active'> <div class='popover-inner'> <a href='#' target='_blank'> Link </a> </div> <div class='popover-arrow'> </div> </div>"},n.prototype.positionAt=function(t){var e,i,n,r,a,o,s,l;return n=$(t.currentTarget),o=this.resolveTargetPosition(n),a=n.offset(),s=n.outerWidth(),r=n.outerHeight(),i=$(this.el).find(".popover").outerWidth(),l=o.top+r,e=a.left+s/2-i/2,$(this.el).find(".popover").css("top",l).css("left",e).show(),this.handleDirection(n)},n.prototype.displayAt=function(t){var e;return this.cancelHide(),e=$(t.currentTarget),$(this.el).find(".popover-inner a").text(e.attr("href")).attr("href",e.attr("href")),this.positionAt(t),$(this.el).find(".popover--tooltip").css("pointer-events","auto"),$(this.el).show()},n.prototype.cancelHide=function(){return t.log("Cancel Hide"),clearTimeout(this.hideTimeout)},n.prototype.hide=function(t){return this.cancelHide(),this.hideTimeout=setTimeout(function(t){return function(){return $(t.el).find(".popover").hide()}}(this),this.settings.timeout)},n.prototype.resolveTargetPosition=function(t){return t.parents(".graf--mixtapeEmbed").exists()?t.parents(".graf--mixtapeEmbed").position():t.position()},n.prototype.handleDirection=function(t){return t.parents(".graf--mixtapeEmbed").exists()?$(this.el).find(".popover").removeClass("popover--bottom").addClass("popover--top"):$(this.el).find(".popover").removeClass("popover--top").addClass("popover--bottom")},n.prototype.render=function(){return $(this.template()).insertAfter(this.editor.$el)},n}(Dante.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Dante.utils,Dante.Editor.Menu=function(i){function r(){return this.createlink=e(this.createlink,this),this.handleInputEnter=e(this.handleInputEnter,this),this.render=e(this.render,this),this.template=e(this.template,this),this.initialize=e(this.initialize,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.el="#dante-menu",r.prototype.events={"mousedown li":"handleClick","click .dante-menu-linkinput .dante-menu-button":"closeInput","keypress input":"handleInputEnter"},r.prototype.initialize=function(t){return null==t&&(t={}),this.config=t.buttons||this.default_config(),this.current_editor=t.editor,this.commandsReg={block:/^(?:p|h[1-6]|blockquote|pre)$/,inline:/^(?:bold|italic|underline|insertorderedlist|insertunorderedlist|indent|outdent)$/,source:/^(?:insertimage|createlink|unlink)$/,insert:/^(?:inserthorizontalrule|insert)$/,wrap:/^(?:code)$/},this.lineBreakReg=/^(?:blockquote|pre|div|p)$/i,this.effectNodeReg=/(?:[pubia]|h[1-6]|blockquote|[uo]l|li)/i,this.strReg={whiteSpace:/(^\s+)|(\s+$)/g,mailTo:/^(?!mailto:|.+\/|.+#|.+\?)(.*@.*\..+)$/,http:/^(?!\w+?:\/\/|mailto:|\/|\.\/|\?|#)(.*)$/}},r.prototype.default_config=function(){return{buttons:["bold","italic","h2","h3","h4","blockquote","createlink"]}},r.prototype.template=function(){var t;return t="<div class='dante-menu-linkinput'><input class='dante-menu-input' placeholder='http://'><div class='dante-menu-button'>x</div></div>",t+="<ul class='dante-menu-buttons'>",_.each(this.config.buttons,function(e){return t+="<li class='dante-menu-button'><i class=\"dante-icon icon-"+e+'" data-action="'+e+'"></i></li>'}),t+="</ul>"},r.prototype.render=function(){return $(this.el).html(this.template()),this.show()},r.prototype.handleClick=function(e){var i,n,r;return n=$(e.currentTarget).find(".dante-icon"),i=n.data("action"),r=$(this.el).find("input.dante-menu-input"),t.log("menu "+i+" item clicked!"),this.savedSel=t.saveSelection(),/(?:createlink)/.test(i)?$(e.currentTarget).hasClass("active")?this.removeLink():($(this.el).addClass("dante-menu--linkmode"),r.focus()):this.menuApply(i),!1},r.prototype.closeInput=function(t){return $(this.el).removeClass("dante-menu--linkmode"),!1},r.prototype.handleInputEnter=function(e){return 13===e.which?(t.restoreSelection(this.savedSel),this.createlink($(e.target))):void 0},r.prototype.removeLink=function(){var t;return this.menuApply("unlink"),t=this.current_editor.getNode(),this.current_editor.cleanContents($(t))},r.prototype.createlink=function(t){var e,i;return $(this.el).removeClass("dante-menu--linkmode"),t.val()?(i=t.val().replace(this.strReg.whiteSpace,"").replace(this.strReg.mailTo,"mailto:$1").replace(this.strReg.http,"http://$1"),this.menuApply("createlink",i)):(e="unlink",this.menuApply(e))},r.prototype.menuApply=function(e,i){return this.commandsReg.block.test(e)?(t.log("block here"),this.commandBlock(e)):this.commandsReg.inline.test(e)||this.commandsReg.source.test(e)?(t.log("overall here"),this.commandOverall(e,i)):this.commandsReg.insert.test(e)?(t.log("insert here"),this.commandInsert(e)):this.commandsReg.wrap.test(e)?(t.log("wrap here"),this.commandWrap(e)):t.log("can't find command function for action: "+e),!1},r.prototype.setupInsertedElement=function(t){var e;return e=this.current_editor.addClassesToElement(t),this.current_editor.setElementName(e),this.current_editor.markAsSelected(e)},r.prototype.cleanContents=function(){return this.current_editor.cleanContents()},r.prototype.commandOverall=function(e,i){var n,r;

n=" to exec "+e+" command"+(i?" with value: "+i:""),document.execCommand(e,!1,i)?(t.log("success"+n),r=this.current_editor.getNode(),this.current_editor.setupLinks($(r).find("a")),this.displayHighlights(),$(r).parent().hasClass("section-inner")&&(r=this.current_editor.addClassesToElement(r),this.current_editor.setElementName(r)),this.current_editor.handleTextSelection(r)):t.log("fail"+n,!0)},r.prototype.commandInsert=function(t){var e;return(e=this.current_editor.current_node)?(this.current_editor.current_range.selectNode(e),this.current_editor.current_range.collapse(!1),this.commandOverall(e,t)):void 0},r.prototype.commandBlock=function(t){var e,i;return i=this.current_editor.current_node,e=this.effectNode(this.current_editor.getNode(i),!0),-1!==e.indexOf(t)&&(t="p"),this.commandOverall("formatblock",t)},r.prototype.commandWrap=function(t){var e,i;return e=this.current_editor.current_node,i="<"+t+">"+selection+"</"+t+">",this.commandOverall("insertHTML",i)},r.prototype.effectNode=function(t,e){var i;for(i=[],t=t||this.current_editor.$el[0];t!==this.current_editor.$el[0];)t.nodeName.match(this.effectNodeReg)&&i.push(e?t.nodeName.toLowerCase():t),t=t.parentNode;return i},r.prototype.displayHighlights=function(){var e;return $(this.el).find(".active").removeClass("active"),e=this.effectNode(t.getNode()),t.log(e),_.each(e,function(e){return function(i){var n;switch(n=i.nodeName.toLowerCase()){case"a":$(e.el).find("input").val($(i).attr("href")),n="createlink";break;case"i":n="italic";break;case"u":n="underline";break;case"b":n="bold";break;case"code":n="code";break;case"ul":n="insertunorderedlist";break;case"ol":n="insertorderedlist";break;case"li":n="indent",t.log("nothing to select")}return n.match(/(?:h[1-6])/i)?$(e.el).find(".icon-bold, .icon-italic, .icon-blockquote").parent("li").remove():"indent"===n&&$(e.el).find(".icon-h2, .icon-h3, .icon-h4, .icon-blockquote").parent("li").remove(),e.highlight(n)}}(this))},r.prototype.highlight=function(t){return $(".icon-"+t).parent("li").addClass("active")},r.prototype.show=function(){return $(this.el).addClass("dante-menu--active"),this.closeInput(),this.displayHighlights()},r.prototype.hide=function(){return $(this.el).removeClass("dante-menu--active")},r}(Dante.View)}.call(this),$(document).ready(function(){if(window.sr=new scrollReveal,document.getElementById("dante-editor")){var t=new Dante.Editor({el:"#dante-editor",upload_url:"/images.json",store_url:"/save"});t.start(),console.log("here...")}$('input[data-role="tags"]').tagsInput();Ladda.bind('[role="submit"]');$(".sidebar-nav .toggle-dropdown").click(function(t){var e=$($(this).attr("data-target"));return e.hasClass("toggled")?($(this).removeClass("expanded"),$(".sidebar-nav .dropdown").removeClass("toggled")):($(".sidebar-nav .toggle-dropdown").removeClass("expanded"),$(".sidebar-nav .dropdown").removeClass("toggled"),e.addClass("toggled"),void $(this).addClass("expanded"))})});
//# sourceMappingURL=main.js.map